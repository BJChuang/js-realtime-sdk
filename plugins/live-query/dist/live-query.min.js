!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-realtime/core")):"function"==typeof define&&define.amd?define("live-query",["exports","leancloud-realtime/core"],b):b(a.AV=a.AV||{},a.AV)}(this,function(a,b){"use strict";function c(a){return a&&a.__esModule?a.default:a}function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}if(!b.Protocals)throw new Error("LeanCloud Realtime SDK not installed");var e=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),f=d(function(a){var b=a.exports={version:"2.5.1"};"number"==typeof __e&&(__e=b)}),g=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},h=function(a,b,c){if(g(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},i=function(a){return"object"==typeof a?null!==a:"function"==typeof a},j=function(a){if(!i(a))throw TypeError(a+" is not an object!");return a},k=function(a){try{return!!a()}catch(a){return!0}},l=!k(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),m=e.document,n=i(m)&&i(m.createElement),o=function(a){return n?m.createElement(a):{}},p=!l&&!k(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),q=function(a,b){if(!i(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!i(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!i(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!i(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},r=Object.defineProperty,s=l?Object.defineProperty:function(a,b,c){if(j(a),b=q(b,!0),j(c),p)try{return r(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},t={f:s},u=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},v=l?function(a,b,c){return t.f(a,b,u(1,c))}:function(a,b,c){return a[b]=c,a},w=function(a,b,c){var d,g,i,j=a&w.F,k=a&w.G,l=a&w.S,m=a&w.P,n=a&w.B,o=a&w.W,p=k?f:f[b]||(f[b]={}),q=p.prototype,r=k?e:l?e[b]:(e[b]||{}).prototype;k&&(c=b);for(d in c)(g=!j&&r&&void 0!==r[d])&&d in p||(i=g?r[d]:c[d],p[d]=k&&"function"!=typeof r[d]?c[d]:n&&g?h(i,e):o&&r[d]==i?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(i):m&&"function"==typeof i?h(Function.call,i):i,m&&((p.virtual||(p.virtual={}))[d]=i,a&w.R&&q&&!q[d]&&v(q,d,i)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128;var x=w,y={}.hasOwnProperty,z=function(a,b){return y.call(a,b)},A={}.toString,B=function(a){return A.call(a).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==B(a)?a.split(""):Object(a)},D=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},E=function(a){return C(D(a))},F=Math.ceil,G=Math.floor,H=function(a){return isNaN(a=+a)?0:(a>0?G:F)(a)},I=Math.min,J=function(a){return a>0?I(H(a),9007199254740991):0},K=Math.max,L=Math.min,M=function(a,b){return a=H(a),a<0?K(a+b,0):L(a,b)},N=e["__core-js_shared__"]||(e["__core-js_shared__"]={}),O=function(a){return N[a]||(N[a]={})},P=0,Q=Math.random(),R=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++P+Q).toString(36))},S=O("keys"),T=function(a){return S[a]||(S[a]=R(a))},U=function(a){return function(b,c,d){var e,f=E(b),g=J(f.length),h=M(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),V=T("IE_PROTO"),W=function(a,b){var c,d=E(a),e=0,f=[];for(c in d)c!=V&&z(d,c)&&f.push(c);for(;b.length>e;)z(d,c=b[e++])&&(~U(f,c)||f.push(c));return f},X="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Y=Object.keys||function(a){return W(a,X)},Z=Object.getOwnPropertySymbols,$={f:Z},_={}.propertyIsEnumerable,aa={f:_},ba=function(a){return Object(D(a))},ca=Object.assign,da=!ca||k(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=ca({},a)[c]||Object.keys(ca({},b)).join("")!=d})?function(a,b){for(var c=ba(a),d=arguments.length,e=1,f=$.f,g=aa.f;d>e;)for(var h,i=C(arguments[e++]),j=f?Y(i).concat(f(i)):Y(i),k=j.length,l=0;k>l;)g.call(i,h=j[l++])&&(c[h]=i[h]);return c}:ca;x(x.S+x.F,"Object",{assign:da});var ea=f.Object.assign,fa=d(function(a){a.exports={default:ea,__esModule:!0}}),ga=c(fa),ha=v,ia={},ja=l?Object.defineProperties:function(a,b){j(a);for(var c,d=Y(b),e=d.length,f=0;e>f;)t.f(a,c=d[f++],b[c]);return a},ka=e.document,la=ka&&ka.documentElement,ma=T("IE_PROTO"),na=function(){},oa=function(){var a,b=o("iframe"),c=X.length;for(b.style.display="none",la.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),oa=a.F;c--;)delete oa.prototype[X[c]];return oa()},pa=Object.create||function(a,b){var c;return null!==a?(na.prototype=j(a),c=new na,na.prototype=null,c[ma]=a):c=oa(),void 0===b?c:ja(c,b)},qa=d(function(a){var b=O("wks"),c=e.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:R)("Symbol."+a))}).store=b}),ra=t.f,sa=qa("toStringTag"),ta=function(a,b,c){a&&!z(a=c?a:a.prototype,sa)&&ra(a,sa,{configurable:!0,value:b})},ua={};v(ua,qa("iterator"),function(){return this});var va=function(a,b,c){a.prototype=pa(ua,{next:u(1,c)}),ta(a,b+" Iterator")},wa=T("IE_PROTO"),xa=Object.prototype,ya=Object.getPrototypeOf||function(a){return a=ba(a),z(a,wa)?a[wa]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?xa:null},za=qa("iterator"),Aa=!([].keys&&"next"in[].keys()),Ba=function(){return this},Ca=function(a,b,c,d,e,f,g){va(c,b,d);var h,i,j,k=function(a){if(!Aa&&a in o)return o[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},l=b+" Iterator",m="values"==e,n=!1,o=a.prototype,p=o[za]||o["@@iterator"]||e&&o[e],q=p||k(e),r=e?m?k("entries"):q:void 0,s="Array"==b?o.entries||p:p;if(s&&(j=ya(s.call(new a)))!==Object.prototype&&j.next&&ta(j,l,!0),m&&p&&"values"!==p.name&&(n=!0,q=function(){return p.call(this)}),g&&(Aa||n||!o[za])&&v(o,za,q),ia[b]=q,ia[l]=Ba,e)if(h={values:m?q:k("values"),keys:f?q:k("keys"),entries:r},g)for(i in h)i in o||ha(o,i,h[i]);else x(x.P+x.F*(Aa||n),b,h);return h},Da=function(a){return function(b,c){var d,e,f=String(D(b)),g=H(c),h=f.length;return g<0||g>=h?a?"":void 0:(d=f.charCodeAt(g),d<55296||d>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):d:a?f.slice(g,g+2):e-56320+(d-55296<<10)+65536)}}(!0);Ca(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=Da(b,c),this._i+=a.length,{value:a,done:!1})});var Ea=function(a,b){return{value:b,done:!!a}};Ca(Array,"Array",function(a,b){this._t=E(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,Ea(1)):"keys"==b?Ea(0,c):"values"==b?Ea(0,a[c]):Ea(0,[c,a[c]])},"values");ia.Arguments=ia.Array;for(var Fa=qa("toStringTag"),Ga="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ha=0;Ha<Ga.length;Ha++){var Ia=Ga[Ha],Ja=e[Ia],Ka=Ja&&Ja.prototype;Ka&&!Ka[Fa]&&v(Ka,Fa,Ia),ia[Ia]=ia.Array}var La=function(a,b,c){for(var d in b)c&&a[d]?a[d]=b[d]:v(a,d,b[d]);return a},Ma=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a},Na=function(a,b,c,d){try{return d?b(j(c)[0],c[1]):b(c)}catch(b){var e=a.return;throw void 0!==e&&j(e.call(a)),b}},Oa=qa("iterator"),Pa=Array.prototype,Qa=function(a){return void 0!==a&&(ia.Array===a||Pa[Oa]===a)},Ra=qa("toStringTag"),Sa="Arguments"==B(function(){return arguments}()),Ta=function(a,b){try{return a[b]}catch(a){}},Ua=function(a){var b,c,d;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=Ta(b=Object(a),Ra))?c:Sa?B(b):"Object"==(d=B(b))&&"function"==typeof b.callee?"Arguments":d},Va=qa("iterator"),Wa=f.getIteratorMethod=function(a){if(void 0!=a)return a[Va]||a["@@iterator"]||ia[Ua(a)]},Xa=d(function(a){var b={},c={},d=a.exports=function(a,d,e,f,g){var i,k,l,m,n=g?function(){return a}:Wa(a),o=h(e,f,d?2:1),p=0;if("function"!=typeof n)throw TypeError(a+" is not iterable!");if(Qa(n)){for(i=J(a.length);i>p;p++)if((m=d?o(j(k=a[p])[0],k[1]):o(a[p]))===b||m===c)return m}else for(l=n.call(a);!(k=l.next()).done;)if((m=Na(l,o,k.value,d))===b||m===c)return m};d.BREAK=b,d.RETURN=c}),Ya=qa("species"),Za=function(a){var b="function"==typeof f[a]?f[a]:e[a];l&&b&&!b[Ya]&&t.f(b,Ya,{configurable:!0,get:function(){return this}})},$a=d(function(a){var b=R("meta"),c=t.f,d=0,e=Object.isExtensible||function(){return!0},f=!k(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!i(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!z(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},j=function(a,c){if(!z(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},l=function(a){return f&&m.NEED&&e(a)&&!z(a,b)&&g(a),a},m=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:j,onFreeze:l}}),_a=function(a,b){if(!i(a)||a._t!==b)throw TypeError("Incompatible receiver, "+b+" required!");return a},ab=t.f,bb=$a.fastKey,cb=l?"_s":"size",db=function(a,b){var c,d=bb(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c},eb={getConstructor:function(a,b,c,d){var e=a(function(a,f){Ma(a,e,b,"_i"),a._t=b,a._i=pa(null),a._f=void 0,a._l=void 0,a[cb]=0,void 0!=f&&Xa(f,c,a[d],a)});return La(e.prototype,{clear:function(){for(var a=_a(this,b),c=a._i,d=a._f;d;d=d.n)d.r=!0,d.p&&(d.p=d.p.n=void 0),delete c[d.i];a._f=a._l=void 0,a[cb]=0},delete:function(a){var c=_a(this,b),d=db(c,a);if(d){var e=d.n,f=d.p;delete c._i[d.i],d.r=!0,f&&(f.n=e),e&&(e.p=f),c._f==d&&(c._f=e),c._l==d&&(c._l=f),c[cb]--}return!!d},forEach:function(a){_a(this,b);for(var c,d=h(a,arguments.length>1?arguments[1]:void 0,3);c=c?c.n:this._f;)for(d(c.v,c.k,this);c&&c.r;)c=c.p},has:function(a){return!!db(_a(this,b),a)}}),l&&ab(e.prototype,"size",{get:function(){return _a(this,b)[cb]}}),e},def:function(a,b,c){var d,e,f=db(a,b);return f?f.v=c:(a._l=f={i:e=bb(b,!0),k:b,v:c,p:d=a._l,n:void 0,r:!1},a._f||(a._f=f),d&&(d.n=f),a[cb]++,"F"!==e&&(a._i[e]=f)),a},getEntry:db,setStrong:function(a,b,c){Ca(a,b,function(a,c){this._t=_a(a,b),this._k=c,this._l=void 0},function(){for(var a=this,b=a._k,c=a._l;c&&c.r;)c=c.p;return a._t&&(a._l=c=c?c.n:a._t._f)?"keys"==b?Ea(0,c.k):"values"==b?Ea(0,c.v):Ea(0,[c.k,c.v]):(a._t=void 0,Ea(1))},c?"entries":"values",!c,!0),Za(b)}},fb=Array.isArray||function(a){return"Array"==B(a)},gb=qa("species"),hb=function(a){var b;return fb(a)&&(b=a.constructor,"function"!=typeof b||b!==Array&&!fb(b.prototype)||(b=void 0),i(b)&&null===(b=b[gb])&&(b=void 0)),void 0===b?Array:b},ib=function(a,b){return new(hb(a))(b)},jb=t.f,kb=function(a,b){var c=1==a,d=2==a,e=3==a,f=4==a,g=6==a,i=5==a||g,j=b||ib;return function(b,k,l){for(var m,n,o=ba(b),p=C(o),q=h(k,l,3),r=J(p.length),s=0,t=c?j(b,r):d?j(b,0):void 0;r>s;s++)if((i||s in p)&&(m=p[s],n=q(m,s,o),a))if(c)t[s]=n;else if(n)switch(a){case 3:return!0;case 5:return m;case 6:return s;case 2:t.push(m)}else if(f)return!1;return g?-1:e||f?f:t}}(0),lb=(function(a,b,c,d,f,g){var h=e[a],j=h,m=f?"set":"add",n=j&&j.prototype,o={};l&&"function"==typeof j&&(g||n.forEach&&!k(function(){(new j).entries().next()}))?(j=b(function(b,c){Ma(b,j,a,"_c"),b._c=new h,void 0!=c&&Xa(c,f,b[m],b)}),kb("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(a){var b="add"==a||"set"==a;a in n&&(!g||"clear"!=a)&&v(j.prototype,a,function(c,d){if(Ma(this,j,a),!b&&g&&!i(c))return"get"==a&&void 0;var e=this._c[a](0===c?0:c,d);return b?this:e})}),g||jb(j.prototype,"size",{get:function(){return this._c.size}})):(j=d.getConstructor(b,a,f,m),La(j.prototype,c),$a.NEED=!0),ta(j,a),o[a]=j,x(x.G+x.W+x.F,o),g||d.setStrong(j,a,f)}("Set",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return eb.def(_a(this,"Set"),a=0===a?0:a,a)}},eb),function(a,b){var c=[];return Xa(a,!1,c.push,c,b),c});x(x.P+x.R,"Set",{toJSON:function(a){return function(){if(Ua(this)!=a)throw TypeError(a+"#toJSON isn't generic");return lb(this)}}("Set")});!function(a){x(x.S,a,{of:function(){for(var a=arguments.length,b=Array(a);a--;)b[a]=arguments[a];return new this(b)}})}("Set");!function(a){x(x.S,a,{from:function(a){var b,c,d,e,f=arguments[1];return g(this),b=void 0!==f,b&&g(f),void 0==a?new this:(c=[],b?(d=0,e=h(f,arguments[2],2),Xa(a,!1,function(a){c.push(e(a,d++))})):Xa(a,!1,c.push,c),new this(c))}})}("Set");var mb=f.Set,nb=d(function(a){a.exports={default:mb,__esModule:!0}}),ob=c(nb),pb=d(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),qb=c(pb),rb=qa,sb={f:rb},tb=sb.f("iterator"),ub=d(function(a){a.exports={default:tb,__esModule:!0}}),vb=t.f,wb=function(a){var b=f.Symbol||(f.Symbol={});"_"==a.charAt(0)||a in b||vb(b,a,{value:sb.f(a)})},xb=function(a){var b=Y(a),c=$.f;if(c)for(var d,e=c(a),f=aa.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},yb=X.concat("length","prototype"),zb=Object.getOwnPropertyNames||function(a){return W(a,yb)},Ab={f:zb},Bb=Ab.f,Cb={}.toString,Db="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Eb=function(a){try{return Bb(a)}catch(a){return Db.slice()}},Fb=function(a){return Db&&"[object Window]"==Cb.call(a)?Eb(a):Bb(E(a))},Gb={f:Fb},Hb=Object.getOwnPropertyDescriptor,Ib=l?Hb:function(a,b){if(a=E(a),b=q(b,!0),p)try{return Hb(a,b)}catch(a){}if(z(a,b))return u(!aa.f.call(a,b),a[b])},Jb={f:Ib},Kb=$a.KEY,Lb=Jb.f,Mb=t.f,Nb=Gb.f,Ob=e.Symbol,Pb=e.JSON,Qb=Pb&&Pb.stringify,Rb=qa("_hidden"),Sb=qa("toPrimitive"),Tb={}.propertyIsEnumerable,Ub=O("symbol-registry"),Vb=O("symbols"),Wb=O("op-symbols"),Xb=Object.prototype,Yb="function"==typeof Ob,Zb=e.QObject,$b=!Zb||!Zb.prototype||!Zb.prototype.findChild,_b=l&&k(function(){return 7!=pa(Mb({},"a",{get:function(){return Mb(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=Lb(Xb,b);d&&delete Xb[b],Mb(a,b,c),d&&a!==Xb&&Mb(Xb,b,d)}:Mb,ac=function(a){var b=Vb[a]=pa(Ob.prototype);return b._k=a,b},bc=Yb&&"symbol"==typeof Ob.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof Ob},cc=function(a,b,c){return a===Xb&&cc(Wb,b,c),j(a),b=q(b,!0),j(c),z(Vb,b)?(c.enumerable?(z(a,Rb)&&a[Rb][b]&&(a[Rb][b]=!1),c=pa(c,{enumerable:u(0,!1)})):(z(a,Rb)||Mb(a,Rb,u(1,{})),a[Rb][b]=!0),_b(a,b,c)):Mb(a,b,c)},dc=function(a,b){j(a);for(var c,d=xb(b=E(b)),e=0,f=d.length;f>e;)cc(a,c=d[e++],b[c]);return a},ec=function(a,b){return void 0===b?pa(a):dc(pa(a),b)},fc=function(a){var b=Tb.call(this,a=q(a,!0));return!(this===Xb&&z(Vb,a)&&!z(Wb,a))&&(!(b||!z(this,a)||!z(Vb,a)||z(this,Rb)&&this[Rb][a])||b)},gc=function(a,b){if(a=E(a),b=q(b,!0),a!==Xb||!z(Vb,b)||z(Wb,b)){var c=Lb(a,b);return!c||!z(Vb,b)||z(a,Rb)&&a[Rb][b]||(c.enumerable=!0),c}},hc=function(a){for(var b,c=Nb(E(a)),d=[],e=0;c.length>e;)z(Vb,b=c[e++])||b==Rb||b==Kb||d.push(b);return d},ic=function(a){for(var b,c=a===Xb,d=Nb(c?Wb:E(a)),e=[],f=0;d.length>f;)!z(Vb,b=d[f++])||c&&!z(Xb,b)||e.push(Vb[b]);return e};Yb||(Ob=function(){if(this instanceof Ob)throw TypeError("Symbol is not a constructor!");var a=R(arguments.length>0?arguments[0]:void 0),b=function(c){this===Xb&&b.call(Wb,c),z(this,Rb)&&z(this[Rb],a)&&(this[Rb][a]=!1),_b(this,a,u(1,c))};return l&&$b&&_b(Xb,a,{configurable:!0,set:b}),ac(a)},ha(Ob.prototype,"toString",function(){return this._k}),Jb.f=gc,t.f=cc,Ab.f=Gb.f=hc,aa.f=fc,$.f=ic,sb.f=function(a){return ac(qa(a))}),x(x.G+x.W+x.F*!Yb,{Symbol:Ob});for(var jc="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),kc=0;jc.length>kc;)qa(jc[kc++]);for(var lc=Y(qa.store),mc=0;lc.length>mc;)wb(lc[mc++]);x(x.S+x.F*!Yb,"Symbol",{for:function(a){return z(Ub,a+="")?Ub[a]:Ub[a]=Ob(a)},keyFor:function(a){if(!bc(a))throw TypeError(a+" is not a symbol!");for(var b in Ub)if(Ub[b]===a)return b},useSetter:function(){$b=!0},useSimple:function(){$b=!1}}),x(x.S+x.F*!Yb,"Object",{create:ec,defineProperty:cc,defineProperties:dc,getOwnPropertyDescriptor:gc,getOwnPropertyNames:hc,getOwnPropertySymbols:ic}),Pb&&x(x.S+x.F*(!Yb||k(function(){var a=Ob();return"[null]"!=Qb([a])||"{}"!=Qb({a:a})||"{}"!=Qb(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!bc(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&fb(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!bc(b))return b}),d[1]=b,Qb.apply(Pb,d)}}}),Ob.prototype[Sb]||v(Ob.prototype,Sb,Ob.prototype.valueOf),ta(Ob,"Symbol"),ta(Math,"Math",!0),ta(e.JSON,"JSON",!0),wb("asyncIterator"),wb("observable");var nc=f.Symbol,oc=d(function(a){a.exports={default:nc,__esModule:!0}}),pc=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(ub),e=c(oc),f="function"==typeof e.default&&"symbol"==typeof d.default?function(a){return typeof a}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":typeof a};b.default="function"==typeof e.default&&"symbol"===f(d.default)?function(a){return void 0===a?"undefined":f(a)}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":void 0===a?"undefined":f(a)}}),qc=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(pc);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,c.default)(b))&&"function"!=typeof b?a:b}}),rc=c(qc),sc=function(a,b){if(j(a),!i(b)&&null!==b)throw TypeError(b+": can't set as prototype!")},tc={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=h(Function.call,Jb.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,d){return sc(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):void 0),check:sc};x(x.S,"Object",{setPrototypeOf:tc.set});var uc=f.Object.setPrototypeOf,vc=d(function(a){a.exports={default:uc,__esModule:!0}});x(x.S,"Object",{create:pa});var wc=f.Object,xc=function(a,b){return wc.create(a,b)},yc=d(function(a){a.exports={default:xc,__esModule:!0}}),zc=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(vc),e=c(yc),f=c(pc);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,f.default)(b)));a.prototype=(0,e.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(d.default?(0,d.default)(a,b):a.__proto__=b)}}),Ac=c(zc),Bc=b.Protocals.CommandType,Cc=b.Protocals.GenericCommand,Dc=b.Protocals.AckCommand,Ec=function(a){return console.warn(a.message)},Fc=function(a){function c(d,e,f){qb(this,c);var g=rc(this,a.call(this));return g._appId=d,g.id=e,g._connection=f,g._eventemitter=new b.EventEmitter,g._querys=new ob,g}return Ac(c,a),c.prototype._send=function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return(b=this._connection).send.apply(b,[ga(a,{appId:this._appId,installationId:this.id,service:1})].concat(d))},c.prototype._open=function(){return this._send(new Cc({cmd:Bc.login}))},c.prototype.close=function(){var a=this;return this._send(new Cc({cmd:Bc.logout})).then(function(){return a._eventemitter.emit("close")})},c.prototype.register=function(a){this._querys.add(a)},c.prototype.deregister=function(a){this._querys.delete(a),this._querys.size||this.close().catch(Ec)},c.prototype._dispatchCommand=function(a){return a.cmd!==Bc.data?(this.emit("unhandledmessage",a),b.Promise.resolve()):this._dispatchDataCommand(a)},c.prototype._dispatchDataCommand=function(a){var b=a.dataMessage,c=b.ids,d=b.msg;this.emit("message",d.map(function(a){var b=a.data;return JSON.parse(b)}));var e=new Cc({cmd:Bc.ack,ackMessage:new Dc({ids:c})});return this._send(e,!1).catch(Ec)},c}(b.EventEmitter),Gc=function(a){a._liveQueryClients={},a.createLiveQueryClient=function(c){if(void 0!==a._liveQueryClients[c])return b.Promise.resolve(a._liveQueryClients[c]);var d=a._open().then(function(b){var d=new Fc(a._options.appId,c,b);return b.on("reconnect",function(){return d._open().then(function(){return d.emit("reconnect")},function(a){return d.emit("reconnecterror",a)})}),d._eventemitter.on("close",function(){delete a._liveQueryClients[d.id],a._deregister(d)},a),d._open().then(function(){return a._liveQueryClients[d.id]=d,a._register(d),d})});return a._liveQueryClients[c]=d,d}},Hc=function(a,b){if(!a.installationId||1!==a.service)return!0;var c=b._liveQueryClients[a.installationId];return c?c._dispatchCommand(a).catch(function(a){return console.warn(a)}):console.warn("Unexpected message received without any live client match: %O",a),!1},Ic={name:"leancloud-realtime-plugin-live-query",onRealtimeCreate:Gc,beforeCommandDispatch:Hc};a.LiveQueryPlugin=Ic,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=live-query.min.js.map