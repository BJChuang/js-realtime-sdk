!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-realtime")):"function"==typeof define&&define.amd?define("webrtc",["exports","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV)}(this,function(a,b){"use strict";function c(a,b){return b={exports:{}},a(b,b.exports),b.exports}var d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=c(function(a){var b=a.exports={version:"2.4.0"};"number"==typeof __e&&(__e=b)}),f=e&&"object"==typeof e&&"default"in e?e["default"]:e,g=c(function(a){a.exports={}}),h=g&&"object"==typeof g&&"default"in g?g["default"]:g,i=c(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),j=i&&"object"==typeof i&&"default"in i?i["default"]:i,k=c(function(a){var b=0,c=Math.random();a.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++b+c).toString(36))}}),l=k&&"object"==typeof k&&"default"in k?k["default"]:k,m=c(function(a){var b=j,c="__core-js_shared__",d=b[c]||(b[c]={});a.exports=function(a){return d[a]||(d[a]={})}}),n=m&&"object"==typeof m&&"default"in m?m["default"]:m,o=c(function(a){var b=n("wks"),c=l,d=j.Symbol,e="function"==typeof d,f=a.exports=function(a){return b[a]||(b[a]=e&&d[a]||(e?d:c)("Symbol."+a))};f.store=b}),p=o&&"object"==typeof o&&"default"in o?o["default"]:o,q=c(function(a){var b={}.toString;a.exports=function(a){return b.call(a).slice(8,-1)}}),r=q&&"object"==typeof q&&"default"in q?q["default"]:q,s=c(function(a){var b=r,c=p("toStringTag"),d="Arguments"==b(function(){return arguments}()),e=function(a,b){try{return a[b]}catch(c){}};a.exports=function(a){var f,g,h;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(g=e(f=Object(a),c))?g:d?b(f):"Object"==(h=b(f))&&"function"==typeof f.callee?"Arguments":h}}),t=s&&"object"==typeof s&&"default"in s?s["default"]:s,u=c(function(a){var b=t,c=p("iterator"),d=h;a.exports=f.getIteratorMethod=function(a){if(void 0!=a)return a[c]||a["@@iterator"]||d[b(a)]}}),v=u&&"object"==typeof u&&"default"in u?u["default"]:u,w=c(function(a){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}}),x=w&&"object"==typeof w&&"default"in w?w["default"]:w,y=c(function(a){var b=x;a.exports=function(a){if(!b(a))throw TypeError(a+" is not an object!");return a}}),z=y&&"object"==typeof y&&"default"in y?y["default"]:y,A=c(function(a){var b=z,c=v;a.exports=f.getIterator=function(a){var d=c(a);if("function"!=typeof d)throw TypeError(a+" is not iterable!");return b(d.call(a))}}),B=A&&"object"==typeof A&&"default"in A?A["default"]:A,C=c(function(a){var b=n("keys"),c=l;a.exports=function(a){return b[a]||(b[a]=c(a))}}),D=C&&"object"==typeof C&&"default"in C?C["default"]:C,E=c(function(a){a.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}}),F=E&&"object"==typeof E&&"default"in E?E["default"]:E,G=c(function(a){var b=F;a.exports=function(a){return Object(b(a))}}),H=G&&"object"==typeof G&&"default"in G?G["default"]:G,I=c(function(a){var b={}.hasOwnProperty;a.exports=function(a,c){return b.call(a,c)}}),J=I&&"object"==typeof I&&"default"in I?I["default"]:I,K=c(function(a){var b=J,c=H,d=D("IE_PROTO"),e=Object.prototype;a.exports=Object.getPrototypeOf||function(a){return a=c(a),b(a,d)?a[d]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?e:null}}),L=K&&"object"==typeof K&&"default"in K?K["default"]:K,M=c(function(a){a.exports=function(a){try{return!!a()}catch(b){return!0}}}),N=M&&"object"==typeof M&&"default"in M?M["default"]:M,O=c(function(a){a.exports=!N(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),P=O&&"object"==typeof O&&"default"in O?O["default"]:O,Q=c(function(a){var b=x;a.exports=function(a,c){if(!b(a))return a;var d,e;if(c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;if("function"==typeof(d=a.valueOf)&&!b(e=d.call(a)))return e;if(!c&&"function"==typeof(d=a.toString)&&!b(e=d.call(a)))return e;throw TypeError("Can't convert object to primitive value")}}),R=Q&&"object"==typeof Q&&"default"in Q?Q["default"]:Q,S=c(function(a){var b=x,c=j.document,d=b(c)&&b(c.createElement);a.exports=function(a){return d?c.createElement(a):{}}}),T=S&&"object"==typeof S&&"default"in S?S["default"]:S,U=c(function(a){a.exports=!P&&!N(function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a})}),V=U&&"object"==typeof U&&"default"in U?U["default"]:U,W=c(function(a,b){var c=z,d=V,e=R,f=Object.defineProperty;b.f=P?Object.defineProperty:function(a,b,g){if(c(a),b=e(b,!0),c(g),d)try{return f(a,b,g)}catch(h){}if("get"in g||"set"in g)throw TypeError("Accessors not supported!");return"value"in g&&(a[b]=g.value),a}}),X=W&&"object"==typeof W&&"default"in W?W["default"]:W,Y=c(function(a){var b=X.f,c=J,d=p("toStringTag");a.exports=function(a,e,f){a&&!c(a=f?a:a.prototype,d)&&b(a,d,{configurable:!0,value:e})}}),Z=Y&&"object"==typeof Y&&"default"in Y?Y["default"]:Y,$=c(function(a){a.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}}}),_=$&&"object"==typeof $&&"default"in $?$["default"]:$,aa=c(function(a){var b=X,c=_;a.exports=P?function(a,d,e){return b.f(a,d,c(1,e))}:function(a,b,c){return a[b]=c,a}}),ba=aa&&"object"==typeof aa&&"default"in aa?aa["default"]:aa,ca=c(function(a){a.exports=j.document&&document.documentElement}),da=ca&&"object"==typeof ca&&"default"in ca?ca["default"]:ca,ea=c(function(a){a.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),fa=ea&&"object"==typeof ea&&"default"in ea?ea["default"]:ea,ga=c(function(a){var b=Math.ceil,c=Math.floor;a.exports=function(a){return isNaN(a=+a)?0:(a>0?c:b)(a)}}),ha=ga&&"object"==typeof ga&&"default"in ga?ga["default"]:ga,ia=c(function(a){var b=ha,c=Math.max,d=Math.min;a.exports=function(a,e){return a=b(a),a<0?c(a+e,0):d(a,e)}}),ja=ia&&"object"==typeof ia&&"default"in ia?ia["default"]:ia,ka=c(function(a){var b=ha,c=Math.min;a.exports=function(a){return a>0?c(b(a),9007199254740991):0}}),la=ka&&"object"==typeof ka&&"default"in ka?ka["default"]:ka,ma=c(function(a){var b=r;a.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==b(a)?a.split(""):Object(a)}}),na=ma&&"object"==typeof ma&&"default"in ma?ma["default"]:ma,oa=c(function(a){var b=na,c=F;a.exports=function(a){return b(c(a))}}),pa=oa&&"object"==typeof oa&&"default"in oa?oa["default"]:oa,qa=c(function(a){var b=pa,c=la,d=ja;a.exports=function(a){return function(e,f,g){var h,i=b(e),j=c(i.length),k=d(g,j);if(a&&f!=f){for(;j>k;)if(h=i[k++],h!=h)return!0}else for(;j>k;k++)if((a||k in i)&&i[k]===f)return a||k||0;return!a&&-1}}}),ra=qa&&"object"==typeof qa&&"default"in qa?qa["default"]:qa,sa=c(function(a){var b=J,c=pa,d=ra(!1),e=D("IE_PROTO");a.exports=function(a,f){var g,h=c(a),i=0,j=[];for(g in h)g!=e&&b(h,g)&&j.push(g);for(;f.length>i;)b(h,g=f[i++])&&(~d(j,g)||j.push(g));return j}}),ta=sa&&"object"==typeof sa&&"default"in sa?sa["default"]:sa,ua=c(function(a){var b=ta,c=fa;a.exports=Object.keys||function(a){return b(a,c)}}),va=ua&&"object"==typeof ua&&"default"in ua?ua["default"]:ua,wa=c(function(a){var b=X,c=z,d=va;a.exports=P?Object.defineProperties:function(a,e){c(a);for(var f,g=d(e),h=g.length,i=0;h>i;)b.f(a,f=g[i++],e[f]);return a}}),xa=wa&&"object"==typeof wa&&"default"in wa?wa["default"]:wa,ya=c(function(a){var b=z,c=xa,d=fa,e=D("IE_PROTO"),f=function(){},g="prototype",h=function(){var a,b=T("iframe"),c=d.length,e="<",f=">";for(b.style.display="none",da.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write(e+"script"+f+"document.F=Object"+e+"/script"+f),a.close(),h=a.F;c--;)delete h[g][d[c]];return h()};a.exports=Object.create||function(a,d){var i;return null!==a?(f[g]=b(a),i=new f,f[g]=null,i[e]=a):i=h(),void 0===d?i:c(i,d)}}),za=ya&&"object"==typeof ya&&"default"in ya?ya["default"]:ya,Aa=c(function(a){var b=za,c=_,d=Z,e={};ba(e,p("iterator"),function(){return this}),a.exports=function(a,f,g){a.prototype=b(e,{next:c(1,g)}),d(a,f+" Iterator")}}),Ba=Aa&&"object"==typeof Aa&&"default"in Aa?Aa["default"]:Aa,Ca=c(function(a){a.exports=ba}),Da=Ca&&"object"==typeof Ca&&"default"in Ca?Ca["default"]:Ca,Ea=c(function(a){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}}),Fa=Ea&&"object"==typeof Ea&&"default"in Ea?Ea["default"]:Ea,Ga=c(function(a){var b=Fa;a.exports=function(a,c,d){if(b(a),void 0===c)return a;switch(d){case 1:return function(b){return a.call(c,b)};case 2:return function(b,d){return a.call(c,b,d)};case 3:return function(b,d,e){return a.call(c,b,d,e)}}return function(){return a.apply(c,arguments)}}}),Ha=Ga&&"object"==typeof Ga&&"default"in Ga?Ga["default"]:Ga,Ia=c(function(a){var b=j,c=f,d=Ha,e=ba,g="prototype",h=function(a,f,i){var j,k,l,m=a&h.F,n=a&h.G,o=a&h.S,p=a&h.P,q=a&h.B,r=a&h.W,s=n?c:c[f]||(c[f]={}),t=s[g],u=n?b:o?b[f]:(b[f]||{})[g];n&&(i=f);for(j in i)k=!m&&u&&void 0!==u[j],k&&j in s||(l=k?u[j]:i[j],s[j]=n&&"function"!=typeof u[j]?i[j]:q&&k?d(l,b):r&&u[j]==l?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b[g]=a[g],b}(l):p&&"function"==typeof l?d(Function.call,l):l,p&&((s.virtual||(s.virtual={}))[j]=l,a&h.R&&t&&!t[j]&&e(t,j,l)))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,a.exports=h}),Ja=Ia&&"object"==typeof Ia&&"default"in Ia?Ia["default"]:Ia,Ka=c(function(a){a.exports=!0}),La=Ka&&"object"==typeof Ka&&"default"in Ka?Ka["default"]:Ka,Ma=c(function(a){var b=La,c=Ja,d=Da,e=ba,f=J,g=h,i=Ba,j=Z,k=L,l=p("iterator"),m=!([].keys&&"next"in[].keys()),n="@@iterator",o="keys",q="values",r=function(){return this};a.exports=function(a,h,p,s,t,u,v){i(p,h,s);var w,x,y,z=function(a){if(!m&&a in D)return D[a];switch(a){case o:return function(){return new p(this,a)};case q:return function(){return new p(this,a)}}return function(){return new p(this,a)}},A=h+" Iterator",B=t==q,C=!1,D=a.prototype,E=D[l]||D[n]||t&&D[t],F=E||z(t),G=t?B?z("entries"):F:void 0,H="Array"==h?D.entries||E:E;if(H&&(y=k(H.call(new a)),y!==Object.prototype&&(j(y,A,!0),b||f(y,l)||e(y,l,r))),B&&E&&E.name!==q&&(C=!0,F=function(){return E.call(this)}),b&&!v||!m&&!C&&D[l]||e(D,l,F),g[h]=F,g[A]=r,t)if(w={values:B?F:z(q),keys:u?F:z(o),entries:G},v)for(x in w)x in D||d(D,x,w[x]);else c(c.P+c.F*(m||C),h,w);return w}}),Na=Ma&&"object"==typeof Ma&&"default"in Ma?Ma["default"]:Ma,Oa=c(function(a){var b=ha,c=F;a.exports=function(a){return function(d,e){var f,g,h=String(c(d)),i=b(e),j=h.length;return i<0||i>=j?a?"":void 0:(f=h.charCodeAt(i),f<55296||f>56319||i+1===j||(g=h.charCodeAt(i+1))<56320||g>57343?a?h.charAt(i):f:a?h.slice(i,i+2):(f-55296<<10)+(g-56320)+65536)}}}),Pa=Oa&&"object"==typeof Oa&&"default"in Oa?Oa["default"]:Oa,Qa=(c(function(a){var b=Pa(!0);Na(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,c=this._t,d=this._i;return d>=c.length?{value:void 0,done:!0}:(a=b(c,d),this._i+=a.length,{value:a,done:!1})})}),c(function(a){a.exports=function(a,b){return{value:b,done:!!a}}})),Ra=Qa&&"object"==typeof Qa&&"default"in Qa?Qa["default"]:Qa,Sa=c(function(a){a.exports=function(){}}),Ta=Sa&&"object"==typeof Sa&&"default"in Sa?Sa["default"]:Sa,Ua=(c(function(a){var b=Ta,c=Ra,d=h,e=pa;a.exports=Na(Array,"Array",function(a,b){this._t=e(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,d=this._i++;return!a||d>=a.length?(this._t=void 0,c(1)):"keys"==b?c(0,d):"values"==b?c(0,a[d]):c(0,[d,a[d]])},"values"),d.Arguments=d.Array,b("keys"),b("values"),b("entries")}),c(function(a){for(var b=j,c=ba,d=h,e=p("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],g=0;g<5;g++){var i=f[g],k=b[i],l=k&&k.prototype;l&&!l[e]&&c(l,e,i),d[i]=d.Array}}),c(function(a){a.exports=B})),Va=Ua&&"object"==typeof Ua&&"default"in Ua?Ua["default"]:Ua,Wa=c(function(a){a.exports={"default":Va,__esModule:!0}}),Xa=Wa&&"object"==typeof Wa&&"default"in Wa?Wa["default"]:Wa,Ya=c(function(a){var b=t,c=p("iterator"),d=h;a.exports=f.isIterable=function(a){var e=Object(a);return void 0!==e[c]||"@@iterator"in e||d.hasOwnProperty(b(e))}}),Za=Ya&&"object"==typeof Ya&&"default"in Ya?Ya["default"]:Ya,$a=c(function(a){a.exports=Za}),_a=$a&&"object"==typeof $a&&"default"in $a?$a["default"]:$a,ab=c(function(a){a.exports={"default":_a,__esModule:!0}}),bb=ab&&"object"==typeof ab&&"default"in ab?ab["default"]:ab,cb=c(function(a,b){function c(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var d=bb,e=c(d),f=Xa,g=c(f);b["default"]=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var h,i=(0,g["default"])(a);!(d=(h=i.next()).done)&&(c.push(h.value),!b||c.length!==b);d=!0);}catch(j){e=!0,f=j}finally{try{!d&&i["return"]&&i["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if((0,e["default"])(Object(b)))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),db=cb&&"object"==typeof cb&&"default"in cb?cb["default"]:cb,eb=c(function(a){var b=p("iterator"),c=!1;try{var d=[7][b]();d["return"]=function(){c=!0},Array.from(d,function(){throw 2})}catch(e){}a.exports=function(a,d){if(!d&&!c)return!1;var e=!1;try{var f=[7],g=f[b]();g.next=function(){return{done:e=!0}},f[b]=function(){return g},a(f)}catch(h){}return e}}),fb=eb&&"object"==typeof eb&&"default"in eb?eb["default"]:eb,gb=c(function(a){var b=j,c=f,d=X,e=P,g=p("species");a.exports=function(a){var f="function"==typeof c[a]?c[a]:b[a];e&&f&&!f[g]&&d.f(f,g,{configurable:!0,get:function(){return this}})}}),hb=gb&&"object"==typeof gb&&"default"in gb?gb["default"]:gb,ib=c(function(a){var b=ba;a.exports=function(a,c,d){for(var e in c)d&&a[e]?a[e]=c[e]:b(a,e,c[e]);return a}}),jb=ib&&"object"==typeof ib&&"default"in ib?ib["default"]:ib,kb=c(function(a){a.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)}}),lb=kb&&"object"==typeof kb&&"default"in kb?kb["default"]:kb,mb=c(function(a){var b,c,d,e=Ha,f=lb,g=da,h=T,i=j,k=i.process,l=i.setImmediate,m=i.clearImmediate,n=i.MessageChannel,o=0,p={},q="onreadystatechange",s=function(){var a=+this;if(p.hasOwnProperty(a)){var b=p[a];delete p[a],b()}},t=function(a){s.call(a.data)};l&&m||(l=function(a){for(var c=[],d=1;arguments.length>d;)c.push(arguments[d++]);return p[++o]=function(){f("function"==typeof a?a:Function(a),c)},b(o),o},m=function(a){delete p[a]},"process"==r(k)?b=function(a){k.nextTick(e(s,a,1))}:n?(c=new n,d=c.port2,c.port1.onmessage=t,b=e(d.postMessage,d,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(b=function(a){i.postMessage(a+"","*")},i.addEventListener("message",t,!1)):b=q in h("script")?function(a){g.appendChild(h("script"))[q]=function(){g.removeChild(this),s.call(a)}}:function(a){setTimeout(e(s,a,1),0)}),a.exports={set:l,clear:m}}),nb=mb&&"object"==typeof mb&&"default"in mb?mb["default"]:mb,ob=c(function(a){var b=j,c=nb.set,d=b.MutationObserver||b.WebKitMutationObserver,e=b.process,f=b.Promise,g="process"==r(e);a.exports=function(){var a,h,i,j=function(){var b,c;for(g&&(b=e.domain)&&b.exit();a;){c=a.fn,a=a.next;try{c()}catch(d){throw a?i():h=void 0,d}}h=void 0,b&&b.enter()};if(g)i=function(){e.nextTick(j)};else if(d){var k=!0,l=document.createTextNode("");new d(j).observe(l,{characterData:!0}),i=function(){l.data=k=!k}}else if(f&&f.resolve){var m=f.resolve();i=function(){m.then(j)}}else i=function(){c.call(b,j)};return function(b){var c={fn:b,next:void 0};h&&(h.next=c),a||(a=c,i()),h=c}}}),pb=ob&&"object"==typeof ob&&"default"in ob?ob["default"]:ob,qb=c(function(a){var b=z,c=Fa,d=p("species");a.exports=function(a,e){var f,g=b(a).constructor;return void 0===g||void 0==(f=b(g)[d])?e:c(f)}}),rb=qb&&"object"==typeof qb&&"default"in qb?qb["default"]:qb,sb=c(function(a){var b=h,c=p("iterator"),d=Array.prototype;a.exports=function(a){return void 0!==a&&(b.Array===a||d[c]===a)}}),tb=sb&&"object"==typeof sb&&"default"in sb?sb["default"]:sb,ub=c(function(a){var b=z;a.exports=function(a,c,d,e){try{return e?c(b(d)[0],d[1]):c(d)}catch(f){var g=a["return"];throw void 0!==g&&b(g.call(a)),f}}}),vb=ub&&"object"==typeof ub&&"default"in ub?ub["default"]:ub,wb=c(function(a){var b=Ha,c=vb,d=tb,e=z,f=la,g=v,h={},i={},j=a.exports=function(a,j,k,l,m){var n,o,p,q,r=m?function(){return a}:g(a),s=b(k,l,j?2:1),t=0;if("function"!=typeof r)throw TypeError(a+" is not iterable!");if(d(r)){for(n=f(a.length);n>t;t++)if(q=j?s(e(o=a[t])[0],o[1]):s(a[t]),q===h||q===i)return q}else for(p=r.call(a);!(o=p.next()).done;)if(q=c(p,s,o.value,j),q===h||q===i)return q};j.BREAK=h,j.RETURN=i}),xb=wb&&"object"==typeof wb&&"default"in wb?wb["default"]:wb,yb=c(function(a){a.exports=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a}}),zb=yb&&"object"==typeof yb&&"default"in yb?yb["default"]:yb,Ab=(c(function(a){var b,c,d,e=La,g=j,h=Ha,i=t,k=Ja,l=x,m=Fa,n=zb,o=xb,q=rb,r=nb.set,s=pb(),u="Promise",v=g.TypeError,w=g.process,y=g[u],w=g.process,z="process"==i(w),A=function(){},B=!!function(){try{var a=y.resolve(1),b=(a.constructor={})[p("species")]=function(a){a(A,A)};return(z||"function"==typeof PromiseRejectionEvent)&&a.then(A)instanceof b}catch(c){}}(),C=function(a,b){return a===b||a===y&&b===d},D=function(a){var b;return!(!l(a)||"function"!=typeof(b=a.then))&&b},E=function(a){return C(y,a)?new F(a):new c(a)},F=c=function(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw v("Bad Promise constructor");b=a,c=d}),this.resolve=m(b),this.reject=m(c)},G=function(a){try{a()}catch(b){return{error:b}}},H=function(a,b){if(!a._n){a._n=!0;var c=a._c;s(function(){for(var d=a._v,e=1==a._s,f=0,g=function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(e||(2==a._h&&K(a),a._h=1),g===!0?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(v("Promise-chain cycle")):(f=D(c))?f.call(c,h,i):h(c)):i(d)}catch(k){i(k)}};c.length>f;)g(c[f++]);a._c=[],a._n=!1,b&&!a._h&&I(a)})}},I=function(a){r.call(g,function(){var b,c,d,e=a._v;if(J(a)&&(b=G(function(){z?w.emit("unhandledRejection",e,a):(c=g.onunhandledrejection)?c({promise:a,reason:e}):(d=g.console)&&d.error&&d.error("Unhandled promise rejection",e)}),a._h=z||J(a)?2:1),a._a=void 0,b)throw b.error})},J=function(a){if(1==a._h)return!1;for(var b,c=a._a||a._c,d=0;c.length>d;)if(b=c[d++],b.fail||!J(b.promise))return!1;return!0},K=function(a){r.call(g,function(){var b;z?w.emit("rejectionHandled",a):(b=g.onrejectionhandled)&&b({promise:a,reason:a._v})})},L=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),H(b,!0))},M=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw v("Promise can't be resolved itself");(b=D(a))?s(function(){var d={_w:c,_d:!1};try{b.call(a,h(M,d,1),h(L,d,1))}catch(e){L.call(d,e)}}):(c._v=a,c._s=1,H(c,!1))}catch(d){L.call({_w:c,_d:!1},d)}}};B||(y=function(a){n(this,y,u,"_h"),m(a),b.call(this);try{a(h(M,this,1),h(L,this,1))}catch(c){L.call(this,c)}},b=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},b.prototype=jb(y.prototype,{then:function(a,b){var c=E(q(this,y));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=z?w.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&H(this,!1),c.promise},"catch":function(a){return this.then(void 0,a)}}),F=function(){var a=new b;this.promise=a,this.resolve=h(M,a,1),this.reject=h(L,a,1)}),k(k.G+k.W+k.F*!B,{Promise:y}),Z(y,u),hb(u),d=f[u],k(k.S+k.F*!B,u,{reject:function(a){var b=E(this),c=b.reject;return c(a),b.promise}}),k(k.S+k.F*(e||!B),u,{resolve:function(a){if(a instanceof y&&C(a.constructor,this))return a;var b=E(this),c=b.resolve;return c(a),b.promise}}),k(k.S+k.F*!(B&&fb(function(a){y.all(a)["catch"](A)})),u,{all:function(a){var b=this,c=E(b),d=c.resolve,e=c.reject,f=G(function(){var c=[],f=0,g=1;o(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f&&e(f.error),c.promise},race:function(a){var b=this,c=E(b),d=c.reject,e=G(function(){o(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e&&d(e.error),c.promise}})}),c(function(a){a.exports=f.Promise})),Bb=Ab&&"object"==typeof Ab&&"default"in Ab?Ab["default"]:Ab,Cb=c(function(a){a.exports={"default":Bb,__esModule:!0}}),Db=Cb&&"object"==typeof Cb&&"default"in Cb?Cb["default"]:Cb,Eb=c(function(a,b){b.f={}.propertyIsEnumerable}),Fb=Eb&&"object"==typeof Eb&&"default"in Eb?Eb["default"]:Eb,Gb=c(function(a,b){b.f=Object.getOwnPropertySymbols}),Hb=Gb&&"object"==typeof Gb&&"default"in Gb?Gb["default"]:Gb,Ib=c(function(a){var b=va,c=Hb,d=Fb,e=H,f=na,g=Object.assign;a.exports=!g||N(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=g({},a)[c]||Object.keys(g({},b)).join("")!=d})?function(a,g){for(var h=e(a),i=arguments.length,j=1,k=c.f,l=d.f;i>j;)for(var m,n=f(arguments[j++]),o=k?b(n).concat(k(n)):b(n),p=o.length,q=0;p>q;)l.call(n,m=o[q++])&&(h[m]=n[m]);return h}:g}),Jb=Ib&&"object"==typeof Ib&&"default"in Ib?Ib["default"]:Ib,Kb=(c(function(a){var b=Ja;b(b.S+b.F,"Object",{assign:Jb})}),c(function(a){a.exports=f.Object.assign})),Lb=Kb&&"object"==typeof Kb&&"default"in Kb?Kb["default"]:Kb,Mb=c(function(a){a.exports={"default":Lb,__esModule:!0}}),Nb=Mb&&"object"==typeof Mb&&"default"in Mb?Mb["default"]:Mb,Ob=c(function(a,b){b.__esModule=!0,b["default"]=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),Pb=Ob&&"object"==typeof Ob&&"default"in Ob?Ob["default"]:Ob,Qb=c(function(a,b){b.f=p}),Rb=Qb&&"object"==typeof Qb&&"default"in Qb?Qb["default"]:Qb,Sb=c(function(a){var b=j,c=f,d=La,e=Rb,g=X.f;a.exports=function(a){var f=c.Symbol||(c.Symbol=d?{}:b.Symbol||{});"_"==a.charAt(0)||a in f||g(f,a,{value:e.f(a)})}}),Tb=Sb&&"object"==typeof Sb&&"default"in Sb?Sb["default"]:Sb,Ub=(c(function(a){Tb("observable")}),c(function(a){Tb("asyncIterator")}),c(function(a,b){var c=ta,d=fa.concat("length","prototype");b.f=Object.getOwnPropertyNames||function(a){return c(a,d)}})),Vb=Ub&&"object"==typeof Ub&&"default"in Ub?Ub["default"]:Ub,Wb=c(function(a,b){var c=Fb,d=_,e=pa,f=R,g=J,h=V,i=Object.getOwnPropertyDescriptor;b.f=P?i:function(a,b){if(a=e(a),b=f(b,!0),h)try{return i(a,b)}catch(j){}if(g(a,b))return d(!c.f.call(a,b),a[b])}}),Xb=Wb&&"object"==typeof Wb&&"default"in Wb?Wb["default"]:Wb,Yb=c(function(a){var b=pa,c=Vb.f,d={}.toString,e="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(a){try{return c(a)}catch(b){return e.slice()}};a.exports.f=function(a){return e&&"[object Window]"==d.call(a)?f(a):c(b(a))}}),Zb=Yb&&"object"==typeof Yb&&"default"in Yb?Yb["default"]:Yb,$b=c(function(a){var b=r;a.exports=Array.isArray||function(a){return"Array"==b(a)}}),_b=$b&&"object"==typeof $b&&"default"in $b?$b["default"]:$b,ac=c(function(a){var b=va,c=Hb,d=Fb;a.exports=function(a){var e=b(a),f=c.f;if(f)for(var g,h=f(a),i=d.f,j=0;h.length>j;)i.call(a,g=h[j++])&&e.push(g);return e}}),bc=ac&&"object"==typeof ac&&"default"in ac?ac["default"]:ac,cc=c(function(a){var b=va,c=pa;a.exports=function(a,d){for(var e,f=c(a),g=b(f),h=g.length,i=0;h>i;)if(f[e=g[i++]]===d)return e}}),dc=cc&&"object"==typeof cc&&"default"in cc?cc["default"]:cc,ec=c(function(a){var b=l("meta"),c=x,d=J,e=X.f,f=0,g=Object.isExtensible||function(){return!0},h=!N(function(){return g(Object.preventExtensions({}))}),i=function(a){e(a,b,{value:{i:"O"+ ++f,w:{}}})},j=function(a,e){if(!c(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!d(a,b)){if(!g(a))return"F";if(!e)return"E";i(a)}return a[b].i},k=function(a,c){if(!d(a,b)){if(!g(a))return!0;if(!c)return!1;i(a)}return a[b].w},m=function(a){return h&&n.NEED&&g(a)&&!d(a,b)&&i(a),a},n=a.exports={KEY:b,NEED:!1,fastKey:j,getWeak:k,onFreeze:m}}),fc=ec&&"object"==typeof ec&&"default"in ec?ec["default"]:ec,gc=(c(function(a){var b=j,c=J,d=P,e=Ja,f=Da,g=fc.KEY,h=N,i=n,k=Z,m=l,o=p,q=Rb,r=Tb,s=dc,t=bc,u=_b,v=z,w=pa,x=R,y=_,A=za,B=Zb,C=Xb,D=X,E=va,F=C.f,G=D.f,H=B.f,I=b.Symbol,K=b.JSON,L=K&&K.stringify,M="prototype",O=o("_hidden"),Q=o("toPrimitive"),S={}.propertyIsEnumerable,T=i("symbol-registry"),U=i("symbols"),V=i("op-symbols"),W=Object[M],Y="function"==typeof I,$=b.QObject,aa=!$||!$[M]||!$[M].findChild,ca=d&&h(function(){return 7!=A(G({},"a",{get:function(){return G(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=F(W,b);d&&delete W[b],G(a,b,c),d&&a!==W&&G(W,b,d)}:G,da=function(a){var b=U[a]=A(I[M]);return b._k=a,b},ea=Y&&"symbol"==typeof I.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof I},fa=function(a,b,d){return a===W&&fa(V,b,d),v(a),b=x(b,!0),v(d),c(U,b)?(d.enumerable?(c(a,O)&&a[O][b]&&(a[O][b]=!1),d=A(d,{enumerable:y(0,!1)})):(c(a,O)||G(a,O,y(1,{})),a[O][b]=!0),ca(a,b,d)):G(a,b,d)},ga=function(a,b){v(a);for(var c,d=t(b=w(b)),e=0,f=d.length;f>e;)fa(a,c=d[e++],b[c]);return a},ha=function(a,b){return void 0===b?A(a):ga(A(a),b)},ia=function(a){var b=S.call(this,a=x(a,!0));return!(this===W&&c(U,a)&&!c(V,a))&&(!(b||!c(this,a)||!c(U,a)||c(this,O)&&this[O][a])||b)},ja=function(a,b){if(a=w(a),b=x(b,!0),a!==W||!c(U,b)||c(V,b)){var d=F(a,b);return!d||!c(U,b)||c(a,O)&&a[O][b]||(d.enumerable=!0),d}},ka=function(a){for(var b,d=H(w(a)),e=[],f=0;d.length>f;)c(U,b=d[f++])||b==O||b==g||e.push(b);return e},la=function(a){for(var b,d=a===W,e=H(d?V:w(a)),f=[],g=0;e.length>g;)!c(U,b=e[g++])||d&&!c(W,b)||f.push(U[b]);return f};Y||(I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var a=m(arguments.length>0?arguments[0]:void 0),b=function(d){this===W&&b.call(V,d),c(this,O)&&c(this[O],a)&&(this[O][a]=!1),ca(this,a,y(1,d))};return d&&aa&&ca(W,a,{configurable:!0,set:b}),da(a)},f(I[M],"toString",function(){return this._k}),C.f=ja,D.f=fa,Vb.f=B.f=ka,Fb.f=ia,Hb.f=la,d&&!La&&f(W,"propertyIsEnumerable",ia,!0),q.f=function(a){return da(o(a))}),e(e.G+e.W+e.F*!Y,{Symbol:I});for(var ma="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),na=0;ma.length>na;)o(ma[na++]);for(var ma=E(o.store),na=0;ma.length>na;)r(ma[na++]);e(e.S+e.F*!Y,"Symbol",{"for":function(a){return c(T,a+="")?T[a]:T[a]=I(a)},keyFor:function(a){if(ea(a))return s(T,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){aa=!0},useSimple:function(){aa=!1}}),e(e.S+e.F*!Y,"Object",{create:ha,defineProperty:fa,defineProperties:ga,getOwnPropertyDescriptor:ja,getOwnPropertyNames:ka,getOwnPropertySymbols:la}),K&&e(e.S+e.F*(!Y||h(function(){var a=I();return"[null]"!=L([a])||"{}"!=L({a:a})||"{}"!=L(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!ea(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&u(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!ea(b))return b}),d[1]=b,L.apply(K,d)}}}),I[M][Q]||ba(I[M],Q,I[M].valueOf),k(I,"Symbol"),k(Math,"Math",!0),k(b.JSON,"JSON",!0)}),c(function(a){a.exports=f.Symbol})),hc=gc&&"object"==typeof gc&&"default"in gc?gc["default"]:gc,ic=c(function(a){a.exports={"default":hc,__esModule:!0}}),jc=ic&&"object"==typeof ic&&"default"in ic?ic["default"]:ic,kc=c(function(a){a.exports=Rb.f("iterator")}),lc=kc&&"object"==typeof kc&&"default"in kc?kc["default"]:kc,mc=c(function(a){a.exports={"default":lc,__esModule:!0}}),nc=mc&&"object"==typeof mc&&"default"in mc?mc["default"]:mc,oc=c(function(a,b){function c(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var d=nc,e=c(d),f=jc,g=c(f),h="function"==typeof g["default"]&&"symbol"==typeof e["default"]?function(a){return typeof a}:function(a){return a&&"function"==typeof g["default"]&&a.constructor===g["default"]?"symbol":typeof a};b["default"]="function"==typeof g["default"]&&"symbol"===h(e["default"])?function(a){return"undefined"==typeof a?"undefined":h(a)}:function(a){return a&&"function"==typeof g["default"]&&a.constructor===g["default"]?"symbol":"undefined"==typeof a?"undefined":h(a)}}),pc=oc&&"object"==typeof oc&&"default"in oc?oc["default"]:oc,qc=c(function(a,b){function c(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var d=pc,e=c(d);b["default"]=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":(0,e["default"])(b))&&"function"!=typeof b?a:b}}),rc=qc&&"object"==typeof qc&&"default"in qc?qc["default"]:qc,sc=(c(function(a){var b=Ja;b(b.S,"Object",{create:za})}),c(function(a){var b=f.Object;a.exports=function(a,c){return b.create(a,c)}})),tc=sc&&"object"==typeof sc&&"default"in sc?sc["default"]:sc,uc=c(function(a){a.exports={"default":tc,__esModule:!0}}),vc=uc&&"object"==typeof uc&&"default"in uc?uc["default"]:uc,wc=c(function(a){var b=x,c=z,d=function(a,d){if(c(a),!b(d)&&null!==d)throw TypeError(d+": can't set as prototype!")};a.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=Ha(Function.call,Xb.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(e){b=!0}return function(a,e){return d(a,e),b?a.__proto__=e:c(a,e),a}}({},!1):void 0),check:d}}),xc=wc&&"object"==typeof wc&&"default"in wc?wc["default"]:wc,yc=(c(function(a){var b=Ja;b(b.S,"Object",{setPrototypeOf:xc.set})}),c(function(a){a.exports=f.Object.setPrototypeOf})),zc=yc&&"object"==typeof yc&&"default"in yc?yc["default"]:yc,Ac=c(function(a){a.exports={"default":zc,__esModule:!0}}),Bc=Ac&&"object"==typeof Ac&&"default"in Ac?Ac["default"]:Ac,Cc=c(function(a,b){function c(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var d=Bc,e=c(d),f=vc,g=c(f),h=pc,i=c(h);b["default"]=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":(0,i["default"])(b)));a.prototype=(0,g["default"])(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(e["default"]?(0,e["default"])(a,b):a.__proto__=b)}}),Dc=Cc&&"object"==typeof Cc&&"default"in Cc?Cc["default"]:Cc,Ec=c(function(a){function b(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function c(){}var d=Object.prototype.hasOwnProperty,e="function"!=typeof Object.create&&"~";c.prototype._events=void 0,c.prototype.eventNames=function(){var a,b=this._events,c=[];if(!b)return c;for(a in b)d.call(b,a)&&c.push(e?a.slice(1):a);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(b)):c},c.prototype.listeners=function(a,b){var c=e?e+a:a,d=this._events&&this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var f=0,g=d.length,h=new Array(g);f<g;f++)h[f]=d[f].fn;return h},c.prototype.emit=function(a,b,c,d,f,g){var h=e?e+a:a;if(!this._events||!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if("function"==typeof k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,f),!0;case 6:return k.fn.call(k.context,b,c,d,f,g),!0}for(j=1,i=new Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;default:if(!i)for(m=1,i=new Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i);
}}return!0},c.prototype.on=function(a,c,d){var f=new b(c,d||this),g=e?e+a:a;return this._events||(this._events=e?{}:Object.create(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],f]:this._events[g].push(f):this._events[g]=f,this},c.prototype.once=function(a,c,d){var f=new b(c,d||this,(!0)),g=e?e+a:a;return this._events||(this._events=e?{}:Object.create(null)),this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],f]:this._events[g].push(f):this._events[g]=f,this},c.prototype.removeListener=function(a,b,c,d){var f=e?e+a:a;if(!this._events||!this._events[f])return this;var g=this._events[f],h=[];if(b)if(g.fn)(g.fn!==b||d&&!g.once||c&&g.context!==c)&&h.push(g);else for(var i=0,j=g.length;i<j;i++)(g[i].fn!==b||d&&!g[i].once||c&&g[i].context!==c)&&h.push(g[i]);return h.length?this._events[f]=1===h.length?h[0]:h:delete this._events[f],this},c.prototype.removeAllListeners=function(a){return this._events?(a?delete this._events[e?e+a:a]:this._events=e?{}:Object.create(null),this):this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=e,"undefined"!=typeof a&&(a.exports=c)}),Fc=Ec&&"object"==typeof Ec&&"default"in Ec?Ec["default"]:Ec,Gc=(c(function(a){var b=Ja;b(b.S+b.F*!P,"Object",{defineProperty:X.f})}),c(function(a){var b=f.Object;a.exports=function(a,c,d){return b.defineProperty(a,c,d)}})),Hc=Gc&&"object"==typeof Gc&&"default"in Gc?Gc["default"]:Gc,Ic=c(function(a){a.exports={"default":Hc,__esModule:!0}}),Jc=Ic&&"object"==typeof Ic&&"default"in Ic?Ic["default"]:Ic,Kc=c(function(a,b){function c(a){return a&&a.__esModule?a:{"default":a}}b.__esModule=!0;var d=Jc,e=c(d);b["default"]=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),(0,e["default"])(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()}),Lc=Kc&&"object"==typeof Kc&&"default"in Kc?Kc["default"]:Kc,Mc=c(function(a,b){!function(){var c={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(a,b){var d="string"==typeof a.initial?{state:a.initial}:a.initial,e=a.terminal||a["final"],f=b||a.target||{},g=a.events||[],h=a.callbacks||{},i={},j={},k=function(a){var b=a.from instanceof Array?a.from:a.from?[a.from]:[c.WILDCARD];i[a.name]=i[a.name]||{};for(var d=0;d<b.length;d++)j[b[d]]=j[b[d]]||[],j[b[d]].push(a.name),i[a.name][b[d]]=a.to||b[d]};d&&(d.event=d.event||"startup",k({name:d.event,from:"none",to:d.state}));for(var l=0;l<g.length;l++)k(g[l]);for(var m in i)i.hasOwnProperty(m)&&(f[m]=c.buildEvent(m,i[m]));for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m]);return f.current="none",f.is=function(a){return a instanceof Array?a.indexOf(this.current)>=0:this.current===a},f.can=function(a){return!this.transition&&(i[a].hasOwnProperty(this.current)||i[a].hasOwnProperty(c.WILDCARD))},f.cannot=function(a){return!this.can(a)},f.transitions=function(){return j[this.current]},f.isFinished=function(){return this.is(e)},f.error=a.error||function(a,b,c,d,e,f,g){throw g||f},d&&!d.defer&&f[d.event](),f},doCallback:function(a,b,d,e,f,g){if(b)try{return b.apply(a,[d,e,f].concat(g))}catch(h){return a.error(d,e,f,g,c.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",h)}},beforeAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onbeforeevent,b,d,e,f)},afterAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onafterevent||a.onevent,b,d,e,f)},leaveAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onleavestate,b,d,e,f)},enterAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onenterstate||a.onstate,b,d,e,f)},changeState:function(a,b,d,e,f){return c.doCallback(a,a.onchangestate,b,d,e,f)},beforeThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onbefore"+b],b,d,e,f)},afterThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onafter"+b]||a["on"+b],b,d,e,f)},leaveThisState:function(a,b,d,e,f){return c.doCallback(a,a["onleave"+d],b,d,e,f)},enterThisState:function(a,b,d,e,f){return c.doCallback(a,a["onenter"+e]||a["on"+e],b,d,e,f)},beforeEvent:function(a,b,d,e,f){if(!1===c.beforeThisEvent(a,b,d,e,f)||!1===c.beforeAnyEvent(a,b,d,e,f))return!1},afterEvent:function(a,b,d,e,f){c.afterThisEvent(a,b,d,e,f),c.afterAnyEvent(a,b,d,e,f)},leaveState:function(a,b,d,e,f){var g=c.leaveThisState(a,b,d,e,f),h=c.leaveAnyState(a,b,d,e,f);return!1!==g&&!1!==h&&(c.ASYNC===g||c.ASYNC===h?c.ASYNC:void 0)},enterState:function(a,b,d,e,f){c.enterThisState(a,b,d,e,f),c.enterAnyState(a,b,d,e,f)},buildEvent:function(a,b){return function(){var d=this.current,e=b[d]||b[c.WILDCARD]||d,f=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,d,e,f,c.Error.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,d,e,f,c.Error.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+this.current);if(!1===c.beforeEvent(this,a,d,e,f))return c.Result.CANCELLED;if(d===e)return c.afterEvent(this,a,d,e,f),c.Result.NOTRANSITION;var g=this;this.transition=function(){return g.transition=null,g.current=e,c.enterState(g,a,d,e,f),c.changeState(g,a,d,e,f),c.afterEvent(g,a,d,e,f),c.Result.SUCCEEDED},this.transition.cancel=function(){g.transition=null,c.afterEvent(g,a,d,e,f)};var h=c.leaveState(this,a,d,e,f);return!1===h?(this.transition=null,c.Result.CANCELLED):c.ASYNC===h?c.Result.PENDING:this.transition?this.transition():void 0}}};"undefined"!=typeof b?("undefined"!=typeof a&&a.exports&&(b=a.exports=c),b.StateMachine=c):"function"==typeof define&&define.amd?define(function(a){return c}):"undefined"!=typeof window?window.StateMachine=c:"undefined"!=typeof self&&(self.StateMachine=c)}()}),Nc=Mc&&"object"==typeof Mc&&"default"in Mc?Mc["default"]:Mc,Oc=function(){return Nc.create({initial:"calling",events:[{name:"connect",from:"calling",to:"connected"},{name:"close",from:"connected",to:"closed"},{name:"cancel",from:"calling",to:"canceled"},{name:"refuse",from:"calling",to:"refused"}]})};if(!b.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var Pc=c(function(a,b){!function(c){function d(a){var b=l(a);if(r)for(var c,d=0;c=u[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function e(a,b,c){for(var e,f,g=d(c),i=0,j=g.length;i<j;)"__self"!==(e=g[i++])&&(f=c[e],p(f)&&(!h||f.toString().indexOf(".__base")>-1)?b[e]=function(c,d){var e=a[c]?a[c]:"__constructor"===c?b.__self.__parent:q,f=function(){var a=this.__base;this.__base=f.__base;var b=d.apply(this,arguments);return this.__base=a,b};return f.__base=e,f}(e,f):b[e]=f)}function f(a,b){for(var c,d=1;c=a[d++];)b?p(c)?g.self(b,c.prototype,c):g.self(b,c):b=p(c)?g(a[0],c.prototype,c):g(a[0],c);return b||a[0]}function g(){var a=arguments,b=o(a[0]),c=b||p(a[0]),d=c?b?f(a[0]):a[0]:i,g=a[c?1:0]||{},h=a[c?2:1],j=g.__constructor||c&&d.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:c?function(){return d.apply(this,arguments)}:function(){};if(!c)return j.prototype=g,j.prototype.__self=j.prototype.constructor=j,m(j,h);m(j,d),j.__parent=d;var l=d.prototype,n=j.prototype=k(l);return n.__self=n.constructor=j,g&&e(l,n,g),h&&e(d,j,h),j}var h=function(){"_"}.toString().indexOf("_")>-1,i=function(){},j=Object.prototype.hasOwnProperty,k=Object.create||function(a){var b=function(){};return b.prototype=a,new b},l=Object.keys||function(a){var b=[];for(var c in a)j.call(a,c)&&b.push(c);return b},m=function(a,b){for(var c in b)j.call(b,c)&&(a[c]=b[c]);return a},n=Object.prototype.toString,o=Array.isArray||function(a){return"[object Array]"===n.call(a)},p=function(a){return"[object Function]"===n.call(a)},q=function(){},r=!0,s={toString:""};for(var t in s)s.hasOwnProperty(t)&&(r=!1);var u=r?["toString","valueOf"]:null;g.self=function(){var a=arguments,b=o(a[0]),c=b?f(a[0],a[0][0]):a[0],d=a[1],g=a[2],h=c.prototype;return d&&e(h,h,d),g&&e(c,c,g),c};var v=!0;"object"==typeof b&&(a.exports=g,v=!1),"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",function(a){a(g)}),v=!1),"function"==typeof define&&(define(function(a,b,c){c.exports=g}),v=!1),v&&(c.inherit=g)}(d)}),Qc=Pc&&"object"==typeof Pc&&"default"in Pc?Pc["default"]:Pc,Rc=c(function(a){a.exports=Qc}),Sc=Rc&&"object"==typeof Rc&&"default"in Rc?Rc["default"]:Rc,Tc=Sc(b.TypedMessage,{__constructor:function(a){this.__base(),this.payload=a,this.setTransient(!0)}});b.messageField("payload")(Tc);var Uc,Vc,Wc,Xc,Yc,Zc,$c,_c,ad,bd,cd=(Uc=b.messageType(-102),Uc(Vc=function(a){function b(){return Pb(this,b),rc(this,a.apply(this,arguments))}return Dc(b,a),b}(Tc))||Vc),dd=(Wc=b.messageType(-103),Wc(Xc=function(a){function b(){return Pb(this,b),rc(this,a.apply(this,arguments))}return Dc(b,a),b}(Tc))||Xc),ed=(Yc=b.messageType(-104),Yc(Zc=function(a){function b(){return Pb(this,b),rc(this,a.apply(this,arguments))}return Dc(b,a),b}(Tc))||Zc),fd=($c=b.messageType(-105),$c(_c=function(a){function b(){return Pb(this,b),rc(this,a.apply(this,arguments))}return Dc(b,a),b}(Tc))||_c),gd=function(a){function b(c,d){Pb(this,b);var e=rc(this,a.call(this));e._setConversation(c),e._peerConnection=e._createPeerConnection(d),e._call=Oc(),e._promises={};var f=new Db(function(a){e._promises.resolveStreamReady=a}),g=new Db(function(a){e._promises.resolveAccept=a});return Db.all([f,g]).then(function(a){var b=db(a,1),c=b[0];e._call.can("connect")&&(e._call.connect(),e.emit("connect",c))}),e}return Dc(b,a),b.prototype.close=function(){var a=this;return Db.resolve().then(function(){a._call.close(),a._destroyPeerConnection(),a._peerConnection.close(),a._destroy()})},b.prototype._handleCloseEvent=function(){this._call.can("close")&&(this.close(),this.emit("close"))},b.prototype._setConversation=function(a){this._conversation&&this._conversation.off("message"),a&&(this._conversation=a,a.on("message",this._handleMessage.bind(this)))},b.prototype._destroy=function(){this._conversation.off("message")},b.prototype._createPeerConnection=function(a){var b=new RTCPeerConnection(a);return b.onicecandidate=this._handleICECandidateEvent.bind(this),b.onaddstream=this._handleAddStreamEvent.bind(this),b.onnremovestream=this._handleRemoveStreamEvent.bind(this),b.oniceconnectionstatechange=this._handleICEConnectionStateChangeEvent.bind(this),b.onsignalingstatechange=this._handleSignalingStateChangeEvent.bind(this),b},b.prototype._destroyPeerConnection=function(){var a=this._peerConnection;delete a.onaddstream,delete a.onremovestream,delete a.onnicecandidate,delete a.oniceconnectionstatechange,delete a.onsignalingstatechange},b.prototype._handleMessage=function(a){return a instanceof cd?this._handleAnswer(a):a instanceof ed?this._handleRefusal():a instanceof fd?this._handleCancelation():a instanceof dd&&this._handleICECandidate(a)},b.prototype._handleICECandidate=function(a){var b=new RTCIceCandidate(a.payload);this._peerConnection&&this._peerConnection.addIceCandidate(b)["catch"](console.error.bind(console))},b.prototype._handleICECandidateEvent=function(a){return!(!a.candidate||!this._conversation)&&this._conversation.send(new dd(a.candidate))["catch"](console.error.bind(console))},b.prototype._handleAddStreamEvent=function(a){this._promises.resolveStreamReady(a.stream)},b.prototype._handleRemoveStreamEvent=function(){this._handleCloseEvent()},b.prototype._handleICEConnectionStateChangeEvent=function(){switch(this._peerConnection.iceConnectionState){case"closed":case"failed":case"disconnected":this._handleCloseEvent()}},b.prototype._handleSignalingStateChangeEvent=function(){switch(this._peerConnection.signalingState){case"closed":this._handleCloseEvent()}},b.prototype._handleAnswer=function(){throw new Error("not implemented")},b.prototype._handleRefusal=function(){throw new Error("not implemented")},b.prototype._handleCancelation=function(){throw new Error("not implemented")},Lc(b,[{key:"state",get:function(){return this._call.current}}]),b}(Fc),hd=function(a){function b(c,d,e){Pb(this,b);var f=rc(this,a.call(this,d,e));return f.to=c,f}return Dc(b,a),b.prototype._handleAnswer=function(a){var b=new RTCSessionDescription(a.payload);this._peerConnection.setRemoteDescription(b),this._promises.resolveAccept()},b.prototype._handleRefusal=function(){this._destroyPeerConnection(),this._call.refuse(),this.emit("refuse"),this._destroy()},b.prototype.cancel=function(){var a=this;return this._call.cancel(),this._conversation.send(new fd).then(function(){return a._destroy()})},b.prototype.close=function(){return this._call.can("cancel")?this.cancel():a.prototype.close.call(this)},b}(gd),id=function(a){function b(c,d,e){Pb(this,b);var f=rc(this,a.call(this,d,e));f.from=c.from;var g=new RTCSessionDescription(c.payload);return f._handleOfferPromise=f._peerConnection.setRemoteDescription(g),f}return Dc(b,a),b.prototype.accept=function(a){var b=this;if(!a)throw new TypeError("a MediaStream instance is required to accept a call");return this._handleOfferPromise.then(function(){return b._peerConnection.addStream(a)}).then(function(){return b._peerConnection.createAnswer()}).then(function(a){return b._peerConnection.setLocalDescription(a)}).then(function(){return b._conversation.send(new cd(b._peerConnection.localDescription))}).then(function(){return b._promises.resolveAccept()})},b.prototype.refuse=function(){var a=this;return this._conversation.send(new ed).then(function(){a._call.refuse(),a._destroy()})},b.prototype._handleCancelation=function(){this._call.cancel(),this.emit("cancel"),this._destroy()},b}(gd),jd=(ad=b.messageType(-101),ad(bd=function(a){function b(){return Pb(this,b),rc(this,a.apply(this,arguments))}return Dc(b,a),b}(Tc))||bd),kd={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302","stun:stun.ekiga.net","stun:stun.ideasip.com","stun:stun.rixtelecom.se","stun:stun.schlund.de","stun:stun.stunprotocol.org:3478","stun:stun.voiparound.com","stun:stun.voipbuster.com","stun:stun.voipstunt.com","stun:stun.voxgratia.org"]}]},ld=function(a){function b(c,d){if(Pb(this,b),"string"!=typeof c)throw new TypeError("id is not a string");var e=rc(this,a.call(this));return e.id=c,e.options=Nb({RTCConfiguration:kd},d),e}return Dc(b,a),b.prototype._open=function(a,b){var c=this;return a.createIMClient(this.id,b,"webrtc").then(function(a){return c._imClient=a,a.on("message",function(a,b){return a instanceof jd&&c._handleOffer(a,b)}),a.on("conflict",function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return c.emit.apply(c,["conflict"].concat(b))}),c})},b.prototype.close=function(){return this._imClient.close()},b.prototype.call=function(a,b){var c=this;if("string"!=typeof a)throw new TypeError("target id is not a string");if(!b)throw new TypeError("a MediaStream instance is required to make a call");return this._imClient.ping([a]).then(function(d){if(!d.length)throw new Error(a+" is not online");var e=new hd(a,null,c.options.RTCConfiguration),f=new Db(function(a){e._peerConnection.onnegotiationneeded=a});return e._peerConnection.addStream(b),f.then(function(){return Db.all([c._imClient.createConversation({members:[a],unique:!0}),e._peerConnection.createOffer().then(function(a){e._peerConnection.setLocalDescription(a)})])}).then(function(a){var b=db(a,1),c=b[0];return e._setConversation(c),c.send(new jd(e._peerConnection.localDescription))}).then(function(){return e})})},b.prototype._handleOffer=function(a,b){var c=new id(a,b,this.options.RTCConfiguration);this.emit("call",c)},b}(Fc),md="leancloud-realtime-plugin-webrtc",nd=[jd,cd,dd,ed,fd],od=function(a){a.createWebRTCClient=function(b,c){return new ld(b)._open(a,c)}},pd={name:md,messageClasses:nd,onRealtimeCreate:od};a.WebRTCPlugin=pd,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=webrtc.min.js.map