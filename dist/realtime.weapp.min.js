!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define("leancloud-realtime",["exports"],b):b(a.AV=a.AV||{})}(this,function(a){"use strict";function b(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function c(a){return a&&a.__esModule?a.default:a}function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}function e(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=Nb(b),this.reject=Nb(c)}function f(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function g(a,b){for(var c=a[ag][b];null!=c;){if(c.kind===bg)return c.listener;c=c.next}return null}function h(a,b,c){"function"!=typeof c&&"object"!=typeof c&&(c=null);for(var d=null,e=a[ag][b];null!=e;)e.kind===bg?null==d?a[ag][b]=e.next:d.next=e.next:d=e,e=e.next;null!=c&&(null==d?a[ag][b]=cg(c,bg):d.next=cg(c,bg))}function i(a){this.status=a.statusCode,this.statusText=a.statusCode;var b=a.data;"string"!=typeof b&&(b=Wf(b)),this.responseText=this.response=b,this.readyState=rg,this.dispatchEvent({type:"readystatechange"})}function j(a){""!==a.message&&Bg&&(Bg._readyState=zg,Bg.dispatchEvent({type:"error",message:a.errMsg}))}function k(a){if(a=String(a),!(a.length>100)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*di;case"days":case"day":case"d":return c*ci;case"hours":case"hour":case"hrs":case"hr":case"h":return c*bi;case"minutes":case"minute":case"mins":case"min":case"m":return c*ai;case"seconds":case"second":case"secs":case"sec":case"s":return c*_h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function l(a){return a>=ci?Math.round(a/ci)+"d":a>=bi?Math.round(a/bi)+"h":a>=ai?Math.round(a/ai)+"m":a>=_h?Math.round(a/_h)+"s":a+"ms"}function m(a){return n(a,ci,"day")||n(a,bi,"hour")||n(a,ai,"minute")||n(a,_h,"second")||a+" ms"}function n(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}function o(a){return!!a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)}function p(a){return"function"==typeof a.readFloatLE&&"function"==typeof a.slice&&o(a.slice(0,0))}function q(a){return"[object Array]"===ji.call(a)}function r(a){return"[object ArrayBuffer]"===ji.call(a)}function s(a){return"undefined"!=typeof FormData&&a instanceof FormData}function t(a){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(a):a&&a.buffer&&a.buffer instanceof ArrayBuffer}function u(a){return"string"==typeof a}function v(a){return"number"==typeof a}function w(a){return void 0===a}function x(a){return null!==a&&"object"===(void 0===a?"undefined":xf(a))}function y(a){return"[object Date]"===ji.call(a)}function z(a){return"[object File]"===ji.call(a)}function A(a){return"[object Blob]"===ji.call(a)}function B(a){return"[object Function]"===ji.call(a)}function C(a){return x(a)&&B(a.pipe)}function D(a){return"undefined"!=typeof URLSearchParams&&a instanceof URLSearchParams}function E(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")}function F(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function G(a,b){if(null!==a&&void 0!==a)if("object"===(void 0===a?"undefined":xf(a))||q(a)||(a=[a]),q(a))for(var c=0,d=a.length;c<d;c++)b.call(null,a[c],c,a);else for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&b.call(null,a[e],e,a)}function H(){function a(a,c){"object"===xf(b[c])&&"object"===(void 0===a?"undefined":xf(a))?b[c]=H(b[c],a):b[c]=a}for(var b={},c=0,d=arguments.length;c<d;c++)G(arguments[c],a);return b}function I(a,b,c){return G(b,function(b,d){a[d]=c&&"function"==typeof b?hi(b,c):b}),a}function J(a){return encodeURIComponent(a).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function K(){this.message="String contains an invalid character"}function L(a){for(var b,c,d=String(a),e="",f=0,g=si;d.charAt(0|f)||(g="=",f%1);e+=g.charAt(63&b>>8-f%1*8)){if((c=d.charCodeAt(f+=.75))>255)throw new K;b=b<<8|c}return e}function M(a,b){!ki.isUndefined(a)&&ki.isUndefined(a["Content-Type"])&&(a["Content-Type"]=b)}function N(){this.handlers=[]}function O(a){a.cancelToken&&a.cancelToken.throwIfRequested()}function P(a){this.defaults=a,this.interceptors={request:new Ai,response:new Ai}}function Q(a){this.message=a}function R(a){if("function"!=typeof a)throw new TypeError("executor must be a function.");var b;this.promise=new pe(function(a){b=a});var c=this;a(function(a){c.reason||(c.reason=new Hi(a),b(c.reason))})}function S(a){var b=new Gi(a),c=hi(Gi.prototype.request,b);return ki.extend(c,Gi.prototype,b),ki.extend(c,b),c}function T(a){var b=pj.call(a,rj),c=a[rj];try{a[rj]=void 0;var d=!0}catch(a){}var e=qj.call(a);return d&&(b?a[rj]=c:delete a[rj]),e}function U(a){return uj.call(a)}function V(a){return null==a?void 0===a?xj:wj:yj&&yj in Object(a)?sj(a):vj(a)}function W(a,b){return function(c){return a(b(c))}}function X(a){return null!=a&&"object"==typeof a}function Y(a){if(!Dj(a)||zj(a)!=Ej)return!1;var b=Cj(a);if(null===b)return!0;var c=Ij.call(b,"constructor")&&b.constructor;return"function"==typeof c&&c instanceof c&&Hj.call(c)==Jj}function Z(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}function $(a,b){var c=b||0,d=Gk;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}function _(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"==a?new Array(16):null,a=null),a=a||{};var e=a.random||(a.rng||Fk)();if(e[6]=15&e[6]|64,e[8]=63&e[8]|128,b)for(var f=0;f<16;++f)b[d+f]=e[f];return b||Ik(e)}function aa(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||_k)}function ba(a){if(!al(a))return cl(a);var b=[];for(var c in Object(a))el.call(a,c)&&"constructor"!=c&&b.push(c);return b}function ca(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function da(a){if(!gl(a))return!1;var b=zj(a);return b==il||b==jl||b==hl||b==kl}function ea(a){return!!ol&&ol in a}function fa(a){if(null!=a){try{return rl.call(a)}catch(a){}try{return a+""}catch(a){}}return""}function ga(a){return!(!gl(a)||pl(a))&&(ll(a)?zl:ul).test(sl(a))}function ha(a,b){return null==a?void 0:a[b]}function ia(a,b){var c=Bl(a,b);return Al(c)?c:void 0}function ja(a){return Dj(a)&&zj(a)==Ul}function ka(a){return"number"==typeof a&&a>-1&&a%1==0&&a<=bm}function la(a){return null!=a&&cm(a.length)&&!ll(a)}function ma(){return!1}function na(a){return Dj(a)&&cm(a.length)&&!!gm[zj(a)]}function oa(a){return function(b){return a(b)}}function pa(a){if(null==a)return!0;if(dm(a)&&(am(a)||"string"==typeof a||"function"==typeof a.splice||fm(a)||mm(a)||$l(a)))return!a.length;var b=Tl(a);if(b==nm||b==om)return!a.size;if(al(a))return!fl(a).length;for(var c in a)if(qm.call(a,c))return!1;return!0}function qa(){this.__data__=[],this.size=0}function ra(a,b){return a===b||a!==a&&b!==b}function sa(a,b){for(var c=a.length;c--;)if(tm(a[c][0],b))return c;return-1}function ta(a){var b=this.__data__,c=um(b,a);return!(c<0)&&(c==b.length-1?b.pop():wm.call(b,c,1),--this.size,!0)}function ua(a){var b=this.__data__,c=um(b,a);return c<0?void 0:b[c][1]}function va(a){return um(this.__data__,a)>-1}function wa(a,b){var c=this.__data__,d=um(c,a);return d<0?(++this.size,c.push([a,b])):c[d][1]=b,this}function xa(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function ya(){this.__data__=new Bm,this.size=0}function za(a){var b=this.__data__,c=b.delete(a);return this.size=b.size,c}function Aa(a){return this.__data__.get(a)}function Ba(a){return this.__data__.has(a)}function Ca(){this.__data__=Hm?Hm(null):{},this.size=0}function Da(a){var b=this.has(a)&&delete this.__data__[a];return this.size-=b?1:0,b}function Ea(a){var b=this.__data__;if(Hm){var c=b[a];return c===Km?void 0:c}return Mm.call(b,a)?b[a]:void 0}function Fa(a){var b=this.__data__;return Hm?void 0!==b[a]:Pm.call(b,a)}function Ga(a,b){var c=this.__data__;return this.size+=this.has(a)?0:1,c[a]=Hm&&void 0===b?Rm:b,this}function Ha(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Ia(){this.size=0,this.__data__={hash:new Tm,map:new(Gl||Bm),string:new Tm}}function Ja(a){var b=typeof a;return"string"==b||"number"==b||"symbol"==b||"boolean"==b?"__proto__"!==a:null===a}function Ka(a,b){var c=a.__data__;return Vm(b)?c["string"==typeof b?"string":"hash"]:c.map}function La(a){var b=Wm(this,a).delete(a);return this.size-=b?1:0,b}function Ma(a){return Wm(this,a).get(a)}function Na(a){return Wm(this,a).has(a)}function Oa(a,b){var c=Wm(this,a),d=c.size;return c.set(a,b),this.size+=c.size==d?0:1,this}function Pa(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Qa(a,b){var c=this.__data__;if(c instanceof Bm){var d=c.__data__;if(!Gl||d.length<an-1)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new _m(d)}return c.set(a,b),this.size=c.size,this}function Ra(a){var b=this.__data__=new Bm(a);this.size=b.size}function Sa(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&!1!==b(a[c],c,a););return a}function Ta(a,b,c){"__proto__"==b&&fn?fn(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function Ua(a,b,c){var d=a[b];jn.call(a,b)&&tm(d,c)&&(void 0!==c||b in a)||gn(a,b,c)}function Va(a,b,c,d){var e=!c;c||(c={});for(var f=-1,g=b.length;++f<g;){var h=b[f],i=d?d(c[h],a[h],h,c,a):void 0;void 0===i&&(i=a[h]),e?gn(c,h,i):kn(c,h,i)}return c}function Wa(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function Xa(a,b){return!!(b=null==b?nn:b)&&("number"==typeof a||on.test(a))&&a>-1&&a%1==0&&a<b}function Ya(a,b){var c=am(a),d=!c&&$l(a),e=!c&&!d&&fm(a),f=!c&&!d&&!e&&mm(a),g=c||d||e||f,h=g?mn(a.length,String):[],i=h.length;for(var j in a)!b&&!rn.call(a,j)||g&&("length"==j||e&&("offset"==j||"parent"==j)||f&&("buffer"==j||"byteLength"==j||"byteOffset"==j)||pn(j,i))||h.push(j);return h}function Za(a){return dm(a)?sn(a):fl(a)}function $a(a,b){return a&&ln(b,tn(b),a)}function _a(a){var b=[];if(null!=a)for(var c in Object(a))b.push(c);return b}function ab(a){if(!gl(a))return vn(a);var b=al(a),c=[];for(var d in a)("constructor"!=d||!b&&xn.call(a,d))&&c.push(d);return c}function bb(a){return dm(a)?sn(a,!0):yn(a)}function cb(a,b){return a&&ln(b,zn(b),a)}function db(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function eb(a,b){for(var c=-1,d=null==a?0:a.length,e=0,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[e++]=g)}return f}function fb(){return[]}function gb(a,b){return ln(a,Jn(a),b)}function hb(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function ib(a,b){return ln(a,On(a),b)}function jb(a,b,c){var d=b(a);return am(a)?d:Ln(d,c(a))}function kb(a){return Qn(a,tn,Jn)}function lb(a){return Qn(a,zn,On)}function mb(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&Un.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function nb(a){var b=new a.constructor(a.byteLength);return new Xn(b).set(new Xn(a)),b}function ob(a,b){var c=b?Yn(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.byteLength)}function pb(a,b){return a.set(b[0],b[1]),a}function qb(a,b,c,d){var e=-1,f=null==a?0:a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function rb(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function sb(a,b,c){var d=b?c(ao(a),bo):ao(a);return _n(d,$n,new a.constructor)}function tb(a){var b=new a.constructor(a.source,eo.exec(a));return b.lastIndex=a.lastIndex,b}function ub(a,b){return a.add(b),a}function vb(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function wb(a,b,c){var d=b?c(ho(a),io):ho(a);return _n(d,go,new a.constructor)}function xb(a){return lo?Object(lo.call(a)):{}}function yb(a,b){var c=b?Yn(a.buffer):a.buffer;return new a.constructor(c,a.byteOffset,a.length)}function zb(a,b,c,d){var e=a.constructor;switch(b){case wo:return Yn(a);case oo:case po:return new e(+a);case xo:return Zn(a,d);case yo:case zo:case Ao:case Bo:case Co:case Do:case Eo:case Fo:case Go:return no(a,d);case qo:return co(a,d,c);case ro:case uo:return new e(a);case so:return fo(a);case to:return jo(a,d,c);case vo:return mo(a)}}function Ab(a){return"function"!=typeof a.constructor||al(a)?{}:Ko(Cj(a))}function Bb(a,b,c,d,e,f){var g,h=b&Mo,i=b&No,j=b&Oo;if(c&&(g=e?c(a,d,e,f):c(a)),void 0!==g)return g;if(!gl(a))return a;var k=am(a);if(k){if(g=Vn(a),!h)return Cn(a,g)}else{var l=Tl(a),m=l==Qo||l==Ro;if(fm(a))return Bn(a,h);if(l==So||l==Po||m&&!e){if(g=i||m?{}:Lo(a),!h)return i?Pn(a,An(g,a)):Kn(a,un(g,a))}else{if(!To[l])return e?a:{};g=Ho(a,l,Bb,h)}}f||(f=new cn);var n=f.get(a);if(n)return n;f.set(a,g);var o=j?i?Sn:Rn:i?keysIn:tn,p=k?void 0:o(a);return dn(p||a,function(d,e){p&&(e=d,d=a[e]),kn(g,e,Bb(d,b,c,e,a,f))}),g}function Cb(a){return Vo(a,Wo|Xo)}function Db(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},b=a.signature,c=a.timestamp,d=a.nonce;if("string"!=typeof b||"number"!=typeof c||"string"!=typeof d)throw new Error("malformed signature");return{signature:b,timestamp:c,nonce:d}}function Eb(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}var Fb=window&&window.process||{};Fb.env=Fb.env||{};var Gb="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Hb=Math.ceil,Ib=Math.floor,Jb=function(a){return isNaN(a=+a)?0:(a>0?Ib:Hb)(a)},Kb=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},Lb=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),Mb=d(function(a){var b=a.exports={version:"2.5.1"};"number"==typeof __e&&(__e=b)}),Nb=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},Ob=function(a,b,c){if(Nb(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},Pb=function(a){return"object"==typeof a?null!==a:"function"==typeof a},Qb=function(a){if(!Pb(a))throw TypeError(a+" is not an object!");return a},Rb=function(a){try{return!!a()}catch(a){return!0}},Sb=!Rb(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),Tb=Lb.document,Ub=Pb(Tb)&&Pb(Tb.createElement),Vb=function(a){return Ub?Tb.createElement(a):{}},Wb=!Sb&&!Rb(function(){return 7!=Object.defineProperty(Vb("div"),"a",{get:function(){return 7}}).a}),Xb=function(a,b){if(!Pb(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!Pb(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!Pb(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!Pb(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},Yb=Object.defineProperty,Zb=Sb?Object.defineProperty:function(a,b,c){if(Qb(a),b=Xb(b,!0),Qb(c),Wb)try{return Yb(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},$b={f:Zb},_b=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},ac=Sb?function(a,b,c){return $b.f(a,b,_b(1,c))}:function(a,b,c){return a[b]=c,a},bc=function(a,b,c){var d,e,f,g=a&bc.F,h=a&bc.G,i=a&bc.S,j=a&bc.P,k=a&bc.B,l=a&bc.W,m=h?Mb:Mb[b]||(Mb[b]={}),n=m.prototype,o=h?Lb:i?Lb[b]:(Lb[b]||{}).prototype;h&&(c=b);for(d in c)(e=!g&&o&&void 0!==o[d])&&d in m||(f=e?o[d]:c[d],m[d]=h&&"function"!=typeof o[d]?c[d]:k&&e?Ob(f,Lb):l&&o[d]==f?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(f):j&&"function"==typeof f?Ob(Function.call,f):f,j&&((m.virtual||(m.virtual={}))[d]=f,a&bc.R&&n&&!n[d]&&ac(n,d,f)))};bc.F=1,bc.G=2,bc.S=4,bc.P=8,bc.B=16,bc.W=32,bc.U=64,bc.R=128;var cc=bc,dc=ac,ec={}.hasOwnProperty,fc=function(a,b){return ec.call(a,b)},gc={},hc={}.toString,ic=function(a){return hc.call(a).slice(8,-1)},jc=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==ic(a)?a.split(""):Object(a)},kc=function(a){return jc(Kb(a))},lc=Math.min,mc=function(a){return a>0?lc(Jb(a),9007199254740991):0},nc=Math.max,oc=Math.min,pc=function(a,b){return a=Jb(a),a<0?nc(a+b,0):oc(a,b)},qc=Lb["__core-js_shared__"]||(Lb["__core-js_shared__"]={}),rc=function(a){return qc[a]||(qc[a]={})},sc=0,tc=Math.random(),uc=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++sc+tc).toString(36))},vc=rc("keys"),wc=function(a){return vc[a]||(vc[a]=uc(a))},xc=function(a){return function(b,c,d){var e,f=kc(b),g=mc(f.length),h=pc(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),yc=wc("IE_PROTO"),zc=function(a,b){var c,d=kc(a),e=0,f=[];for(c in d)c!=yc&&fc(d,c)&&f.push(c);for(;b.length>e;)fc(d,c=b[e++])&&(~xc(f,c)||f.push(c));return f},Ac="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Bc=Object.keys||function(a){return zc(a,Ac)},Cc=Sb?Object.defineProperties:function(a,b){Qb(a);for(var c,d=Bc(b),e=d.length,f=0;e>f;)$b.f(a,c=d[f++],b[c]);return a},Dc=Lb.document,Ec=Dc&&Dc.documentElement,Fc=wc("IE_PROTO"),Gc=function(){},Hc=function(){var a,b=Vb("iframe"),c=Ac.length;for(b.style.display="none",Ec.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),Hc=a.F;c--;)delete Hc.prototype[Ac[c]];return Hc()},Ic=Object.create||function(a,b){var c;return null!==a?(Gc.prototype=Qb(a),c=new Gc,Gc.prototype=null,c[Fc]=a):c=Hc(),void 0===b?c:Cc(c,b)},Jc=d(function(a){var b=rc("wks"),c=Lb.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:uc)("Symbol."+a))}).store=b}),Kc=$b.f,Lc=Jc("toStringTag"),Mc=function(a,b,c){a&&!fc(a=c?a:a.prototype,Lc)&&Kc(a,Lc,{configurable:!0,value:b})},Nc={};ac(Nc,Jc("iterator"),function(){return this});var Oc=function(a,b,c){a.prototype=Ic(Nc,{next:_b(1,c)}),Mc(a,b+" Iterator")},Pc=function(a){return Object(Kb(a))},Qc=wc("IE_PROTO"),Rc=Object.prototype,Sc=Object.getPrototypeOf||function(a){return a=Pc(a),fc(a,Qc)?a[Qc]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?Rc:null},Tc=Jc("iterator"),Uc=!([].keys&&"next"in[].keys()),Vc=function(){return this},Wc=function(a,b,c,d,e,f,g){Oc(c,b,d);var h,i,j,k=function(a){if(!Uc&&a in o)return o[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},l=b+" Iterator",m="values"==e,n=!1,o=a.prototype,p=o[Tc]||o["@@iterator"]||e&&o[e],q=p||k(e),r=e?m?k("entries"):q:void 0,s="Array"==b?o.entries||p:p;if(s&&(j=Sc(s.call(new a)))!==Object.prototype&&j.next&&Mc(j,l,!0),m&&p&&"values"!==p.name&&(n=!0,q=function(){return p.call(this)}),g&&(Uc||n||!o[Tc])&&ac(o,Tc,q),gc[b]=q,gc[l]=Vc,e)if(h={values:m?q:k("values"),keys:f?q:k("keys"),entries:r},g)for(i in h)i in o||dc(o,i,h[i]);else cc(cc.P+cc.F*(Uc||n),b,h);return h},Xc=function(a){return function(b,c){var d,e,f=String(Kb(b)),g=Jb(c),h=f.length;return g<0||g>=h?a?"":void 0:(d=f.charCodeAt(g),d<55296||d>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):d:a?f.slice(g,g+2):e-56320+(d-55296<<10)+65536)}}(!0);Wc(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=Xc(b,c),this._i+=a.length,{value:a,done:!1})});var Yc=function(a,b){return{value:b,done:!!a}};Wc(Array,"Array",function(a,b){this._t=kc(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,Yc(1)):"keys"==b?Yc(0,c):"values"==b?Yc(0,a[c]):Yc(0,[c,a[c]])},"values");gc.Arguments=gc.Array;for(var Zc=Jc("toStringTag"),$c="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),_c=0;_c<$c.length;_c++){var ad=$c[_c],bd=Lb[ad],cd=bd&&bd.prototype;cd&&!cd[Zc]&&ac(cd,Zc,ad),gc[ad]=gc.Array}var dd,ed,fd,gd=Jc("toStringTag"),hd="Arguments"==ic(function(){return arguments}()),id=function(a,b){try{return a[b]}catch(a){}},jd=function(a){var b,c,d;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=id(b=Object(a),gd))?c:hd?ic(b):"Object"==(d=ic(b))&&"function"==typeof b.callee?"Arguments":d},kd=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a},ld=function(a,b,c,d){try{return d?b(Qb(c)[0],c[1]):b(c)}catch(b){var e=a.return;throw void 0!==e&&Qb(e.call(a)),b}},md=Jc("iterator"),nd=Array.prototype,od=function(a){return void 0!==a&&(gc.Array===a||nd[md]===a)},pd=Jc("iterator"),qd=Mb.getIteratorMethod=function(a){if(void 0!=a)return a[pd]||a["@@iterator"]||gc[jd(a)]},rd=d(function(a){var b={},c={},d=a.exports=function(a,d,e,f,g){var h,i,j,k,l=g?function(){return a}:qd(a),m=Ob(e,f,d?2:1),n=0;if("function"!=typeof l)throw TypeError(a+" is not iterable!");if(od(l)){for(h=mc(a.length);h>n;n++)if((k=d?m(Qb(i=a[n])[0],i[1]):m(a[n]))===b||k===c)return k}else for(j=l.call(a);!(i=j.next()).done;)if((k=ld(j,m,i.value,d))===b||k===c)return k};d.BREAK=b,d.RETURN=c}),sd=Jc("species"),td=function(a,b){var c,d=Qb(a).constructor;return void 0===d||void 0==(c=Qb(d)[sd])?b:Nb(c)},ud=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)},vd=Lb.process,wd=Lb.setImmediate,xd=Lb.clearImmediate,yd=Lb.MessageChannel,zd=Lb.Dispatch,Ad=0,Bd={},Cd=function(){var a=+this;if(Bd.hasOwnProperty(a)){var b=Bd[a];delete Bd[a],b()}},Dd=function(a){Cd.call(a.data)};wd&&xd||(wd=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return Bd[++Ad]=function(){ud("function"==typeof a?a:Function(a),b)},dd(Ad),Ad},xd=function(a){delete Bd[a]},"process"==ic(vd)?dd=function(a){vd.nextTick(Ob(Cd,a,1))}:zd&&zd.now?dd=function(a){zd.now(Ob(Cd,a,1))}:yd?(ed=new yd,fd=ed.port2,ed.port1.onmessage=Dd,dd=Ob(fd.postMessage,fd,1)):Lb.addEventListener&&"function"==typeof postMessage&&!Lb.importScripts?(dd=function(a){Lb.postMessage(a+"","*")},Lb.addEventListener("message",Dd,!1)):dd="onreadystatechange"in Vb("script")?function(a){Ec.appendChild(Vb("script")).onreadystatechange=function(){Ec.removeChild(this),Cd.call(a)}}:function(a){setTimeout(Ob(Cd,a,1),0)});var Ed={set:wd,clear:xd},Fd=Ed.set,Gd=Lb.MutationObserver||Lb.WebKitMutationObserver,Hd=Lb.process,Id=Lb.Promise,Jd="process"==ic(Hd),Kd=function(a){return new e(a)},Ld={f:Kd},Md=function(a){try{return{e:!1,v:a()}}catch(a){return{e:!0,v:a}}},Nd=function(a,b){if(Qb(a),Pb(b)&&b.constructor===a)return b;var c=Ld.f(a);return(0,c.resolve)(b),c.promise},Od=function(a,b,c){for(var d in b)c&&a[d]?a[d]=b[d]:ac(a,d,b[d]);return a},Pd=Jc("species"),Qd=function(a){var b="function"==typeof Mb[a]?Mb[a]:Lb[a];Sb&&b&&!b[Pd]&&$b.f(b,Pd,{configurable:!0,get:function(){return this}})},Rd=Jc("iterator"),Sd=!1;try{var Td=[7][Rd]();Td.return=function(){Sd=!0},Array.from(Td,function(){throw 2})}catch(a){}var Ud,Vd,Wd,Xd,Yd=function(a,b){if(!b&&!Sd)return!1;var c=!1;try{var d=[7],e=d[Rd]();e.next=function(){return{done:c=!0}},d[Rd]=function(){return e},a(d)}catch(a){}return c},Zd=Ed.set,$d=function(){var a,b,c,d=function(){var d,e;for(Jd&&(d=Hd.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(d){throw a?c():b=void 0,d}}b=void 0,d&&d.enter()};if(Jd)c=function(){Hd.nextTick(d)};else if(Gd){var e=!0,f=document.createTextNode("");new Gd(d).observe(f,{characterData:!0}),c=function(){f.data=e=!e}}else if(Id&&Id.resolve){var g=Id.resolve();c=function(){g.then(d)}}else c=function(){Fd.call(Lb,d)};return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}}(),_d=Lb.TypeError,ae=Lb.process,be=Lb.Promise,ce="process"==jd(ae),de=function(){},ee=Vd=Ld.f,fe=!!function(){try{var a=be.resolve(1),b=(a.constructor={})[Jc("species")]=function(a){a(de,de)};return(ce||"function"==typeof PromiseRejectionEvent)&&a.then(de)instanceof b}catch(a){}}(),ge=function(a){var b;return!(!Pb(a)||"function"!=typeof(b=a.then))&&b},he=function(a,b){if(!a._n){a._n=!0;var c=a._c;$d(function(){for(var d=a._v,e=1==a._s,f=0;c.length>f;)!function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(e||(2==a._h&&ke(a),a._h=1),!0===g?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(_d("Promise-chain cycle")):(f=ge(c))?f.call(c,h,i):h(c)):i(d)}catch(a){i(a)}}(c[f++]);a._c=[],a._n=!1,b&&!a._h&&ie(a)})}},ie=function(a){Zd.call(Lb,function(){var b,c,d,e=a._v,f=je(a);if(f&&(b=Md(function(){ce?ae.emit("unhandledRejection",e,a):(c=Lb.onunhandledrejection)?c({promise:a,reason:e}):(d=Lb.console)&&d.error&&d.error("Unhandled promise rejection",e)}),a._h=ce||je(a)?2:1),a._a=void 0,f&&b.e)throw b.v})},je=function(a){if(1==a._h)return!1;for(var b,c=a._a||a._c,d=0;c.length>d;)if(b=c[d++],b.fail||!je(b.promise))return!1;return!0},ke=function(a){Zd.call(Lb,function(){var b;ce?ae.emit("rejectionHandled",a):(b=Lb.onrejectionhandled)&&b({promise:a,reason:a._v})})},le=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),he(b,!0))},me=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw _d("Promise can't be resolved itself");(b=ge(a))?$d(function(){var d={_w:c,_d:!1};try{b.call(a,Ob(me,d,1),Ob(le,d,1))}catch(a){le.call(d,a)}}):(c._v=a,c._s=1,he(c,!1))}catch(a){le.call({_w:c,_d:!1},a)}}};fe||(be=function(a){kd(this,be,"Promise","_h"),Nb(a),Ud.call(this);try{a(Ob(me,this,1),Ob(le,this,1))}catch(a){le.call(this,a)}},Ud=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Ud.prototype=Od(be.prototype,{then:function(a,b){var c=ee(td(this,be));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=ce?ae.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&he(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),Wd=function(){var a=new Ud;this.promise=a,this.resolve=Ob(me,a,1),this.reject=Ob(le,a,1)},Ld.f=ee=function(a){return a===be||a===Xd?new Wd(a):Vd(a)}),cc(cc.G+cc.W+cc.F*!fe,{Promise:be}),Mc(be,"Promise"),Qd("Promise"),Xd=Mb.Promise,cc(cc.S+cc.F*!fe,"Promise",{reject:function(a){var b=ee(this);return(0,b.reject)(a),b.promise}}),cc(cc.S+!0*cc.F,"Promise",{resolve:function(a){return Nd(this===Xd?be:this,a)}}),cc(cc.S+cc.F*!(fe&&Yd(function(a){be.all(a).catch(de)})),"Promise",{all:function(a){var b=this,c=ee(b),d=c.resolve,e=c.reject,f=Md(function(){var c=[],f=0,g=1;rd(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f.e&&e(f.v),c.promise},race:function(a){var b=this,c=ee(b),d=c.reject,e=Md(function(){rd(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}}),cc(cc.P+cc.R,"Promise",{finally:function(a){var b=td(this,Mb.Promise||Lb.Promise),c="function"==typeof a;return this.then(c?function(c){return Nd(b,a()).then(function(){return c})}:a,c?function(c){return Nd(b,a()).then(function(){throw c})}:a)}}),cc(cc.S,"Promise",{try:function(a){var b=Ld.f(this),c=Md(a);return(c.e?b.reject:b.resolve)(c.v),b.promise}});var ne=Mb.Promise,oe=d(function(a){a.exports={default:ne,__esModule:!0}}),pe=c(oe),qe=Jc,re={f:qe},se=re.f("iterator"),te=d(function(a){a.exports={default:se,__esModule:!0}}),ue=d(function(a){var b=uc("meta"),c=$b.f,d=0,e=Object.isExtensible||function(){return!0},f=!Rb(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!Pb(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!fc(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},i=function(a,c){if(!fc(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},j=function(a){return f&&k.NEED&&e(a)&&!fc(a,b)&&g(a),a},k=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:i,onFreeze:j}}),ve=$b.f,we=function(a){var b=Mb.Symbol||(Mb.Symbol={});"_"==a.charAt(0)||a in b||ve(b,a,{value:re.f(a)})},xe=Object.getOwnPropertySymbols,ye={f:xe},ze={}.propertyIsEnumerable,Ae={f:ze},Be=function(a){var b=Bc(a),c=ye.f;if(c)for(var d,e=c(a),f=Ae.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},Ce=Array.isArray||function(a){return"Array"==ic(a)},De=Ac.concat("length","prototype"),Ee=Object.getOwnPropertyNames||function(a){return zc(a,De)},Fe={f:Ee},Ge=Fe.f,He={}.toString,Ie="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Je=function(a){try{return Ge(a)}catch(a){return Ie.slice()}},Ke=function(a){return Ie&&"[object Window]"==He.call(a)?Je(a):Ge(kc(a))},Le={f:Ke},Me=Object.getOwnPropertyDescriptor,Ne=Sb?Me:function(a,b){if(a=kc(a),b=Xb(b,!0),Wb)try{return Me(a,b)}catch(a){}if(fc(a,b))return _b(!Ae.f.call(a,b),a[b])},Oe={f:Ne},Pe=ue.KEY,Qe=Oe.f,Re=$b.f,Se=Le.f,Te=Lb.Symbol,Ue=Lb.JSON,Ve=Ue&&Ue.stringify,We=Jc("_hidden"),Xe=Jc("toPrimitive"),Ye={}.propertyIsEnumerable,Ze=rc("symbol-registry"),$e=rc("symbols"),_e=rc("op-symbols"),af=Object.prototype,bf="function"==typeof Te,cf=Lb.QObject,df=!cf||!cf.prototype||!cf.prototype.findChild,ef=Sb&&Rb(function(){return 7!=Ic(Re({},"a",{get:function(){return Re(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=Qe(af,b);d&&delete af[b],Re(a,b,c),d&&a!==af&&Re(af,b,d)}:Re,ff=function(a){var b=$e[a]=Ic(Te.prototype);return b._k=a,b},gf=bf&&"symbol"==typeof Te.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof Te},hf=function(a,b,c){return a===af&&hf(_e,b,c),Qb(a),b=Xb(b,!0),Qb(c),fc($e,b)?(c.enumerable?(fc(a,We)&&a[We][b]&&(a[We][b]=!1),c=Ic(c,{enumerable:_b(0,!1)})):(fc(a,We)||Re(a,We,_b(1,{})),a[We][b]=!0),ef(a,b,c)):Re(a,b,c)},jf=function(a,b){Qb(a);for(var c,d=Be(b=kc(b)),e=0,f=d.length;f>e;)hf(a,c=d[e++],b[c]);return a},kf=function(a,b){return void 0===b?Ic(a):jf(Ic(a),b)},lf=function(a){var b=Ye.call(this,a=Xb(a,!0));return!(this===af&&fc($e,a)&&!fc(_e,a))&&(!(b||!fc(this,a)||!fc($e,a)||fc(this,We)&&this[We][a])||b)},mf=function(a,b){if(a=kc(a),b=Xb(b,!0),a!==af||!fc($e,b)||fc(_e,b)){var c=Qe(a,b);return!c||!fc($e,b)||fc(a,We)&&a[We][b]||(c.enumerable=!0),c}
},nf=function(a){for(var b,c=Se(kc(a)),d=[],e=0;c.length>e;)fc($e,b=c[e++])||b==We||b==Pe||d.push(b);return d},of=function(a){for(var b,c=a===af,d=Se(c?_e:kc(a)),e=[],f=0;d.length>f;)!fc($e,b=d[f++])||c&&!fc(af,b)||e.push($e[b]);return e};bf||(Te=function(){if(this instanceof Te)throw TypeError("Symbol is not a constructor!");var a=uc(arguments.length>0?arguments[0]:void 0),b=function(c){this===af&&b.call(_e,c),fc(this,We)&&fc(this[We],a)&&(this[We][a]=!1),ef(this,a,_b(1,c))};return Sb&&df&&ef(af,a,{configurable:!0,set:b}),ff(a)},dc(Te.prototype,"toString",function(){return this._k}),Oe.f=mf,$b.f=hf,Fe.f=Le.f=nf,Ae.f=lf,ye.f=of,re.f=function(a){return ff(Jc(a))}),cc(cc.G+cc.W+cc.F*!bf,{Symbol:Te});for(var pf="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),qf=0;pf.length>qf;)Jc(pf[qf++]);for(var rf=Bc(Jc.store),sf=0;rf.length>sf;)we(rf[sf++]);cc(cc.S+cc.F*!bf,"Symbol",{for:function(a){return fc(Ze,a+="")?Ze[a]:Ze[a]=Te(a)},keyFor:function(a){if(!gf(a))throw TypeError(a+" is not a symbol!");for(var b in Ze)if(Ze[b]===a)return b},useSetter:function(){df=!0},useSimple:function(){df=!1}}),cc(cc.S+cc.F*!bf,"Object",{create:kf,defineProperty:hf,defineProperties:jf,getOwnPropertyDescriptor:mf,getOwnPropertyNames:nf,getOwnPropertySymbols:of}),Ue&&cc(cc.S+cc.F*(!bf||Rb(function(){var a=Te();return"[null]"!=Ve([a])||"{}"!=Ve({a:a})||"{}"!=Ve(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!gf(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&Ce(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!gf(b))return b}),d[1]=b,Ve.apply(Ue,d)}}}),Te.prototype[Xe]||ac(Te.prototype,Xe,Te.prototype.valueOf),Mc(Te,"Symbol"),Mc(Math,"Math",!0),Mc(Lb.JSON,"JSON",!0),we("asyncIterator"),we("observable");var tf=Mb.Symbol,uf=d(function(a){a.exports={default:tf,__esModule:!0}}),vf=c(uf),wf=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(te),e=c(uf),f="function"==typeof e.default&&"symbol"==typeof d.default?function(a){return typeof a}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":typeof a};b.default="function"==typeof e.default&&"symbol"===f(d.default)?function(a){return void 0===a?"undefined":f(a)}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":void 0===a?"undefined":f(a)}}),xf=c(wf),yf=d(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),zf=c(yf),Af=function(){function a(){zf(this,a)}return a.prototype.getItem=function(a){return wx.getStorageSync(a)},a.prototype.setItem=function(a,b){return wx.setStorageSync(a,b)},a.prototype.removeItem=function(a){return this.setItem(a,"")},a.prototype.clear=function(){return wx.clearStorageSync()},a}(),Bf=new Af;cc(cc.S+cc.F*!Sb,"Object",{defineProperty:$b.f});var Cf=Mb.Object,Df=function(a,b,c){return Cf.defineProperty(a,b,c)},Ef=d(function(a){a.exports={default:Df,__esModule:!0}}),Ff=c(Ef),Gf=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(Ef);b.default=function(a,b,d){return b in a?(0,c.default)(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d,a}}),Hf=c(Gf),If=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(wf);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,c.default)(b))&&"function"!=typeof b?a:b}}),Jf=c(If),Kf=function(a,b){if(Qb(a),!Pb(b)&&null!==b)throw TypeError(b+": can't set as prototype!")},Lf={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=Ob(Function.call,Oe.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,d){return Kf(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):void 0),check:Kf};cc(cc.S,"Object",{setPrototypeOf:Lf.set});var Mf=Mb.Object.setPrototypeOf,Nf=d(function(a){a.exports={default:Mf,__esModule:!0}});cc(cc.S,"Object",{create:Ic});var Of=Mb.Object,Pf=function(a,b){return Of.create(a,b)},Qf=d(function(a){a.exports={default:Pf,__esModule:!0}}),Rf=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(Nf),e=c(Qf),f=c(wf);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,f.default)(b)));a.prototype=(0,e.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(d.default?(0,d.default)(a,b):a.__proto__=b)}}),Sf=c(Rf),Tf=Mb.JSON||(Mb.JSON={stringify:JSON.stringify}),Uf=function(a){return Tf.stringify.apply(Tf,arguments)},Vf=d(function(a){a.exports={default:Uf,__esModule:!0}}),Wf=c(Vf),Xf=Object.getOwnPropertySymbols,Yf=Object.prototype.hasOwnProperty,Zf=Object.prototype.propertyIsEnumerable,$f=function(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de","5"===Object.getOwnPropertyNames(a)[0])return!1;for(var b={},c=0;c<10;c++)b["_"+String.fromCharCode(c)]=c;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var d={};return"abcdefghijklmnopqrst".split("").forEach(function(a){d[a]=a}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},d)).join("")}catch(a){return!1}}()?Object.assign:function(a,b){for(var c,d,e=f(a),g=1;g<arguments.length;g++){c=Object(arguments[g]);for(var h in c)Yf.call(c,h)&&(e[h]=c[h]);if(Xf){d=Xf(c);for(var i=0;i<d.length;i++)Zf.call(c,d[i])&&(e[d[i]]=c[d[i]])}}return e},_f=d(function(a,b){var c=b.createUniqueKey="undefined"!=typeof Symbol?Symbol:function(a){return"[["+a+"_"+Math.random().toFixed(8).slice(2)+"]]"};b.LISTENERS=c("listeners"),b.CAPTURE=1,b.BUBBLE=2,b.ATTRIBUTE=3,b.newNode=function(a,b){return{listener:a,kind:b,next:null}}}),ag=_f.LISTENERS,bg=_f.ATTRIBUTE,cg=_f.newNode,dg=function(a,b){function c(){a.call(this)}var d={constructor:{value:c,configurable:!0,writable:!0}};return b.forEach(function(a){d["on"+a]={get:function(){return g(this,a)},set:function(b){h(this,a,b)},configurable:!0,enumerable:!0}}),c.prototype=Object.create(a.prototype,d),c},eg={defineCustomEventTarget:dg},fg=_f.createUniqueKey,gg=fg("stop_immediate_propagation_flag"),hg=fg("canceled_flag"),ig=fg("original_event"),jg=Object.freeze({stopPropagation:Object.freeze({value:function(){var a=this[ig];"function"==typeof a.stopPropagation&&a.stopPropagation()},writable:!0,configurable:!0}),stopImmediatePropagation:Object.freeze({value:function(){this[gg]=!0;var a=this[ig];"function"==typeof a.stopImmediatePropagation&&a.stopImmediatePropagation()},writable:!0,configurable:!0}),preventDefault:Object.freeze({value:function(){!0===this.cancelable&&(this[hg]=!0);var a=this[ig];"function"==typeof a.preventDefault&&a.preventDefault()},writable:!0,configurable:!0}),defaultPrevented:Object.freeze({get:function(){return this[hg]},enumerable:!0,configurable:!0})}),kg=gg,lg=function(a,b){var c="number"==typeof a.timeStamp?a.timeStamp:Date.now(),d={type:{value:a.type,enumerable:!0},target:{value:b,enumerable:!0},currentTarget:{value:b,enumerable:!0},eventPhase:{value:2,enumerable:!0},bubbles:{value:Boolean(a.bubbles),enumerable:!0},cancelable:{value:Boolean(a.cancelable),enumerable:!0},timeStamp:{value:c,enumerable:!0},isTrusted:{value:!1,enumerable:!0}};return d[gg]={value:!1,writable:!0},d[hg]={value:!1,writable:!0},d[ig]={value:a},void 0!==a.detail&&(d.detail={value:a.detail,enumerable:!0}),Object.create(Object.create(a,jg),d)},mg={STOP_IMMEDIATE_PROPAGATION_FLAG:kg,createEventWrapper:lg},ng=d(function(a){var b=_f.LISTENERS,c=_f.CAPTURE,d=_f.BUBBLE,e=_f.ATTRIBUTE,f=_f.newNode,g=eg.defineCustomEventTarget,h=mg.createEventWrapper,i=mg.STOP_IMMEDIATE_PROPAGATION_FLAG,j="undefined"!=typeof window&&void 0!==window.EventTarget,k=a.exports=function a(){if(!(this instanceof a)){if(1===arguments.length&&Array.isArray(arguments[0]))return g(a,arguments[0]);if(arguments.length>0){for(var c=Array(arguments.length),d=0;d<arguments.length;++d)c[d]=arguments[d];return g(a,c)}throw new TypeError("Cannot call a class as a function")}Object.defineProperty(this,b,{value:Object.create(null)})};k.prototype=Object.create((j?window.EventTarget:Object).prototype,{constructor:{value:k,writable:!0,configurable:!0},addEventListener:{value:function(a,e,g){if(null==e)return!1;if("function"!=typeof e&&"object"!=typeof e)throw new TypeError('"listener" is not an object.');var h=g?c:d,i=this[b][a];if(null==i)return this[b][a]=f(e,h),!0;for(var j=null;null!=i;){if(i.listener===e&&i.kind===h)return!1;j=i,i=i.next}return j.next=f(e,h),!0},configurable:!0,writable:!0},removeEventListener:{value:function(a,e,f){if(null==e)return!1;for(var g=f?c:d,h=null,i=this[b][a];null!=i;){if(i.listener===e&&i.kind===g)return null==h?this[b][a]=i.next:h.next=i.next,!0;h=i,i=i.next}return!1},configurable:!0,writable:!0},dispatchEvent:{value:function(a){var c=this[b][a.type];if(null==c)return!0;for(var d=h(a,this);null!=c&&("function"==typeof c.listener?c.listener.call(this,d):c.kind!==e&&"function"==typeof c.listener.handleEvent&&c.listener.handleEvent(d),!d[i]);)c=c.next;return!d.defaultPrevented},configurable:!0,writable:!0}})}),og=function(){function a(){zf(this,a),this._entries=[]}return a.prototype.append=function(a,b){if("string"!=typeof a)throw new TypeError("FormData name must be a string");if("string"!=typeof b&&("object"!==(void 0===b?"undefined":xf(b))||"string"!=typeof b.uri))throw new TypeError("FormData value must be a string or { uri: tempFilePath }");this._entries.push([a,b])},a.prototype.set=function(a,b){var c=this.get(a);c?c[1]=b:this.append(a,b)},a.prototype.delete=function(a){this._entries=this._entries.filter(function(b){return b[0]!==a})},a.prototype.entries=function(){return this._entries},a.prototype.get=function(a){return this._entries.find(function(b){return b[0]===a})},a.prototype.getAll=function(a){return this._entries.filter(function(b){return b[0]===a})},a.prototype.has=function(a){return this._entries.some(function(b){return b[0]===a})},a.prototype.keys=function(){return this._entries.map(function(a){return a[0]})},a.prototype.values=function(){return this._entries.map(function(a){return a[1]})},a}(),pg=og,qg=0,rg=4,sg=["abort","error","load","loadstart","progress","timeout","loadend","readystatechange"],tg=function(a){function b(){zf(this,b);var c=Jf(this,a.call(this));return c.readyState=qg,c._headers={},c}return Sf(b,a),b.prototype.abort=function(){throw new Error("not supported in weapp")},b.prototype.getAllResponseHeaders=function(){return console.warn("getAllResponseHeaders always returns ''"),""},b.prototype.getResponseHeader=function(a){return"content-type"===a?(console.warn("get content-type always returns 'application/json'"),"application/json"):(console.warn("getResponseHeader always returns ''"),"")},b.prototype.overrideMimeType=function(){throw new Error("not supported in weapp")},b.prototype.open=function(a,b){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.readyState!==qg)throw new Error("request is already opened");if(!c)throw new Error("sync request is not supported");this._method=a,this._url=b,this.readyState=1,this.dispatchEvent({type:"readystatechange"})},b.prototype.setRequestHeader=function(a,b){if(1!==this.readyState)throw new Error("request is not opened");this._headers[a.toLowerCase()]=b},b.prototype.send=function(a){var b=this;if(1!==this.readyState)throw new Error("request is not opened");if(a instanceof pg){var c=a.entries(),d=c.filter(function(a){return"string"!=typeof a[1]});if(0===d.length)throw new Error("Must specify a Blob field in FormData");d.length>1&&console.warn("Only the first Blob will be send in Weapp");var e=c.filter(function(a){return"string"==typeof a[1]}).reduce(function(a,b){return $f(a,Hf({},b[0],b[1]))},{});wx.uploadFile({url:this._url,name:d[0][0],filePath:d[0][1].uri,formData:e,header:this._headers,success:i.bind(this),fail:function(a){b.status=0,b.readyState=rg,b.dispatchEvent({type:"readystatechange"}),b.dispatchEvent({type:"error"})}})}else wx.request({url:this._url,data:a||"",method:this._method.toUpperCase(),header:this._headers,success:i.bind(this),fail:function(a){b.status=0,b.readyState=rg,b.dispatchEvent({type:"readystatechange"}),b.dispatchEvent({type:"error"})}})},b}(ng(sg));$f(tg,{UNSENT:qg,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:rg});var ug=tg,vg=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(Ef);b.default=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),(0,c.default)(a,e.key,e)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()}),wg=c(vg),xg=0,yg=1,zg=3,Ag=["open","error","message","close"],Bg=void 0,Cg=function(a){function b(c,d){if(zf(this,b),!c)throw new TypeError("Failed to construct 'WebSocket': url required");if(d)throw new Error("subprotocal not supported in weapp");var e=Jf(this,a.call(this));return e._url=c,e._protocal="",e._readyState=xg,Bg&&Bg.dispatchEvent({type:"close"}),Bg=e,wx.onSocketOpen(function(a){Bg&&(Bg._readyState=yg,Bg.dispatchEvent({type:"open"}))}),wx.onSocketError(j),wx.onSocketMessage(function(a){if(Bg){var b=a.data,c=a.origin,d=a.ports,e=a.source;Bg.dispatchEvent({data:b,origin:c,ports:d,source:e,type:"message"})}}),wx.onSocketClose(function(a){if(Bg){Bg._readyState=zg;var b=a.code,c=a.reason,d=a.wasClean;Bg.dispatchEvent({code:b,reason:c,wasClean:d,type:"close"}),Bg=null}}),wx.connectSocket({url:c,fail:function(a){return setTimeout(function(){return j(a)},0)}}),e}return Sf(b,a),b.prototype.close=function(){this.readyState===xg&&console.warn("close WebSocket which is connecting might not work"),wx.closeSocket()},b.prototype.send=function(a){if(this.readyState!==yg)throw new Error("INVALID_STATE_ERR");if("string"!=typeof a)throw new TypeError("only string typed data are supported");wx.sendSocketMessage({data:a})},wg(b,[{key:"url",get:function(){return this._url}},{key:"protocal",get:function(){return this._protocal}},{key:"readyState",get:function(){return this._readyState}}]),b}(ng(Ag));$f(Cg,{CONNECTING:xg,OPEN:yg,CLOSING:2,CLOSED:zg});var Dg=Cg,Eg={},Fg={polyfill:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gb||window;if("object"!==(void 0===a?"undefined":xf(a)))throw new Error("polyfill target is not an Object");var b={localStorage:Bf,XMLHttpRequest:ug,FormData:pg,WebSocket:Dg,Object:Object,navigator:Eg};for(var c in b)a[c]||(a[c]=b[c])},localStorage:Bf,XMLHttpRequest:ug,FormData:pg,WebSocket:Dg},Gg=Fg.polyfill;window=window||{},Gg(),Gg(window);try{localStorage=localStorage||Bf}catch(a){}try{XMLHttpRequest=XMLHttpRequest||ug}catch(a){}try{FormData=FormData||pg}catch(a){}try{WebSocket=WebSocket||Dg}catch(a){}try{navigator=navigator||Eg}catch(a){}var Hg=d(function(a){!function(c,d){"function"==typeof b&&a&&a.exports?a.exports=d():(c.dcodeIO=c.dcodeIO||{}).Long=d()}(Gb,function(){function a(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c}function b(a){return!0===(a&&a.__isLong__)}function c(a,b){var c,d,f;return b?(a>>>=0,(f=0<=a&&a<256)&&(d=i[a])?d:(c=e(a,(0|a)<0?-1:0,!0),f&&(i[a]=c),c)):(a|=0,(f=-128<=a&&a<128)&&(d=h[a])?d:(c=e(a,a<0?-1:0,!1),f&&(h[a]=c),c))}function d(a,b){if(isNaN(a)||!isFinite(a))return b?p:o;if(b){if(a<0)return p;if(a>=l)return u}else{if(a<=-m)return v;if(a+1>=m)return t}return a<0?d(-a,b).neg():e(a%k|0,a/k|0,b)}function e(b,c,d){return new a(b,c,d)}function f(a,b,c){if(0===a.length)throw Error("empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return o;if("number"==typeof b?(c=b,b=!1):b=!!b,(c=c||10)<2||36<c)throw RangeError("radix");var e;if((e=a.indexOf("-"))>0)throw Error("interior hyphen");if(0===e)return f(a.substring(1),b,c).neg();for(var g=d(j(c,8)),h=o,i=0;i<a.length;i+=8){var k=Math.min(8,a.length-i),l=parseInt(a.substring(i,i+k),c);if(k<8){var m=d(j(c,k));h=h.mul(m).add(d(l))}else h=h.mul(g),h=h.add(d(l))}return h.unsigned=b,h}function g(b){return b instanceof a?b:"number"==typeof b?d(b):"string"==typeof b?f(b):e(b.low,b.high,b.unsigned)}a.prototype.__isLong__,Object.defineProperty(a.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),a.isLong=b;var h={},i={};a.fromInt=c,a.fromNumber=d,a.fromBits=e;var j=Math.pow;a.fromString=f,a.fromValue=g;var k=4294967296,l=k*k,m=l/2,n=c(1<<24),o=c(0);a.ZERO=o;var p=c(0,!0);a.UZERO=p;var q=c(1);a.ONE=q;var r=c(1,!0);a.UONE=r;var s=c(-1);a.NEG_ONE=s;var t=e(-1,2147483647,!1);a.MAX_VALUE=t;var u=e(-1,-1,!0);a.MAX_UNSIGNED_VALUE=u;var v=e(0,-2147483648,!1);a.MIN_VALUE=v;var w=a.prototype;return w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*k+(this.low>>>0):this.high*k+(this.low>>>0)},w.toString=function(a){if((a=a||10)<2||36<a)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(v)){var b=d(a),c=this.div(b),e=c.mul(b).sub(this);return c.toString(a)+e.toInt().toString(a)}return"-"+this.neg().toString(a)}for(var f=d(j(a,6),this.unsigned),g=this,h="";;){var i=g.div(f),k=g.sub(i.mul(f)).toInt()>>>0,l=k.toString(a);if(g=i,g.isZero())return l+h;for(;l.length<6;)l="0"+l;h=""+l+h}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(v)?64:this.neg().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high?b+33:b+1},w.isZero=function(){return 0===this.high&&0===this.low},w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(a){return b(a)||(a=g(a)),(this.unsigned===a.unsigned||this.high>>>31!=1||a.high>>>31!=1)&&(this.high===a.high&&this.low===a.low)},w.eq=w.equals,w.notEquals=function(a){return!this.eq(a)},w.neq=w.notEquals,w.lessThan=function(a){return this.comp(a)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(a){return this.comp(a)<=0},w.lte=w.lessThanOrEqual,w.greaterThan=function(a){return this.comp(a)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(a){return this.comp(a)>=0},w.gte=w.greaterThanOrEqual,w.compare=function(a){if(b(a)||(a=g(a)),this.eq(a))return 0;var c=this.isNegative(),d=a.isNegative();return c&&!d?-1:!c&&d?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.sub(a).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(v)?v:this.not().add(q)},w.neg=w.negate,w.add=function(a){b(a)||(a=g(a));var c=this.high>>>16,d=65535&this.high,f=this.low>>>16,h=65535&this.low,i=a.high>>>16,j=65535&a.high,k=a.low>>>16,l=65535&a.low,m=0,n=0,o=0,p=0;return p+=h+l,o+=p>>>16,p&=65535,o+=f+k,n+=o>>>16,o&=65535,n+=d+j,m+=n>>>16,n&=65535,m+=c+i,m&=65535,e(o<<16|p,m<<16|n,this.unsigned)},w.subtract=function(a){return b(a)||(a=g(a)),this.add(a.neg())},w.sub=w.subtract,w.multiply=function(a){if(this.isZero())return o;if(b(a)||(a=g(a)),a.isZero())return o;if(this.eq(v))return a.isOdd()?v:o;if(a.eq(v))return this.isOdd()?v:o;if(this.isNegative())return a.isNegative()?this.neg().mul(a.neg()):this.neg().mul(a).neg();if(a.isNegative())return this.mul(a.neg()).neg();if(this.lt(n)&&a.lt(n))return d(this.toNumber()*a.toNumber(),this.unsigned);var c=this.high>>>16,f=65535&this.high,h=this.low>>>16,i=65535&this.low,j=a.high>>>16,k=65535&a.high,l=a.low>>>16,m=65535&a.low,p=0,q=0,r=0,s=0;return s+=i*m,r+=s>>>16,s&=65535,r+=h*m,q+=r>>>16,r&=65535,r+=i*l,q+=r>>>16,r&=65535,q+=f*m,p+=q>>>16,q&=65535,q+=h*l,p+=q>>>16,q&=65535,q+=i*k,p+=q>>>16,q&=65535,p+=c*m+f*l+h*k+i*j,p&=65535,e(r<<16|s,p<<16|q,this.unsigned)},w.mul=w.multiply,w.divide=function(a){if(b(a)||(a=g(a)),a.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:o;var c,e,f;if(this.unsigned){if(a.unsigned||(a=a.toUnsigned()),a.gt(this))return p;if(a.gt(this.shru(1)))return r;f=p}else{if(this.eq(v)){if(a.eq(q)||a.eq(s))return v;if(a.eq(v))return q;return c=this.shr(1).div(a).shl(1),c.eq(o)?a.isNegative()?q:s:(e=this.sub(a.mul(c)),f=c.add(e.div(a)))}if(a.eq(v))return this.unsigned?p:o;if(this.isNegative())return a.isNegative()?this.neg().div(a.neg()):this.neg().div(a).neg();if(a.isNegative())return this.div(a.neg()).neg();f=o}for(e=this;e.gte(a);){c=Math.max(1,Math.floor(e.toNumber()/a.toNumber()));for(var h=Math.ceil(Math.log(c)/Math.LN2),i=h<=48?1:j(2,h-48),k=d(c),l=k.mul(a);l.isNegative()||l.gt(e);)c-=i,k=d(c,this.unsigned),l=k.mul(a);k.isZero()&&(k=q),f=f.add(k),e=e.sub(l)}return f},w.div=w.divide,w.modulo=function(a){return b(a)||(a=g(a)),this.sub(this.div(a).mul(a))},w.mod=w.modulo,w.not=function(){return e(~this.low,~this.high,this.unsigned)},w.and=function(a){return b(a)||(a=g(a)),e(this.low&a.low,this.high&a.high,this.unsigned)},w.or=function(a){return b(a)||(a=g(a)),e(this.low|a.low,this.high|a.high,this.unsigned)},w.xor=function(a){return b(a)||(a=g(a)),e(this.low^a.low,this.high^a.high,this.unsigned)},w.shiftLeft=function(a){return b(a)&&(a=a.toInt()),0==(a&=63)?this:a<32?e(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):e(0,this.low<<a-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(a){return b(a)&&(a=a.toInt()),0==(a&=63)?this:a<32?e(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):e(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(a){if(b(a)&&(a=a.toInt()),0===(a&=63))return this;var c=this.high;if(a<32){return e(this.low>>>a|c<<32-a,c>>>a,this.unsigned)}return 32===a?e(c,0,this.unsigned):e(c>>>a-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?e(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:e(this.low,this.high,!0)},w.toBytes=function(a){return a?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var a=this.high,b=this.low;return[255&b,b>>>8&255,b>>>16&255,b>>>24&255,255&a,a>>>8&255,a>>>16&255,a>>>24&255]},w.toBytesBE=function(){var a=this.high,b=this.low;return[a>>>24&255,a>>>16&255,a>>>8&255,255&a,b>>>24&255,b>>>16&255,b>>>8&255,255&b]},a})}),Ig=d(function(a){!function(c,d){"function"==typeof b&&a&&a.exports?a.exports=function(){var a;try{a=Hg}catch(a){}return d(a)}():(c.dcodeIO=c.dcodeIO||{}).ByteBuffer=d(c.dcodeIO.Long)}(Gb,function(a){function b(a){var b=0;return function(){return b<a.length?a.charCodeAt(b++):null}}function c(){var a=[],b=[];return function(){if(0===arguments.length)return b.join("")+i.apply(String,a);a.length+arguments.length>1024&&(b.push(i.apply(String,a)),a.length=0),Array.prototype.push.apply(a,arguments)}}function d(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)}function e(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=b<0||0===b&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}var f=function(a,b,c){if(void 0===a&&(a=f.DEFAULT_CAPACITY),void 0===b&&(b=f.DEFAULT_ENDIAN),void 0===c&&(c=f.DEFAULT_NOASSERT),!c){if((a|=0)<0)throw RangeError("Illegal capacity");b=!!b,c=!!c}this.buffer=0===a?h:new ArrayBuffer(a),this.view=0===a?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=a,this.littleEndian=b,this.noAssert=c};f.VERSION="5.0.1",f.LITTLE_ENDIAN=!0,f.BIG_ENDIAN=!1,f.DEFAULT_CAPACITY=16,f.DEFAULT_ENDIAN=f.BIG_ENDIAN,f.DEFAULT_NOASSERT=!1,f.Long=a||null;var g=f.prototype;g.__isByteBuffer__,Object.defineProperty(g,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var h=new ArrayBuffer(0),i=String.fromCharCode;f.accessor=function(){return Uint8Array},f.allocate=function(a,b,c){return new f(a,b,c)},f.concat=function(a,b,c,d){"boolean"!=typeof b&&"string"==typeof b||(d=c,c=b,b=void 0);for(var e,g=0,h=0,i=a.length;h<i;++h)f.isByteBuffer(a[h])||(a[h]=f.wrap(a[h],b)),(e=a[h].limit-a[h].offset)>0&&(g+=e);if(0===g)return new f(0,c,d);var j,k=new f(g,c,d);for(h=0;h<i;)j=a[h++],(e=j.limit-j.offset)<=0||(k.view.set(j.view.subarray(j.offset,j.limit),k.offset),k.offset+=e);return k.limit=k.offset,k.offset=0,k},f.isByteBuffer=function(a){return!0===(a&&a.__isByteBuffer__)},f.type=function(){return ArrayBuffer},f.wrap=function(a,b,c,d){if("string"!=typeof b&&(d=c,c=b,b=void 0),"string"==typeof a)switch(void 0===b&&(b="utf8"),b){case"base64":return f.fromBase64(a,c);case"hex":return f.fromHex(a,c);case"binary":return f.fromBinary(a,c);case"utf8":return f.fromUTF8(a,c);case"debug":return f.fromDebug(a,c);default:throw Error("Unsupported encoding: "+b)}if(null===a||"object"!=typeof a)throw TypeError("Illegal buffer");var e;if(f.isByteBuffer(a))return e=g.clone.call(a),e.markedOffset=-1,e;if(a instanceof Uint8Array)e=new f(0,c,d),a.length>0&&(e.buffer=a.buffer,e.offset=a.byteOffset,e.limit=a.byteOffset+a.byteLength,e.view=new Uint8Array(a.buffer));else if(a instanceof ArrayBuffer)e=new f(0,c,d),a.byteLength>0&&(e.buffer=a,e.offset=0,e.limit=a.byteLength,e.view=a.byteLength>0?new Uint8Array(a):null);else{if("[object Array]"!==Object.prototype.toString.call(a))throw TypeError("Illegal buffer");e=new f(a.length,c,d),e.limit=a.length;for(var h=0;h<a.length;++h)e.view[h]=a[h]}return e},g.writeBitSet=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if(!(a instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,e=b,f=a.length,g=f>>3,h=0;for(b+=this.writeVarint32(f,b);g--;)d=1&!!a[h++]|(1&!!a[h++])<<1|(1&!!a[h++])<<2|(1&!!a[h++])<<3|(1&!!a[h++])<<4|(1&!!a[h++])<<5|(1&!!a[h++])<<6|(1&!!a[h++])<<7,this.writeByte(d,b++);if(h<f){var i=0;for(d=0;h<f;)d|=(1&!!a[h++])<<i++;this.writeByte(d,b++)}return c?(this.offset=b,this):b-e},g.readBitSet=function(a){var b=void 0===a;b&&(a=this.offset);var c,d=this.readVarint32(a),e=d.value,f=e>>3,g=0,h=[];for(a+=d.length;f--;)c=this.readByte(a++),h[g++]=!!(1&c),h[g++]=!!(2&c),h[g++]=!!(4&c),h[g++]=!!(8&c),h[g++]=!!(16&c),h[g++]=!!(32&c),h[g++]=!!(64&c),h[g++]=!!(128&c);if(g<e){var i=0;for(c=this.readByte(a++);g<e;)h[g++]=!!(c>>i++&1)}return b&&(this.offset=a),h},g.readBytes=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+a>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+"+a+") <= "+this.buffer.byteLength)}var d=this.slice(b,b+a);return c&&(this.offset+=a),d},g.writeBytes=g.append,g.writeInt8=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view[b]=a,c&&(this.offset+=1),this},g.writeByte=g.writeInt8,g.readInt8=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view[a];return 128==(128&c)&&(c=-(255-c+1)),b&&(this.offset+=1),c},g.readByte=g.readInt8,g.writeUint8=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view[b]=a,c&&(this.offset+=1),this},g.writeUInt8=g.writeUint8,g.readUint8=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view[a];return b&&(this.offset+=1),c},g.readUInt8=g.readUint8,g.writeInt16=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.littleEndian?(this.view[b+1]=(65280&a)>>>8,this.view[b]=255&a):(this.view[b]=(65280&a)>>>8,this.view[b+1]=255&a),c&&(this.offset+=2),this},g.writeShort=g.writeInt16,g.readInt16=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[a],c|=this.view[a+1]<<8):(c=this.view[a]<<8,c|=this.view[a+1]),32768==(32768&c)&&(c=-(65535-c+1)),b&&(this.offset+=2),c},g.readShort=g.readInt16,g.writeUint16=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.littleEndian?(this.view[b+1]=(65280&a)>>>8,this.view[b]=255&a):(this.view[b]=(65280&a)>>>8,this.view[b+1]=255&a),c&&(this.offset+=2),this},g.writeUInt16=g.writeUint16,g.readUint16=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[a],c|=this.view[a+1]<<8):(c=this.view[a]<<8,c|=this.view[a+1]),b&&(this.offset+=2),c},g.readUInt16=g.readUint16,g.writeInt32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength
;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.littleEndian?(this.view[b+3]=a>>>24&255,this.view[b+2]=a>>>16&255,this.view[b+1]=a>>>8&255,this.view[b]=255&a):(this.view[b]=a>>>24&255,this.view[b+1]=a>>>16&255,this.view[b+2]=a>>>8&255,this.view[b+3]=255&a),c&&(this.offset+=4),this},g.writeInt=g.writeInt32,g.readInt32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[a+2]<<16,c|=this.view[a+1]<<8,c|=this.view[a],c+=this.view[a+3]<<24>>>0):(c=this.view[a+1]<<16,c|=this.view[a+2]<<8,c|=this.view[a+3],c+=this.view[a]<<24>>>0),c|=0,b&&(this.offset+=4),c},g.readInt=g.readInt32,g.writeUint32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.littleEndian?(this.view[b+3]=a>>>24&255,this.view[b+2]=a>>>16&255,this.view[b+1]=a>>>8&255,this.view[b]=255&a):(this.view[b]=a>>>24&255,this.view[b+1]=a>>>16&255,this.view[b+2]=a>>>8&255,this.view[b+3]=255&a),c&&(this.offset+=4),this},g.writeUInt32=g.writeUint32,g.readUint32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=0;return this.littleEndian?(c=this.view[a+2]<<16,c|=this.view[a+1]<<8,c|=this.view[a],c+=this.view[a+3]<<24>>>0):(c=this.view[a+1]<<16,c|=this.view[a+2]<<8,c|=this.view[a+3],c+=this.view[a]<<24>>>0),b&&(this.offset+=4),c},g.readUInt32=g.readUint32,a&&(g.writeInt64=function(b,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b)),c+=8;var e=this.buffer.byteLength;c>e&&this.resize((e*=2)>c?e:c),c-=8;var f=b.low,g=b.high;return this.littleEndian?(this.view[c+3]=f>>>24&255,this.view[c+2]=f>>>16&255,this.view[c+1]=f>>>8&255,this.view[c]=255&f,c+=4,this.view[c+3]=g>>>24&255,this.view[c+2]=g>>>16&255,this.view[c+1]=g>>>8&255,this.view[c]=255&g):(this.view[c]=g>>>24&255,this.view[c+1]=g>>>16&255,this.view[c+2]=g>>>8&255,this.view[c+3]=255&g,c+=4,this.view[c]=f>>>24&255,this.view[c+1]=f>>>16&255,this.view[c+2]=f>>>8&255,this.view[c+3]=255&f),d&&(this.offset+=8),this},g.writeLong=g.writeInt64,g.readInt64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=0,e=0;this.littleEndian?(d=this.view[b+2]<<16,d|=this.view[b+1]<<8,d|=this.view[b],d+=this.view[b+3]<<24>>>0,b+=4,e=this.view[b+2]<<16,e|=this.view[b+1]<<8,e|=this.view[b],e+=this.view[b+3]<<24>>>0):(e=this.view[b+1]<<16,e|=this.view[b+2]<<8,e|=this.view[b+3],e+=this.view[b]<<24>>>0,b+=4,d=this.view[b+1]<<16,d|=this.view[b+2]<<8,d|=this.view[b+3],d+=this.view[b]<<24>>>0);var f=new a(d,e,!1);return c&&(this.offset+=8),f},g.readLong=g.readInt64,g.writeUint64=function(b,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b)),c+=8;var e=this.buffer.byteLength;c>e&&this.resize((e*=2)>c?e:c),c-=8;var f=b.low,g=b.high;return this.littleEndian?(this.view[c+3]=f>>>24&255,this.view[c+2]=f>>>16&255,this.view[c+1]=f>>>8&255,this.view[c]=255&f,c+=4,this.view[c+3]=g>>>24&255,this.view[c+2]=g>>>16&255,this.view[c+1]=g>>>8&255,this.view[c]=255&g):(this.view[c]=g>>>24&255,this.view[c+1]=g>>>16&255,this.view[c+2]=g>>>8&255,this.view[c+3]=255&g,c+=4,this.view[c]=f>>>24&255,this.view[c+1]=f>>>16&255,this.view[c+2]=f>>>8&255,this.view[c+3]=255&f),d&&(this.offset+=8),this},g.writeUInt64=g.writeUint64,g.readUint64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=0,e=0;this.littleEndian?(d=this.view[b+2]<<16,d|=this.view[b+1]<<8,d|=this.view[b],d+=this.view[b+3]<<24>>>0,b+=4,e=this.view[b+2]<<16,e|=this.view[b+1]<<8,e|=this.view[b],e+=this.view[b+3]<<24>>>0):(e=this.view[b+1]<<16,e|=this.view[b+2]<<8,e|=this.view[b+3],e+=this.view[b]<<24>>>0,b+=4,d=this.view[b+1]<<16,d|=this.view[b+2]<<8,d|=this.view[b+3],d+=this.view[b]<<24>>>0);var f=new a(d,e,!0);return c&&(this.offset+=8),f},g.readUInt64=g.readUint64),g.writeFloat32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,e(this.view,a,b,this.littleEndian,23,4),c&&(this.offset+=4),this},g.writeFloat=g.writeFloat32,g.readFloat32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=d(this.view,a,this.littleEndian,23,4);return b&&(this.offset+=4),c},g.readFloat=g.readFloat32,g.writeFloat64=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=8;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=8,e(this.view,a,b,this.littleEndian,52,8),c&&(this.offset+=8),this},g.writeDouble=g.writeFloat64,g.readFloat64=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+8) <= "+this.buffer.byteLength)}var c=d(this.view,a,this.littleEndian,52,8);return b&&(this.offset+=8),c},g.readDouble=g.readFloat64,f.MAX_VARINT32_BYTES=5,f.calculateVarint32=function(a){return a>>>=0,a<128?1:a<16384?2:a<1<<21?3:a<1<<28?4:5},f.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},f.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},g.writeVarint32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,e=f.calculateVarint32(a);b+=e;var g=this.buffer.byteLength;for(b>g&&this.resize((g*=2)>b?g:b),b-=e,a>>>=0;a>=128;)d=127&a|128,this.view[b++]=d,a>>>=7;return this.view[b++]=a,c?(this.offset=b,this):e},g.writeVarint32ZigZag=function(a,b){return this.writeVarint32(f.zigZagEncode32(a),b)},g.readVarint32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=0,e=0;do{if(!this.noAssert&&a>this.limit){var f=Error("Truncated");throw f.truncated=!0,f}c=this.view[a++],d<5&&(e|=(127&c)<<7*d),++d}while(0!=(128&c));return e|=0,b?(this.offset=a,e):{value:e,length:d}},g.readVarint32ZigZag=function(a){var b=this.readVarint32(a);return"object"==typeof b?b.value=f.zigZagDecode32(b.value):b=f.zigZagDecode32(b),b},a&&(f.MAX_VARINT64_BYTES=10,f.calculateVarint64=function(b){"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0,e=b.shiftRightUnsigned(56).toInt()>>>0;return 0==e?0==d?c<16384?c<128?1:2:c<1<<21?3:4:d<16384?d<128?5:6:d<1<<21?7:8:e<128?9:10},f.zigZagEncode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},f.zigZagDecode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},g.writeVarint64=function(b,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned());var e=f.calculateVarint64(b),g=b.toInt()>>>0,h=b.shiftRightUnsigned(28).toInt()>>>0,i=b.shiftRightUnsigned(56).toInt()>>>0;c+=e;var j=this.buffer.byteLength;switch(c>j&&this.resize((j*=2)>c?j:c),c-=e,e){case 10:this.view[c+9]=i>>>7&1;case 9:this.view[c+8]=9!==e?128|i:127&i;case 8:this.view[c+7]=8!==e?h>>>21|128:h>>>21&127;case 7:this.view[c+6]=7!==e?h>>>14|128:h>>>14&127;case 6:this.view[c+5]=6!==e?h>>>7|128:h>>>7&127;case 5:this.view[c+4]=5!==e?128|h:127&h;case 4:this.view[c+3]=4!==e?g>>>21|128:g>>>21&127;case 3:this.view[c+2]=3!==e?g>>>14|128:g>>>14&127;case 2:this.view[c+1]=2!==e?g>>>7|128:g>>>7&127;case 1:this.view[c]=1!==e?128|g:127&g}return d?(this.offset+=e,this):e},g.writeVarint64ZigZag=function(a,b){return this.writeVarint64(f.zigZagEncode64(a),b)},g.readVarint64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+1) <= "+this.buffer.byteLength)}var d=b,e=0,f=0,g=0,h=0;if(h=this.view[b++],e=127&h,128&h&&(h=this.view[b++],e|=(127&h)<<7,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],e|=(127&h)<<14,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],e|=(127&h)<<21,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],f=127&h,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],f|=(127&h)<<7,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],f|=(127&h)<<14,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],f|=(127&h)<<21,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],g=127&h,(128&h||this.noAssert&&void 0===h)&&(h=this.view[b++],g|=(127&h)<<7,128&h||this.noAssert&&void 0===h))))))))))throw Error("Buffer overrun");var i=a.fromBits(e|f<<28,f>>>4|g<<24,!1);return c?(this.offset=b,i):{value:i,length:b-d}},g.readVarint64ZigZag=function(b){var c=this.readVarint64(b);return c&&c.value instanceof a?c.value=f.zigZagDecode64(c.value):c=f.zigZagDecode64(c),c}),g.writeCString=function(a,c){var d=void 0===c;d&&(c=this.offset);var e,f=a.length;if(!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");for(e=0;e<f;++e)if(0===a.charCodeAt(e))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}f=k.calculateUTF16asUTF8(b(a))[1],c+=f+1;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=f+1,k.encodeUTF16toUTF8(b(a),function(a){this.view[c++]=a}.bind(this)),this.view[c++]=0,d?(this.offset=c,this):f},g.readCString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var d,e=a,f=-1;return k.decodeUTF8toUTF16(function(){if(0===f)return null;if(a>=this.limit)throw RangeError("Illegal range: Truncated data, "+a+" < "+this.limit);return f=this.view[a++],0===f?null:f}.bind(this),d=c(),!0),b?(this.offset=a,d()):{string:d(),length:a-e}},g.writeIString=function(a,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=k.calculateUTF16asUTF8(b(a),this.noAssert)[1],c+=4+e;var g=this.buffer.byteLength;if(c>g&&this.resize((g*=2)>c?g:c),c-=4+e,this.littleEndian?(this.view[c+3]=e>>>24&255,this.view[c+2]=e>>>16&255,this.view[c+1]=e>>>8&255,this.view[c]=255&e):(this.view[c]=e>>>24&255,this.view[c+1]=e>>>16&255,this.view[c+2]=e>>>8&255,this.view[c+3]=255&e),c+=4,k.encodeUTF16toUTF8(b(a),function(a){this.view[c++]=a}.bind(this)),c!==f+4+e)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+4+e));return d?(this.offset=c,this):c-f},g.readIString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=a,d=this.readUint32(a),e=this.readUTF8String(d,f.METRICS_BYTES,a+=4);return a+=e.length,b?(this.offset=a,e.string):{string:e.string,length:a-c}},f.METRICS_CHARS="c",f.METRICS_BYTES="b",g.writeUTF8String=function(a,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=k.calculateUTF16asUTF8(b(a))[1],c+=e;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=e,k.encodeUTF16toUTF8(b(a),function(a){this.view[c++]=a}.bind(this)),d?(this.offset=c,this):c-f},g.writeString=g.writeUTF8String,f.calculateUTF8Chars=function(a){return k.calculateUTF16asUTF8(b(a))[0]},f.calculateUTF8Bytes=function(a){return k.calculateUTF16asUTF8(b(a))[1]},f.calculateString=f.calculateUTF8Bytes,g.readUTF8String=function(a,b,d){"number"==typeof b&&(d=b,b=void 0);var e=void 0===d;if(e&&(d=this.offset),void 0===b&&(b=f.METRICS_CHARS),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal length: "+a+" (not an integer)");if(a|=0,"number"!=typeof d||d%1!=0)throw TypeError("Illegal offset: "+d+" (not an integer)");if((d>>>=0)<0||d+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+d+" (+0) <= "+this.buffer.byteLength)}var g,h=0,i=d;if(b===f.METRICS_CHARS){if(g=c(),k.decodeUTF8(function(){return h<a&&d<this.limit?this.view[d++]:null}.bind(this),function(a){++h,k.UTF8toUTF16(a,g)}),h!==a)throw RangeError("Illegal range: Truncated data, "+h+" == "+a);return e?(this.offset=d,g()):{string:g(),length:d-i}}if(b===f.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof d||d%1!=0)throw TypeError("Illegal offset: "+d+" (not an integer)");if((d>>>=0)<0||d+a>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+d+" (+"+a+") <= "+this.buffer.byteLength)}var j=d+a;if(k.decodeUTF8toUTF16(function(){return d<j?this.view[d++]:null}.bind(this),g=c(),this.noAssert),d!==j)throw RangeError("Illegal range: Truncated data, "+d+" == "+j);return e?(this.offset=d,g()):{string:g(),length:d-i}}throw TypeError("Unsupported metrics: "+b)},g.readString=g.readUTF8String,g.writeVString=function(a,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,g,h=c;e=k.calculateUTF16asUTF8(b(a),this.noAssert)[1],g=f.calculateVarint32(e),c+=g+e;var i=this.buffer.byteLength;if(c>i&&this.resize((i*=2)>c?i:c),c-=g+e,c+=this.writeVarint32(e,c),k.encodeUTF16toUTF8(b(a),function(a){this.view[c++]=a}.bind(this)),c!==h+e+g)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+e+g));return d?(this.offset=c,this):c-h},g.readVString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=a,d=this.readVarint32(a),e=this.readUTF8String(d.value,f.METRICS_BYTES,a+=d.length);return a+=e.length,b?(this.offset=a,e.string):{string:e.string,length:a-c}},g.append=function(a,b,c){"number"!=typeof b&&"string"==typeof b||(c=b,b=void 0);var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof f||(a=f.wrap(a,b));var e=a.limit-a.offset;if(e<=0)return this;c+=e;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=e,this.view.set(a.view.subarray(a.offset,a.limit),c),a.offset+=e,d&&(this.offset+=e),this},g.appendTo=function(a,b){return a.append(this,b),this},g.assert=function(a){return this.noAssert=!a,this},g.capacity=function(){return this.buffer.byteLength},g.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},g.clone=function(a){var b=new f(0,this.littleEndian,this.noAssert);return a?(b.buffer=new ArrayBuffer(this.buffer.byteLength),b.view=new Uint8Array(b.buffer)):(b.buffer=this.buffer,b.view=this.view),b.offset=this.offset,b.markedOffset=this.markedOffset,b.limit=this.limit,b},g.compact=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(0===a&&b===this.buffer.byteLength)return this;var c=b-a;if(0===c)return this.buffer=h,this.view=null,this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=0,this;var d=new ArrayBuffer(c),e=new Uint8Array(d);return e.set(this.view.subarray(a,b)),this.buffer=d,this.view=e,this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=c,this},g.copy=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return new f(0,this.littleEndian,this.noAssert);var c=b-a,d=new f(c,this.littleEndian,this.noAssert);return d.offset=0,d.limit=c,d.markedOffset>=0&&(d.markedOffset-=a),this.copyTo(d,0,a,b),d},g.copyTo=function(a,b,c,d){var e,g;if(!this.noAssert&&!f.isByteBuffer(a))throw TypeError("Illegal target: Not a ByteBuffer");if(b=(g=void 0===b)?a.offset:0|b,c=(e=void 0===c)?this.offset:0|c,d=void 0===d?this.limit:0|d,b<0||b>a.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+b+" <= "+a.buffer.byteLength);if(c<0||d>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+c+" <= "+this.buffer.byteLength);var h=d-c;return 0===h?a:(a.ensureCapacity(b+h),a.view.set(this.view.subarray(c,d),b),e&&(this.offset+=h),g&&(a.offset+=h),this)},g.ensureCapacity=function(a){var b=this.buffer.byteLength;return b<a?this.resize((b*=2)>a?b:a):this},g.fill=function(a,b,c){var d=void 0===b;if(d&&(b=this.offset),"string"==typeof a&&a.length>0&&(a=a.charCodeAt(0)),void 0===b&&(b=this.offset),void 0===c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal begin: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!=0)throw TypeError("Illegal end: Not an integer");if(c>>>=0,b<0||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(b>=c)return this;for(;b<c;)this.view[b++]=a;return d&&(this.offset=b),this},g.flip=function(){return this.limit=this.offset,this.offset=0,this},g.mark=function(a){if(a=void 0===a?this.offset:a,!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=a,this},g.order=function(a){if(!this.noAssert&&"boolean"!=typeof a)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!a,this},g.LE=function(a){return this.littleEndian=void 0===a||!!a,this},g.BE=function(a){return this.littleEndian=void 0!==a&&!a,this},g.prepend=function(a,b,c){"number"!=typeof b&&"string"==typeof b||(c=b,b=void 0);var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof f||(a=f.wrap(a,b));var e=a.limit-a.offset;if(e<=0)return this;var g=e-c;if(g>0){var h=new ArrayBuffer(this.buffer.byteLength+g),i=new Uint8Array(h);i.set(this.view.subarray(c,this.buffer.byteLength),e),this.buffer=h,this.view=i,this.offset+=g,this.markedOffset>=0&&(this.markedOffset+=g),this.limit+=g,c+=g}else{new Uint8Array(this.buffer)}return this.view.set(a.view.subarray(a.offset,a.limit),c-e),a.offset=a.limit,d&&(this.offset-=e),this},g.prependTo=function(a,b){return a.prepend(this,b),this},g.printDebug=function(a){"function"!=typeof a&&(a=console.log.bind(console)),a(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},g.remaining=function(){return this.limit-this.offset},g.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},g.resize=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal capacity: "+a+" (not an integer)");if((a|=0)<0)throw RangeError("Illegal capacity: 0 <= "+a)}if(this.buffer.byteLength<a){var b=new ArrayBuffer(a),c=new Uint8Array(b);c.set(this.view),this.buffer=b,this.view=c}return this},g.reverse=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}return a===b?this:(Array.prototype.reverse.call(this.view.subarray(a,b)),this)},g.skip=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal length: "+a+" (not an integer)");a|=0}var b=this.offset+a;if(!this.noAssert&&(b<0||b>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+a+" <= "+this.buffer.byteLength);return this.offset=b,this},g.slice=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=a,c.limit=b,c},g.toBuffer=function(a){var b=this.offset,c=this.limit;if(!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!=0)throw TypeError("Illegal limit: Not an integer");if(c>>>=0,b<0||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(!a&&0===b&&c===this.buffer.byteLength)return this.buffer;if(b===c)return h;var d=new ArrayBuffer(c-b);return new Uint8Array(d).set(new Uint8Array(this.buffer).subarray(b,c),0),d},g.toArrayBuffer=g.toBuffer,g.toString=function(a,b,c){if(void 0===a)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof a&&(a="utf8",b=a,c=b),a){case"utf8":return this.toUTF8(b,c);case"base64":return this.toBase64(b,c);case"hex":return this.toHex(b,c);case"binary":return this.toBinary(b,c);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+a)}};var j=function(){for(var a={},b=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],c=[],d=0,e=b.length;d<e;++d)c[b[d]]=d;return a.encode=function(a,c){for(var d,e;null!==(d=a());)c(b[d>>2&63]),e=(3&d)<<4,null!==(d=a())?(e|=d>>4&15,c(b[63&(e|d>>4&15)]),e=(15&d)<<2,null!==(d=a())?(c(b[63&(e|d>>6&3)]),c(b[63&d])):(c(b[63&e]),c(61))):(c(b[63&e]),c(61),c(61))},a.decode=function(a,b){function d(a){throw Error("Illegal character code: "+a)}for(var e,f,g;null!==(e=a());)if(f=c[e],void 0===f&&d(e),null!==(e=a())&&(g=c[e],void 0===g&&d(e),b(f<<2>>>0|(48&g)>>4),null!==(e=a()))){if(void 0===(f=c[e])){if(61===e)break;d(e)}if(b((15&g)<<4>>>0|(60&f)>>2),null!==(e=a())){if(void 0===(g=c[e])){if(61===e)break;d(e)}b((3&f)<<6>>>0|g)}}},a.test=function(a){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(a)},a}();g.toBase64=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),a|=0,b|=0,a<0||b>this.capacity||a>b)throw RangeError("begin, end");var d;return j.encode(function(){return a<b?this.view[a++]:null}.bind(this),d=c()),d()},f.fromBase64=function(a,c){if("string"!=typeof a)throw TypeError("str");var d=new f(a.length/4*3,c),e=0;return j.decode(b(a),function(a){d.view[e++]=a}),d.limit=e,d},f.btoa=function(a){return f.fromBinary(a).toBase64()},f.atob=function(a){return f.fromBase64(a).toBinary()},g.toBinary=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),a|=0,b|=0,a<0||b>this.capacity()||a>b)throw RangeError("begin, end");if(a===b)return"";for(var c=[],d=[];a<b;)c.push(this.view[a++]),c.length>=1024&&(d.push(String.fromCharCode.apply(String,c)),c=[]);return d.join("")+String.fromCharCode.apply(String,c)},f.fromBinary=function(a,b){if("string"!=typeof a)throw TypeError("str");for(var c,d=0,e=a.length,g=new f(e,b);d<e;){if((c=a.charCodeAt(d))>255)throw RangeError("illegal char code: "+c);g.view[d++]=c}return g.limit=e,g},g.toDebug=function(a){for(var b,c=-1,d=this.buffer.byteLength,e="",f="",g="";c<d;){if(-1!==c&&(b=this.view[c],e+=b<16?"0"+b.toString(16).toUpperCase():b.toString(16).toUpperCase(),a&&(f+=b>32&&b<127?String.fromCharCode(b):".")),++c,a&&c>0&&c%16==0&&c!==d){for(;e.length<51;)e+=" ";g+=e+f+"\n",e=f=""}c===this.offset&&c===this.limit?e+=c===this.markedOffset?"!":"|":c===this.offset?e+=c===this.markedOffset?"[":"<":c===this.limit?e+=c===this.markedOffset?"]":">":e+=c===this.markedOffset?"'":a||0!==c&&c!==d?" ":""}if(a&&" "!==e){for(;e.length<51;)e+=" ";g+=e+f+"\n"}return a?g:e},f.fromDebug=function(a,b,c){for(var d,e,g=a.length,h=new f((g+1)/3|0,b,c),i=0,j=0,k=!1,l=!1,m=!1,n=!1,o=!1;i<g;){switch(d=a.charAt(i++)){case"!":if(!c){if(l||m||n){o=!0;break}l=m=n=!0}h.offset=h.markedOffset=h.limit=j,k=!1;break;case"|":if(!c){if(l||n){o=!0;break}l=n=!0}h.offset=h.limit=j,k=!1;break;case"[":if(!c){if(l||m){o=!0;break}l=m=!0}h.offset=h.markedOffset=j,k=!1;break;case"<":if(!c){if(l){o=!0;break}l=!0}h.offset=j,k=!1;break;case"]":if(!c){if(n||m){o=!0;break}n=m=!0}h.limit=h.markedOffset=j,k=!1;break;case">":if(!c){if(n){o=!0;break}n=!0}h.limit=j,k=!1;break;case"'":if(!c){if(m){o=!0;break}m=!0}h.markedOffset=j,k=!1;break;case" ":k=!1;break;default:if(!c&&k){o=!0;break}if(e=parseInt(d+a.charAt(i++),16),!c&&(isNaN(e)||e<0||e>255))throw TypeError("Illegal str: Not a debug encoded string");h.view[j++]=e,k=!0}if(o)throw TypeError("Illegal str: Invalid symbol at "+i)}if(!c){if(!l||!n)throw TypeError("Illegal str: Missing offset or limit");if(j<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+j+" < "+g)}return h},g.toHex=function(a,b){if(a=void 0===a?this.offset:a,b=void 0===b?this.limit:b,!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}for(var c,d=new Array(b-a);a<b;)c=this.view[a++],c<16?d.push("0",c.toString(16)):d.push(c.toString(16));return d.join("")},f.fromHex=function(a,b,c){if(!c){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if(a.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var d,e=a.length,g=new f(e/2|0,b),h=0,i=0;h<e;h+=2){if(d=parseInt(a.substring(h,h+2),16),!c&&(!isFinite(d)||d<0||d>255))throw TypeError("Illegal str: Contains non-hex characters");g.view[i++]=d}return g.limit=i,g};var k=function(){var a={};return a.MAX_CODEPOINT=1114111,a.encodeUTF8=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)c<128?b(127&c):c<2048?(b(c>>6&31|192),b(63&c|128)):c<65536?(b(c>>12&15|224),b(c>>6&63|128),b(63&c|128)):(b(c>>18&7|240),b(c>>12&63|128),b(c>>6&63|128),b(63&c|128)),c=null},a.decodeUTF8=function(a,b){for(var c,d,e,f,g=function(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b};null!==(c=a());)if(0==(128&c))b(c);else if(192==(224&c))null===(d=a())&&g([c,d]),b((31&c)<<6|63&d);else if(224==(240&c))(null===(d=a())||null===(e=a()))&&g([c,d,e]),
b((15&c)<<12|(63&d)<<6|63&e);else{if(240!=(248&c))throw RangeError("Illegal starting byte: "+c);(null===(d=a())||null===(e=a())||null===(f=a()))&&g([c,d,e,f]),b((7&c)<<18|(63&d)<<12|(63&e)<<6|63&f)}},a.UTF16toUTF8=function(a,b){for(var c,d=null;;){if(null===(c=null!==d?d:a()))break;c>=55296&&c<=57343&&null!==(d=a())&&d>=56320&&d<=57343?(b(1024*(c-55296)+d-56320+65536),d=null):b(c)}null!==d&&b(d)},a.UTF8toUTF16=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)c<=65535?b(c):(c-=65536,b(55296+(c>>10)),b(c%1024+56320)),c=null},a.encodeUTF16toUTF8=function(b,c){a.UTF16toUTF8(b,function(b){a.encodeUTF8(b,c)})},a.decodeUTF8toUTF16=function(b,c){a.decodeUTF8(b,function(b){a.UTF8toUTF16(b,c)})},a.calculateCodePoint=function(a){return a<128?1:a<2048?2:a<65536?3:4},a.calculateUTF8=function(a){for(var b,c=0;null!==(b=a());)c+=b<128?1:b<2048?2:b<65536?3:4;return c},a.calculateUTF16asUTF8=function(b){var c=0,d=0;return a.UTF16toUTF8(b,function(a){++c,d+=a<128?1:a<2048?2:a<65536?3:4}),[c,d]},a}();return g.toUTF8=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var d;try{k.decodeUTF8toUTF16(function(){return a<b?this.view[a++]:null}.bind(this),d=c())}catch(c){if(a!==b)throw RangeError("Illegal range: Truncated data, "+a+" != "+b)}return d()},f.fromUTF8=function(a,c,d){if(!d&&"string"!=typeof a)throw TypeError("Illegal str: Not a string");var e=new f(k.calculateUTF16asUTF8(b(a),!0)[1],c,d),g=0;return k.encodeUTF16toUTF8(b(a),function(a){e.view[g++]=a}),e.limit=g,e},f})}),Jg={},Kg=Object.freeze({default:Jg}),Lg=Kg&&Jg||Kg,Mg=d(function(a){!function(c,d){"function"==typeof b&&a&&a.exports?a.exports=d(Ig,!0):(c.dcodeIO=c.dcodeIO||{}).ProtoBuf=d(c.dcodeIO.ByteBuffer)}(Gb,function(a,b){var c={};return c.ByteBuffer=a,c.Long=a.Long||null,c.VERSION="5.0.2",c.WIRE_TYPES={},c.WIRE_TYPES.VARINT=0,c.WIRE_TYPES.BITS64=1,c.WIRE_TYPES.LDELIM=2,c.WIRE_TYPES.STARTGROUP=3,c.WIRE_TYPES.ENDGROUP=4,c.WIRE_TYPES.BITS32=5,c.PACKABLE_WIRE_TYPES=[c.WIRE_TYPES.VARINT,c.WIRE_TYPES.BITS64,c.WIRE_TYPES.BITS32],c.TYPES={int32:{name:"int32",wireType:c.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:c.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:c.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:c.WIRE_TYPES.VARINT,defaultValue:c.Long?c.Long.ZERO:void 0},uint64:{name:"uint64",wireType:c.WIRE_TYPES.VARINT,defaultValue:c.Long?c.Long.UZERO:void 0},sint64:{name:"sint64",wireType:c.WIRE_TYPES.VARINT,defaultValue:c.Long?c.Long.ZERO:void 0},bool:{name:"bool",wireType:c.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:c.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:c.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:c.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:c.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:c.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:c.WIRE_TYPES.BITS64,defaultValue:c.Long?c.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:c.WIRE_TYPES.BITS64,defaultValue:c.Long?c.Long.ZERO:void 0},float:{name:"float",wireType:c.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:c.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:c.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:c.WIRE_TYPES.STARTGROUP,defaultValue:null}},c.MAP_KEY_TYPES=[c.TYPES.int32,c.TYPES.sint32,c.TYPES.sfixed32,c.TYPES.uint32,c.TYPES.fixed32,c.TYPES.int64,c.TYPES.sint64,c.TYPES.sfixed64,c.TYPES.uint64,c.TYPES.fixed64,c.TYPES.bool,c.TYPES.string,c.TYPES.bytes],c.ID_MIN=1,c.ID_MAX=536870911,c.convertFieldsToCamelCase=!1,c.populateAccessors=!0,c.populateDefaults=!0,c.Util=function(){var a={};return a.IS_NODE=!("object"!=typeof Fb||Fb+""!="[object process]"||Fb.browser),a.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=null,c=0;c<a.length;c++){try{b=a[c]()}catch(a){continue}break}if(!b)throw Error("XMLHttpRequest is not supported");return b},a.fetch=function(b,c){if(c&&"function"!=typeof c&&(c=null),a.IS_NODE){var d=Lg;if(c)d.readFile(b,function(a,b){c(a?null:""+b)});else try{return d.readFileSync(b)}catch(a){return null}}else{var e=a.XHR();if(e.open("GET",b,!!c),e.setRequestHeader("Accept","text/plain"),"function"==typeof e.overrideMimeType&&e.overrideMimeType("text/plain"),!c)return e.send(null),200==e.status||0==e.status&&"string"==typeof e.responseText?e.responseText:null;if(e.onreadystatechange=function(){4==e.readyState&&c(200==e.status||0==e.status&&"string"==typeof e.responseText?e.responseText:null)},4==e.readyState)return;e.send(null)}},a.toCamelCase=function(a){return a.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()})},a}(),c.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},c.Reflect=function(b){function c(c){if("string"==typeof c&&(c=b.TYPES[c]),void 0===c.defaultValue)throw Error("default value for type "+c.name+" is not supported");return c==b.TYPES.bytes?new a(0):c.defaultValue}function d(a,c){if(a&&"number"==typeof a.low&&"number"==typeof a.high&&"boolean"==typeof a.unsigned&&a.low===a.low&&a.high===a.high)return new b.Long(a.low,a.high,void 0===c?a.unsigned:c);if("string"==typeof a)return b.Long.fromString(a,c||!1,10);if("number"==typeof a)return b.Long.fromNumber(a,c||!1);throw Error("not convertible to Long")}function e(a,c){var d=c.readVarint32(),f=7&d,g=d>>>3;switch(f){case b.WIRE_TYPES.VARINT:do{d=c.readUint8()}while(128==(128&d));break;case b.WIRE_TYPES.BITS64:c.offset+=8;break;case b.WIRE_TYPES.LDELIM:d=c.readVarint32(),c.offset+=d;break;case b.WIRE_TYPES.STARTGROUP:e(g,c);break;case b.WIRE_TYPES.ENDGROUP:if(g===a)return!1;throw Error("Illegal GROUPEND after unknown group: "+g+" ("+a+" expected)");case b.WIRE_TYPES.BITS32:c.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+a+": "+f)}return!0}var f={},g=function(a,b,c){this.builder=a,this.parent=b,this.name=c,this.className},h=g.prototype;h.fqn=function(){for(var a=this.name,b=this;;){if(null==(b=b.parent))break;a=b.name+"."+a}return a},h.toString=function(a){return(a?this.className+" ":"")+this.fqn()},h.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},f.T=g;var i=function(a,b,c,d,e){g.call(this,a,b,c),this.className="Namespace",this.children=[],this.options=d||{},this.syntax=e||"proto2"},j=i.prototype=Object.create(g.prototype);j.getChildren=function(a){if(null==(a=a||null))return this.children.slice();for(var b=[],c=0,d=this.children.length;c<d;++c)this.children[c]instanceof a&&b.push(this.children[c]);return b},j.addChild=function(a){var b;if(b=this.getChild(a.name))if(b instanceof m.Field&&b.name!==b.originalName&&null===this.getChild(b.originalName))b.name=b.originalName;else{if(!(a instanceof m.Field&&a.name!==a.originalName&&null===this.getChild(a.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+a.name);a.name=a.originalName}this.children.push(a)},j.getChild=function(a){for(var b="number"==typeof a?"id":"name",c=0,d=this.children.length;c<d;++c)if(this.children[c][b]===a)return this.children[c];return null},j.resolve=function(a,b){var c="string"==typeof a?a.split("."):a,d=this,e=0;if(""===c[e]){for(;null!==d.parent;)d=d.parent;e++}var g;do{do{if(!(d instanceof f.Namespace)){d=null;break}if(!(g=d.getChild(c[e]))||!(g instanceof f.T)||b&&!(g instanceof f.Namespace)){d=null;break}d=g,e++}while(e<c.length);if(null!=d)break;if(null!==this.parent)return this.parent.resolve(a,b)}while(null!=d);return d},j.qn=function(a){var b=[],c=a;do{b.unshift(c.name),c=c.parent}while(null!==c);for(var d=1;d<=b.length;d++){var e=b.slice(b.length-d);if(a===this.resolve(e,a instanceof f.Namespace))return e.join(".")}return a.fqn()},j.build=function(){for(var a,b={},c=this.children,d=0,e=c.length;d<e;++d)(a=c[d])instanceof i&&(b[a.name]=a.build());return Object.defineProperty&&Object.defineProperty(b,"$options",{value:this.buildOpt()}),b},j.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0,d=b.length;c<d;++c){var e=b[c],f=this.options[b[c]];a[e]=f}return a},j.getOption=function(a){return void 0===a?this.options:void 0!==this.options[a]?this.options[a]:null},f.Namespace=i;var k=function(a,c,d,e,f){if(this.type=a,this.resolvedType=c,this.isMapKey=d,this.syntax=e,this.name=f,d&&b.MAP_KEY_TYPES.indexOf(a)<0)throw Error("Invalid map key type: "+a.name)},l=k.prototype;k.defaultFieldValue=c,l.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},l.verifyValue=function(c){function e(a,b){throw Error("Illegal value for "+f.toString(!0)+" of type "+f.type.name+": "+a+" ("+b+")")}var f=this;switch(this.type){case b.TYPES.int32:case b.TYPES.sint32:case b.TYPES.sfixed32:return("number"!=typeof c||c===c&&c%1!=0)&&e(typeof c,"not an integer"),c>4294967295?0|c:c;case b.TYPES.uint32:case b.TYPES.fixed32:return("number"!=typeof c||c===c&&c%1!=0)&&e(typeof c,"not an integer"),c<0?c>>>0:c;case b.TYPES.int64:case b.TYPES.sint64:case b.TYPES.sfixed64:if(b.Long)try{return d(c,!1)}catch(a){e(typeof c,a.message)}else e(typeof c,"requires Long.js");case b.TYPES.uint64:case b.TYPES.fixed64:if(b.Long)try{return d(c,!0)}catch(a){e(typeof c,a.message)}else e(typeof c,"requires Long.js");case b.TYPES.bool:return"boolean"!=typeof c&&e(typeof c,"not a boolean"),c;case b.TYPES.float:case b.TYPES.double:return"number"!=typeof c&&e(typeof c,"not a number"),c;case b.TYPES.string:return"string"==typeof c||c&&c instanceof String||e(typeof c,"not a string"),""+c;case b.TYPES.bytes:return a.isByteBuffer(c)?c:a.wrap(c,"base64");case b.TYPES.enum:var g=this.resolvedType.getChildren(b.Reflect.Enum.Value);for(i=0;i<g.length;i++){if(g[i].name==c)return g[i].id;if(g[i].id==c)return g[i].id}if("proto3"===this.syntax)return("number"!=typeof c||c===c&&c%1!=0)&&e(typeof c,"not an integer"),(c>4294967295||c<0)&&e(typeof c,"not in range for uint32"),c;e(c,"not a valid enum value");case b.TYPES.group:case b.TYPES.message:if(c&&"object"==typeof c||e(typeof c,"object expected"),c instanceof this.resolvedType.clazz)return c;if(c instanceof b.Builder.Message){var h={};for(var i in c)c.hasOwnProperty(i)&&(h[i]=c[i]);c=h}return new this.resolvedType.clazz(c)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+c+" (undefined type "+this.type+")")},l.calculateLength=function(c,d){if(null===d)return 0;var e;switch(this.type){case b.TYPES.int32:return d<0?a.calculateVarint64(d):a.calculateVarint32(d);case b.TYPES.uint32:return a.calculateVarint32(d);case b.TYPES.sint32:return a.calculateVarint32(a.zigZagEncode32(d));case b.TYPES.fixed32:case b.TYPES.sfixed32:case b.TYPES.float:return 4;case b.TYPES.int64:case b.TYPES.uint64:return a.calculateVarint64(d);case b.TYPES.sint64:return a.calculateVarint64(a.zigZagEncode64(d));case b.TYPES.fixed64:case b.TYPES.sfixed64:return 8;case b.TYPES.bool:return 1;case b.TYPES.enum:return a.calculateVarint32(d);case b.TYPES.double:return 8;case b.TYPES.string:return e=a.calculateUTF8Bytes(d),a.calculateVarint32(e)+e;case b.TYPES.bytes:if(d.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+d.remaining()+" bytes remaining");return a.calculateVarint32(d.remaining())+d.remaining();case b.TYPES.message:return e=this.resolvedType.calculate(d),a.calculateVarint32(e)+e;case b.TYPES.group:return(e=this.resolvedType.calculate(d))+a.calculateVarint32(c<<3|b.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+d+" (unknown type)")},l.encodeValue=function(c,d,e){if(null===d)return e;switch(this.type){case b.TYPES.int32:d<0?e.writeVarint64(d):e.writeVarint32(d);break;case b.TYPES.uint32:e.writeVarint32(d);break;case b.TYPES.sint32:e.writeVarint32ZigZag(d);break;case b.TYPES.fixed32:e.writeUint32(d);break;case b.TYPES.sfixed32:e.writeInt32(d);break;case b.TYPES.int64:case b.TYPES.uint64:e.writeVarint64(d);break;case b.TYPES.sint64:e.writeVarint64ZigZag(d);break;case b.TYPES.fixed64:e.writeUint64(d);break;case b.TYPES.sfixed64:e.writeInt64(d);break;case b.TYPES.bool:"string"==typeof d?e.writeVarint32("false"===d.toLowerCase()?0:!!d):e.writeVarint32(d?1:0);break;case b.TYPES.enum:e.writeVarint32(d);break;case b.TYPES.float:e.writeFloat32(d);break;case b.TYPES.double:e.writeFloat64(d);break;case b.TYPES.string:e.writeVString(d);break;case b.TYPES.bytes:if(d.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+d.remaining()+" bytes remaining");var f=d.offset;e.writeVarint32(d.remaining()),e.append(d),d.offset=f;break;case b.TYPES.message:var g=(new a).LE();this.resolvedType.encode(d,g),e.writeVarint32(g.offset),e.append(g.flip());break;case b.TYPES.group:this.resolvedType.encode(d,e),e.writeVarint32(c<<3|b.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+d+" (unknown type)")}return e},l.decode=function(a,c,d){if(c!=this.type.wireType)throw Error("Unexpected wire type for element");var e,f;switch(this.type){case b.TYPES.int32:return 0|a.readVarint32();case b.TYPES.uint32:return a.readVarint32()>>>0;case b.TYPES.sint32:return 0|a.readVarint32ZigZag();case b.TYPES.fixed32:return a.readUint32()>>>0;case b.TYPES.sfixed32:return 0|a.readInt32();case b.TYPES.int64:return a.readVarint64();case b.TYPES.uint64:return a.readVarint64().toUnsigned();case b.TYPES.sint64:return a.readVarint64ZigZag();case b.TYPES.fixed64:return a.readUint64();case b.TYPES.sfixed64:return a.readInt64();case b.TYPES.bool:return!!a.readVarint32();case b.TYPES.enum:return a.readVarint32();case b.TYPES.float:return a.readFloat();case b.TYPES.double:return a.readDouble();case b.TYPES.string:return a.readVString();case b.TYPES.bytes:if(f=a.readVarint32(),a.remaining()<f)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+f+" required but got only "+a.remaining());return e=a.clone(),e.limit=e.offset+f,a.offset+=f,e;case b.TYPES.message:return f=a.readVarint32(),this.resolvedType.decode(a,f);case b.TYPES.group:return this.resolvedType.decode(a,-1,d)}throw Error("[INTERNAL] Illegal decode type")},l.valueFromString=function(c){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case b.TYPES.int32:case b.TYPES.sint32:case b.TYPES.sfixed32:case b.TYPES.uint32:case b.TYPES.fixed32:return this.verifyValue(parseInt(c));case b.TYPES.int64:case b.TYPES.sint64:case b.TYPES.sfixed64:case b.TYPES.uint64:case b.TYPES.fixed64:return this.verifyValue(c);case b.TYPES.bool:return"true"===c;case b.TYPES.string:return this.verifyValue(c);case b.TYPES.bytes:return a.fromBinary(c)}},l.valueToString=function(a){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===b.TYPES.bytes?a.toString("binary"):a.toString()},f.Element=k;var m=function(a,b,c,d,e,f){i.call(this,a,b,c,d,f),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!e,this._fields=null,this._fieldsById=null,this._fieldsByName=null},n=m.prototype=Object.create(i.prototype);n.build=function(c){if(this.clazz&&!c)return this.clazz;var d=function(b,c){function d(c,e,f,g){if(null===c||"object"!=typeof c){if(g&&g instanceof b.Reflect.Enum){var h=b.Reflect.Enum.getName(g.object,c);if(null!==h)return h}return c}if(a.isByteBuffer(c))return e?c.toBase64():c.toBuffer();if(b.Long.isLong(c))return f?c.toString():b.Long.fromValue(c);var i;if(Array.isArray(c))return i=[],c.forEach(function(a,b){i[b]=d(a,e,f,g)}),i;if(i={},c instanceof b.Map){for(var j=c.entries(),k=j.next();!k.done;k=j.next())i[c.keyElem.valueToString(k.value[0])]=d(k.value[1],e,f,c.valueElem.resolvedType);return i}var l=c.$type,m=void 0;for(var n in c)c.hasOwnProperty(n)&&(l&&(m=l.getChild(n))?i[n]=d(c[n],e,f,m.resolvedType):i[n]=d(c[n],e,f));return i}var e=c.getChildren(b.Reflect.Message.Field),f=c.getChildren(b.Reflect.Message.OneOf),g=function(d,h){b.Builder.Message.call(this);for(var i=0,j=f.length;i<j;++i)this[f[i].name]=null;for(i=0,j=e.length;i<j;++i){var k=e[i];this[k.name]=k.repeated?[]:k.map?new b.Map(k):null,!k.required&&"proto3"!==c.syntax||null===k.defaultValue||(this[k.name]=k.defaultValue)}if(arguments.length>0){var l;if(1!==arguments.length||null===d||"object"!=typeof d||!("function"!=typeof d.encode||d instanceof g)||Array.isArray(d)||d instanceof b.Map||a.isByteBuffer(d)||d instanceof ArrayBuffer||b.Long&&d instanceof b.Long)for(i=0,j=arguments.length;i<j;++i)void 0!==(l=arguments[i])&&this.$set(e[i].name,l);else this.$set(d)}},h=g.prototype=Object.create(b.Builder.Message.prototype);h.add=function(a,d,e){var f=c._fieldsByName[a];if(!e){if(!f)throw Error(this+"#"+a+" is undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+a+" is not a repeated field");d=f.verifyValue(d,!0)}return null===this[a]&&(this[a]=[]),this[a].push(d),this},h.$add=h.add,h.set=function(a,d,e){if(a&&"object"==typeof a){e=d;for(var f in a)a.hasOwnProperty(f)&&void 0!==(d=a[f])&&void 0===c._oneofsByName[f]&&this.$set(f,d,e);return this}var g=c._fieldsByName[a];if(e)this[a]=d;else{if(!g)throw Error(this+"#"+a+" is not a field: undefined");if(!(g instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+g.toString(!0));this[g.name]=d=g.verifyValue(d)}if(g&&g.oneof){var h=this[g.oneof.name];null!==d?(null!==h&&h!==g.name&&(this[h]=null),this[g.oneof.name]=g.name):h===a&&(this[g.oneof.name]=null)}return this},h.$set=h.set,h.get=function(a,d){if(d)return this[a];var e=c._fieldsByName[a];if(!(e&&e instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: undefined");if(!(e instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+e.toString(!0));return this[e.name]},h.$get=h.get;for(var i=0;i<e.length;i++){var j=e[i];j instanceof b.Reflect.Message.ExtensionField||c.builder.options.populateAccessors&&function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")});b=b.substring(0,1).toUpperCase()+b.substring(1);var d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a}),e=function(b,c){return this[a.name]=c?b:a.verifyValue(b),this},f=function(){return this[a.name]};null===c.getChild("set"+b)&&(h["set"+b]=e),null===c.getChild("set_"+d)&&(h["set_"+d]=e),null===c.getChild("get"+b)&&(h["get"+b]=f),null===c.getChild("get_"+d)&&(h["get_"+d]=f)}(j)}h.encode=function(b,d){"boolean"==typeof b&&(d=b,b=void 0);var e=!1;b||(b=new a,e=!0);var f=b.littleEndian;try{return c.encode(this,b.LE(),d),(e?b.flip():b).LE(f)}catch(a){throw b.LE(f),a}},g.encode=function(a,b,c){return new g(a).encode(b,c)},h.calculate=function(){return c.calculate(this)},h.encodeDelimited=function(b,d){var e=!1;b||(b=new a,e=!0);var f=(new a).LE();return c.encode(this,f,d).flip(),b.writeVarint32(f.remaining()),b.append(f),e?b.flip():b},h.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toArrayBuffer()),a}},h.toArrayBuffer=h.encodeAB,h.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a}},h.toBuffer=h.encodeNB,h.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a}},h.toBase64=h.encode64,h.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toHex()),a}},h.toHex=h.encodeHex,h.toRaw=function(a,b){return d(this,!!a,!!b,this.$type)},h.encodeJSON=function(){return JSON.stringify(d(this,!0,!0,this.$type))},g.decode=function(b,d,e){"string"==typeof d&&(e=d,d=-1),"string"==typeof b?b=a.wrap(b,e||"base64"):a.isByteBuffer(b)||(b=a.wrap(b));var f=b.littleEndian;try{var g=c.decode(b.LE(),d);return b.LE(f),g}catch(a){throw b.LE(f),a}},g.decodeDelimited=function(b,d){if("string"==typeof b?b=a.wrap(b,d||"base64"):a.isByteBuffer(b)||(b=a.wrap(b)),b.remaining()<1)return null;var e=b.offset,f=b.readVarint32();if(b.remaining()<f)return b.offset=e,null;try{var g=c.decode(b.slice(b.offset,b.offset+f).LE());return b.offset+=f,g}catch(a){throw b.offset+=f,a}},g.decode64=function(a){return g.decode(a,"base64")},g.decodeHex=function(a){return g.decode(a,"hex")},g.decodeJSON=function(a){return new g(JSON.parse(a))},h.toString=function(){return c.toString()};return Object.defineProperty&&(Object.defineProperty(g,"$options",{value:c.buildOpt()}),Object.defineProperty(h,"$options",{value:g.$options}),Object.defineProperty(g,"$type",{value:c}),Object.defineProperty(h,"$type",{value:c})),g}(b,this);this._fields=[],this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var e,f=0,g=this.children.length;f<g;f++)if((e=this.children[f])instanceof s||e instanceof m||e instanceof v){if(d.hasOwnProperty(e.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+e.toString(!0)+" cannot override static property '"+e.name+"'");d[e.name]=e.build()}else if(e instanceof m.Field)e.build(),this._fields.push(e),this._fieldsById[e.id]=e,this._fieldsByName[e.name]=e;else if(e instanceof m.OneOf)this._oneofsByName[e.name]=e;else if(!(e instanceof m.OneOf||e instanceof u))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[f].toString(!0));return this.clazz=d},n.encode=function(a,b,c){for(var d,e,f=null,g=0,h=this._fields.length;g<h;++g)d=this._fields[g],e=a[d.name],d.required&&null===e?null===f&&(f=d):d.encode(c?e:d.verifyValue(e),b,a);if(null!==f){var i=Error("Missing at least one required field for "+this.toString(!0)+": "+f);throw i.encoded=b,i}return b},n.calculate=function(a){for(var b,c,d=0,e=0,f=this._fields.length;e<f;++e){if(b=this._fields[e],c=a[b.name],b.required&&null===c)throw Error("Missing at least one required field for "+this.toString(!0)+": "+b);d+=b.calculate(c,a)}return d},n.decode=function(a,c,d){"number"!=typeof c&&(c=-1);for(var f,g,h,i,j=a.offset,k=new this.clazz;a.offset<j+c||-1===c&&a.remaining()>0;){if(f=a.readVarint32(),g=7&f,h=f>>>3,g===b.WIRE_TYPES.ENDGROUP){if(h!==d)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+h+" ("+(d?d+" expected":"not a group")+")");break}if(i=this._fieldsById[h]){if(i.repeated&&!i.options.packed)k[i.name].push(i.decode(g,a));else if(i.map){var l=i.decode(g,a);k[i.name].set(l[0],l[1])}else if(k[i.name]=i.decode(g,a),i.oneof){var m=k[i.oneof.name];null!==m&&m!==i.name&&(k[m]=null),k[i.oneof.name]=i.name}}else switch(g){case b.WIRE_TYPES.VARINT:a.readVarint32();break;case b.WIRE_TYPES.BITS32:a.offset+=4;break;case b.WIRE_TYPES.BITS64:a.offset+=8;break;case b.WIRE_TYPES.LDELIM:var n=a.readVarint32();a.offset+=n;break;case b.WIRE_TYPES.STARTGROUP:for(;e(h,a););break;default:throw Error("Illegal wire type for unknown field "+h+" in "+this.toString(!0)+"#decode: "+g)}}for(var o=0,p=this._fields.length;o<p;++o)if(i=this._fields[o],null===k[i.name])if("proto3"===this.syntax)k[i.name]=i.defaultValue;else{if(i.required){var q=Error("Missing at least one required field for "+this.toString(!0)+": "+i.name);throw q.decoded=k,q}b.populateDefaults&&null!==i.defaultValue&&(k[i.name]=i.defaultValue)}return k},f.Message=m;var o=function(a,c,d,e,f,h,i,j,k,l){g.call(this,a,c,h),this.className="Message.Field",this.required="required"===d,this.repeated="repeated"===d,this.map="map"===d,this.keyType=e||null,this.type=f,this.resolvedType=null,this.id=i,this.options=j||{},this.defaultValue=null,this.oneof=k||null,this.syntax=l||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof m.ExtensionField||(this.name=b.Util.toCamelCase(this.name))},p=o.prototype=Object.create(g.prototype);p.build=function(){this.element=new k(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new k(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=k.defaultFieldValue(this.type)},p.verifyValue=function(a,c){function d(a,b){throw Error("Illegal value for "+e.toString(!0)+" of type "+e.type.name+": "+a+" ("+b+")")}c=c||!1;var e=this;if(null===a)return this.required&&d(typeof a,"required"),"proto3"===this.syntax&&this.type!==b.TYPES.message&&d(typeof a,"proto3 field without field presence cannot be null"),null;var f;if(this.repeated&&!c){Array.isArray(a)||(a=[a]);var g=[];for(f=0;f<a.length;f++)g.push(this.element.verifyValue(a[f]));return g}return this.map&&!c?a instanceof b.Map?a:(a instanceof Object||d(typeof a,"expected ProtoBuf.Map or raw object for map field"),new b.Map(this,a)):(!this.repeated&&Array.isArray(a)&&d(typeof a,"no array expected"),this.element.verifyValue(a))},p.hasWirePresence=function(a,c){if("proto3"!==this.syntax)return null!==a;if(this.oneof&&c[this.oneof.name]===this.name)return!0;switch(this.type){case b.TYPES.int32:case b.TYPES.sint32:case b.TYPES.sfixed32:case b.TYPES.uint32:case b.TYPES.fixed32:return 0!==a;case b.TYPES.int64:case b.TYPES.sint64:case b.TYPES.sfixed64:case b.TYPES.uint64:case b.TYPES.fixed64:return 0!==a.low||0!==a.high;case b.TYPES.bool:return a;case b.TYPES.float:case b.TYPES.double:return 0!==a;case b.TYPES.string:return a.length>0;case b.TYPES.bytes:return a.remaining()>0;case b.TYPES.enum:return 0!==a;case b.TYPES.message:return null!==a;default:return!0}},p.encode=function(c,d,e){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return d;try{if(this.repeated){var f;if(this.options.packed&&b.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){d.writeVarint32(this.id<<3|b.WIRE_TYPES.LDELIM),d.ensureCapacity(d.offset+=1);var g=d.offset;for(f=0;f<c.length;f++)this.element.encodeValue(this.id,c[f],d);var h=d.offset-g,i=a.calculateVarint32(h);if(i>1){var j=d.slice(g,d.offset);g+=i-1,d.offset=g,d.append(j)}d.writeVarint32(h,g-i)}else for(f=0;f<c.length;f++)d.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,c[f],d)}else this.map?c.forEach(function(c,e,f){var g=a.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,e)+a.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,c);d.writeVarint32(this.id<<3|b.WIRE_TYPES.LDELIM),d.writeVarint32(g),d.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,e,d),d.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,c,d)},this):this.hasWirePresence(c,e)&&(d.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,c,d))}catch(a){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+a+")")}return d},p.calculate=function(c,d){if(c=this.verifyValue(c),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===c||this.repeated&&0==c.length)return 0;var e=0;try{if(this.repeated){var f,g;if(this.options.packed&&b.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(e+=a.calculateVarint32(this.id<<3|b.WIRE_TYPES.LDELIM),g=0,f=0;f<c.length;f++)g+=this.element.calculateLength(this.id,c[f]);e+=a.calculateVarint32(g),e+=g}else for(f=0;f<c.length;f++)e+=a.calculateVarint32(this.id<<3|this.type.wireType),e+=this.element.calculateLength(this.id,c[f])}else this.map?c.forEach(function(c,d,f){var g=a.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,d)+a.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,c);e+=a.calculateVarint32(this.id<<3|b.WIRE_TYPES.LDELIM),e+=a.calculateVarint32(g),e+=g},this):this.hasWirePresence(c,d)&&(e+=a.calculateVarint32(this.id<<3|this.type.wireType),e+=this.element.calculateLength(this.id,c))}catch(a){throw Error("Illegal value for "+this.toString(!0)+": "+c+" ("+a+")")}return e},p.decode=function(a,c,d){var e,f;if(!(!this.map&&a==this.type.wireType||!d&&this.repeated&&this.options.packed&&a==b.WIRE_TYPES.LDELIM||this.map&&a==b.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+a+" ("+this.type.wireType+" expected)");if(a==b.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&b.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!d){f=c.readVarint32(),f=c.offset+f;for(var g=[];c.offset<f;)g.push(this.decode(this.type.wireType,c,!0));return g}if(this.map){var h=k.defaultFieldValue(this.keyType);if(e=k.defaultFieldValue(this.type),f=c.readVarint32(),c.remaining()<f)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+f+" required but got only "+c.remaining());var i=c.clone();for(i.limit=i.offset+f,c.offset+=f;i.remaining()>0;){var j=i.readVarint32();a=7&j;var l=j>>>3;if(1===l)h=this.keyElement.decode(i,a,l);else{if(2!==l)throw Error("Unexpected tag in map field key/value submessage");e=this.element.decode(i,a,l)}}return[h,e]}return this.element.decode(c,a,this.id)},f.Message.Field=o;var q=function(a,b,c,d,e,f,g){o.call(this,a,b,c,null,d,e,f,g),this.extension};q.prototype=Object.create(o.prototype),f.Message.ExtensionField=q;var r=function(a,b,c){g.call(this,a,b,c),this.fields=[]};f.Message.OneOf=r;var s=function(a,b,c,d,e){i.call(this,a,b,c,d,e),this.className="Enum",this.object=null};s.getName=function(a,b){for(var c,d=Object.keys(a),e=0;e<d.length;++e)if(a[c=d[e]]===b)return c;return null},(s.prototype=Object.create(i.prototype)).build=function(a){if(this.object&&!a)return this.object;for(var c=new b.Builder.Enum,d=this.getChildren(s.Value),e=0,f=d.length;e<f;++e)c[d[e].name]=d[e].id;return Object.defineProperty&&Object.defineProperty(c,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=c},f.Enum=s;var t=function(a,b,c,d){g.call(this,a,b,c),this.className="Enum.Value",this.id=d};t.prototype=Object.create(g.prototype),f.Enum.Value=t;var u=function(a,b,c,d){g.call(this,a,b,c),this.field=d};u.prototype=Object.create(g.prototype),f.Extension=u;var v=function(a,b,c,d){i.call(this,a,b,c,d),this.className="Service",this.clazz=null};(v.prototype=Object.create(i.prototype)).build=function(c){return this.clazz&&!c?this.clazz:this.clazz=function(b,c){for(var d=function(a){b.Builder.Service.call(this),this.rpcImpl=a||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},e=d.prototype=Object.create(b.Builder.Service.prototype),f=c.getChildren(b.Reflect.Service.RPCMethod),g=0;g<f.length;g++)!function(b){e[b.name]=function(d,e){try{try{d=b.resolvedRequestType.clazz.decode(a.wrap(d))}catch(a){if(!(a instanceof TypeError))throw a}if(null===d||"object"!=typeof d)throw Error("Illegal arguments")
;d instanceof b.resolvedRequestType.clazz||(d=new b.resolvedRequestType.clazz(d)),this.rpcImpl(b.fqn(),d,function(a,d){if(a)return void e(a);null===d&&(d="");try{d=b.resolvedResponseType.clazz.decode(d)}catch(a){}if(!(d&&d instanceof b.resolvedResponseType.clazz))return void e(Error("Illegal response type received in service method "+c.name+"#"+b.name));e(null,d)})}catch(a){setTimeout(e.bind(this,a),0)}},d[b.name]=function(a,c,e){new d(a)[b.name](c,e)},Object.defineProperty&&(Object.defineProperty(d[b.name],"$options",{value:b.buildOpt()}),Object.defineProperty(e[b.name],"$options",{value:d[b.name].$options}))}(f[g]);return Object.defineProperty&&(Object.defineProperty(d,"$options",{value:c.buildOpt()}),Object.defineProperty(e,"$options",{value:d.$options}),Object.defineProperty(d,"$type",{value:c}),Object.defineProperty(e,"$type",{value:c})),d}(b,this)},f.Service=v;var w=function(a,b,c,d){g.call(this,a,b,c),this.className="Service.Method",this.options=d||{}};(w.prototype=Object.create(g.prototype)).buildOpt=j.buildOpt,f.Service.Method=w;var x=function(a,b,c,d,e,f,g,h){w.call(this,a,b,c,h),this.className="Service.RPCMethod",this.requestName=d,this.responseName=e,this.requestStream=f,this.responseStream=g,this.resolvedRequestType=null,this.resolvedResponseType=null};return x.prototype=Object.create(w.prototype),f.Service.RPCMethod=x,f}(c),c.Builder=function(a,b,c){function d(a){a.messages&&a.messages.forEach(function(b){b.syntax=a.syntax,d(b)}),a.enums&&a.enums.forEach(function(b){b.syntax=a.syntax})}var e=function(a){this.ns=new c.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=a||{}},f=e.prototype;return e.isMessage=function(a){return"string"==typeof a.name&&(void 0===a.values&&void 0===a.rpc)},e.isMessageField=function(a){return"string"==typeof a.rule&&"string"==typeof a.name&&"string"==typeof a.type&&void 0!==a.id},e.isEnum=function(a){return"string"==typeof a.name&&!(void 0===a.values||!Array.isArray(a.values)||0===a.values.length)},e.isService=function(a){return!("string"!=typeof a.name||"object"!=typeof a.rpc||!a.rpc)},e.isExtend=function(a){return"string"==typeof a.ref},f.reset=function(){return this.ptr=this.ns,this},f.define=function(a){if("string"!=typeof a||!b.TYPEREF.test(a))throw Error("illegal namespace: "+a);return a.split(".").forEach(function(a){var b=this.ptr.getChild(a);null===b&&this.ptr.addChild(b=new c.Namespace(this,this.ptr,a)),this.ptr=b},this),this},f.create=function(b){if(!b)return this;if(Array.isArray(b)){if(0===b.length)return this;b=b.slice()}else b=[b];for(var d=[b];d.length>0;){if(b=d.pop(),!Array.isArray(b))throw Error("not a valid namespace: "+JSON.stringify(b));for(;b.length>0;){var f=b.shift();if(e.isMessage(f)){var g=new c.Message(this,this.ptr,f.name,f.options,f.isGroup,f.syntax),h={};f.oneofs&&Object.keys(f.oneofs).forEach(function(a){g.addChild(h[a]=new c.Message.OneOf(this,g,a))},this),f.fields&&f.fields.forEach(function(a){if(null!==g.getChild(0|a.id))throw Error("duplicate or invalid field id in "+g.name+": "+a.id);if(a.options&&"object"!=typeof a.options)throw Error("illegal field options in "+g.name+"#"+a.name);var b=null;if("string"==typeof a.oneof&&!(b=h[a.oneof]))throw Error("illegal oneof in "+g.name+"#"+a.name+": "+a.oneof);a=new c.Message.Field(this,g,a.rule,a.keytype,a.type,a.name,a.id,a.options,b,f.syntax),b&&b.fields.push(a),g.addChild(a)},this);var i=[];if(f.enums&&f.enums.forEach(function(a){i.push(a)}),f.messages&&f.messages.forEach(function(a){i.push(a)}),f.services&&f.services.forEach(function(a){i.push(a)}),f.extensions&&("number"==typeof f.extensions[0]?g.extensions=[f.extensions]:g.extensions=f.extensions),this.ptr.addChild(g),i.length>0){d.push(b),b=i,i=null,this.ptr=g,g=null;continue}i=null}else if(e.isEnum(f))g=new c.Enum(this,this.ptr,f.name,f.options,f.syntax),f.values.forEach(function(a){g.addChild(new c.Enum.Value(this,g,a.name,a.id))},this),this.ptr.addChild(g);else if(e.isService(f))g=new c.Service(this,this.ptr,f.name,f.options),Object.keys(f.rpc).forEach(function(a){var b=f.rpc[a];g.addChild(new c.Service.RPCMethod(this,g,a,b.request,b.response,!!b.request_stream,!!b.response_stream,b.options))},this),this.ptr.addChild(g);else{if(!e.isExtend(f))throw Error("not a valid definition: "+JSON.stringify(f));if(g=this.ptr.resolve(f.ref,!0))f.fields.forEach(function(b){if(null!==g.getChild(0|b.id))throw Error("duplicate extended field id in "+g.name+": "+b.id);if(g.extensions){var d=!1;if(g.extensions.forEach(function(a){b.id>=a[0]&&b.id<=a[1]&&(d=!0)}),!d)throw Error("illegal extended field id in "+g.name+": "+b.id+" (not within valid ranges)")}var e=b.name;this.options.convertFieldsToCamelCase&&(e=a.Util.toCamelCase(e));var f=new c.Message.ExtensionField(this,g,b.rule,b.type,this.ptr.fqn()+"."+e,b.id,b.options),h=new c.Extension(this,this.ptr,b.name,f);f.extension=h,this.ptr.addChild(h),g.addChild(f)},this);else if(!/\.?google\.protobuf\./.test(f.ref))throw Error("extended message "+f.ref+" is not defined")}f=null,g=null}b=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},f.import=function(b,c){var e="/";if("string"==typeof c){if(a.Util.IS_NODE&&(c=Lg.resolve(c)),!0===this.files[c])return this.reset();this.files[c]=!0}else if("object"==typeof c){var f=c.root;a.Util.IS_NODE&&(f=Lg.resolve(f)),(f.indexOf("\\")>=0||c.file.indexOf("\\")>=0)&&(e="\\");var g;if(g=a.Util.IS_NODE?Lg.join(f,c.file):f+e+c.file,!0===this.files[g])return this.reset();this.files[g]=!0}if(b.imports&&b.imports.length>0){var h,i=!1;"object"==typeof c?(this.importRoot=c.root,i=!0,h=this.importRoot,c=c.file,(h.indexOf("\\")>=0||c.indexOf("\\")>=0)&&(e="\\")):"string"==typeof c?this.importRoot?h=this.importRoot:c.indexOf("/")>=0?""===(h=c.replace(/\/[^\/]*$/,""))&&(h="/"):c.indexOf("\\")>=0?(h=c.replace(/\\[^\\]*$/,""),e="\\"):h=".":h=null;for(var j=0;j<b.imports.length;j++)if("string"==typeof b.imports[j]){if(!h)throw Error("cannot determine import root");var k=b.imports[j];if("google/protobuf/descriptor.proto"===k)continue;if(k=a.Util.IS_NODE?Lg.join(h,k):h+e+k,!0===this.files[k])continue;/\.proto$/i.test(k)&&!a.DotProto&&(k=k.replace(/\.proto$/,".json"));var l=a.Util.fetch(k);if(null===l)throw Error("failed to import '"+k+"' in '"+c+"': file not found");/\.json$/i.test(k)?this.import(JSON.parse(l+""),k):this.import(a.DotProto.Parser.parse(l),k)}else c?/\.(\w+)$/.test(c)?this.import(b.imports[j],c.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+j+"."+c})):this.import(b.imports[j],c+"_import"+j):this.import(b.imports[j]);i&&(this.importRoot=null)}b.package&&this.define(b.package),b.syntax&&d(b);var m=this.ptr;return b.options&&Object.keys(b.options).forEach(function(a){m.options[a]=b.options[a]}),b.messages&&(this.create(b.messages),this.ptr=m),b.enums&&(this.create(b.enums),this.ptr=m),b.services&&(this.create(b.services),this.ptr=m),b.extends&&this.create(b.extends),this.reset()},f.resolveAll=function(){var d;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof c.Namespace)this.ptr.children.forEach(function(a){this.ptr=a,this.resolveAll()},this);else if(this.ptr instanceof c.Message.Field){if(b.TYPE.test(this.ptr.type))this.ptr.type=a.TYPES[this.ptr.type];else{if(!b.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(d=(this.ptr instanceof c.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=d,d instanceof c.Enum){if(this.ptr.type=a.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==d.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(d instanceof c.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=d.isGroup?a.TYPES.group:a.TYPES.message}}if(this.ptr.map){if(!b.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=a.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==a.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof a.Reflect.Service.Method){if(!(this.ptr instanceof a.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((d=this.ptr.parent.resolve(this.ptr.requestName,!0))&&d instanceof a.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=d,!((d=this.ptr.parent.resolve(this.ptr.responseName,!0))&&d instanceof a.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=d}else if(!(this.ptr instanceof a.Reflect.Message.OneOf||this.ptr instanceof a.Reflect.Extension||this.ptr instanceof a.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},f.build=function(a){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!a)return this.result;for(var b="string"==typeof a?a.split("."):a,c=this.result,d=0;d<b.length;d++){if(!c[b[d]]){c=null;break}c=c[b[d]]}return c},f.lookup=function(a,b){return a?this.ns.resolve(a,b):this.ns},f.toString=function(){return"Builder"},e.Message=function(){},e.Enum=function(){},e.Service=function(){},e}(c,c.Lang,c.Reflect),c.Map=function(a,b){function c(a){var b=0;return{next:function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}}var d=function(a,c){if(!a.map)throw Error("field is not a map");if(this.field=a,this.keyElem=new b.Element(a.keyType,null,!0,a.syntax),this.valueElem=new b.Element(a.type,a.resolvedType,!1,a.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),c)for(var d=Object.keys(c),e=0;e<d.length;e++){var f=this.keyElem.valueFromString(d[e]),g=this.valueElem.verifyValue(c[d[e]]);this.map[this.keyElem.valueToString(f)]={key:f,value:g}}},e=d.prototype;return e.clear=function(){this.map={}},e.delete=function(a){var b=this.keyElem.valueToString(this.keyElem.verifyValue(a)),c=b in this.map;return delete this.map[b],c},e.entries=function(){for(var a,b=[],d=Object.keys(this.map),e=0;e<d.length;e++)b.push([(a=this.map[d[e]]).key,a.value]);return c(b)},e.keys=function(){for(var a=[],b=Object.keys(this.map),d=0;d<b.length;d++)a.push(this.map[b[d]].key);return c(a)},e.values=function(){for(var a=[],b=Object.keys(this.map),d=0;d<b.length;d++)a.push(this.map[b[d]].value);return c(a)},e.forEach=function(a,b){for(var c,d=Object.keys(this.map),e=0;e<d.length;e++)a.call(b,(c=this.map[d[e]]).value,c.key,this)},e.set=function(a,b){var c=this.keyElem.verifyValue(a),d=this.valueElem.verifyValue(b);return this.map[this.keyElem.valueToString(c)]={key:c,value:d},this},e.get=function(a){var b=this.keyElem.valueToString(this.keyElem.verifyValue(a));if(b in this.map)return this.map[b].value},e.has=function(a){return this.keyElem.valueToString(this.keyElem.verifyValue(a))in this.map},d}(0,c.Reflect),c.newBuilder=function(a){return a=a||{},void 0===a.convertFieldsToCamelCase&&(a.convertFieldsToCamelCase=c.convertFieldsToCamelCase),void 0===a.populateAccessors&&(a.populateAccessors=c.populateAccessors),new c.Builder(a)},c.loadJson=function(a,b,d){return("string"==typeof b||b&&"string"==typeof b.file&&"string"==typeof b.root)&&(d=b,b=null),b&&"object"==typeof b||(b=c.newBuilder()),"string"==typeof a&&(a=JSON.parse(a)),b.import(a,d),b.resolveAll(),b},c.loadJsonFile=function(a,b,d){if(b&&"object"==typeof b?(d=b,b=null):b&&"function"==typeof b||(b=null),b)return c.Util.fetch("string"==typeof a?a:a.root+"/"+a.file,function(e){if(null===e)return void b(Error("Failed to fetch file"));try{b(null,c.loadJson(JSON.parse(e),d,a))}catch(a){b(a)}});var e=c.Util.fetch("object"==typeof a?a.root+"/"+a.file:a);return null===e?null:c.loadJson(JSON.parse(e),d,a)},c})}),Ng=Mg.newBuilder({}).import({package:"push_server.messages2",syntax:"proto2",options:{objc_class_prefix:"AVIM"},messages:[{name:"JsonObjectMessage",syntax:"proto2",fields:[{rule:"required",type:"string",name:"data",id:1}]},{name:"UnreadTuple",syntax:"proto2",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"required",type:"int32",name:"unread",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4},{rule:"optional",type:"string",name:"from",id:5},{rule:"optional",type:"string",name:"data",id:6},{rule:"optional",type:"int64",name:"patchTimestamp",id:7}]},{name:"LogItem",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"from",id:1},{rule:"optional",type:"string",name:"data",id:2},{rule:"optional",type:"int64",name:"timestamp",id:3},{rule:"optional",type:"string",name:"msgId",id:4},{rule:"optional",type:"int64",name:"ackAt",id:5},{rule:"optional",type:"int64",name:"readAt",id:6},{rule:"optional",type:"int64",name:"patchTimestamp",id:7}]},{name:"DataCommand",syntax:"proto2",fields:[{rule:"repeated",type:"string",name:"ids",id:1},{rule:"repeated",type:"JsonObjectMessage",name:"msg",id:2},{rule:"optional",type:"bool",name:"offline",id:3}]},{name:"SessionCommand",syntax:"proto2",fields:[{rule:"optional",type:"int64",name:"t",id:1},{rule:"optional",type:"string",name:"n",id:2},{rule:"optional",type:"string",name:"s",id:3},{rule:"optional",type:"string",name:"ua",id:4},{rule:"optional",type:"bool",name:"r",id:5},{rule:"optional",type:"string",name:"tag",id:6},{rule:"optional",type:"string",name:"deviceId",id:7},{rule:"repeated",type:"string",name:"sessionPeerIds",id:8},{rule:"repeated",type:"string",name:"onlineSessionPeerIds",id:9},{rule:"optional",type:"string",name:"st",id:10},{rule:"optional",type:"int32",name:"stTtl",id:11},{rule:"optional",type:"int32",name:"code",id:12},{rule:"optional",type:"string",name:"reason",id:13},{rule:"optional",type:"string",name:"deviceToken",id:14},{rule:"optional",type:"bool",name:"sp",id:15},{rule:"optional",type:"string",name:"detail",id:16},{rule:"optional",type:"int64",name:"lastUnreadNotifTime",id:17},{rule:"optional",type:"int64",name:"lastPatchTime",id:18},{rule:"optional",type:"int64",name:"configBitmap",id:19}]},{name:"ErrorCommand",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"code",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"optional",type:"int32",name:"appCode",id:3},{rule:"optional",type:"string",name:"detail",id:4}]},{name:"DirectCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"msg",id:1},{rule:"optional",type:"string",name:"uid",id:2},{rule:"optional",type:"string",name:"fromPeerId",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4},{rule:"optional",type:"bool",name:"offline",id:5},{rule:"optional",type:"bool",name:"hasMore",id:6},{rule:"repeated",type:"string",name:"toPeerIds",id:7},{rule:"optional",type:"bool",name:"r",id:10},{rule:"optional",type:"string",name:"cid",id:11},{rule:"optional",type:"string",name:"id",id:12},{rule:"optional",type:"bool",name:"transient",id:13},{rule:"optional",type:"string",name:"dt",id:14},{rule:"optional",type:"string",name:"roomId",id:15},{rule:"optional",type:"string",name:"pushData",id:16},{rule:"optional",type:"bool",name:"will",id:17},{rule:"optional",type:"int64",name:"patchTimestamp",id:18}]},{name:"AckCommand",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"code",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"int64",name:"t",id:5},{rule:"optional",type:"string",name:"uid",id:6},{rule:"optional",type:"int64",name:"fromts",id:7},{rule:"optional",type:"int64",name:"tots",id:8},{rule:"optional",type:"string",name:"type",id:9},{rule:"repeated",type:"string",name:"ids",id:10},{rule:"optional",type:"int32",name:"appCode",id:11}]},{name:"UnreadCommand",syntax:"proto2",fields:[{rule:"repeated",type:"UnreadTuple",name:"convs",id:1},{rule:"optional",type:"int64",name:"notifTime",id:2}]},{name:"ConvCommand",syntax:"proto2",fields:[{rule:"repeated",type:"string",name:"m",id:1},{rule:"optional",type:"bool",name:"transient",id:2},{rule:"optional",type:"bool",name:"unique",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"string",name:"cdate",id:5},{rule:"optional",type:"string",name:"initBy",id:6},{rule:"optional",type:"string",name:"sort",id:7},{rule:"optional",type:"int32",name:"limit",id:8},{rule:"optional",type:"int32",name:"skip",id:9},{rule:"optional",type:"int32",name:"flag",id:10},{rule:"optional",type:"int32",name:"count",id:11},{rule:"optional",type:"string",name:"udate",id:12},{rule:"optional",type:"int64",name:"t",id:13},{rule:"optional",type:"string",name:"n",id:14},{rule:"optional",type:"string",name:"s",id:15},{rule:"optional",type:"bool",name:"statusSub",id:16},{rule:"optional",type:"bool",name:"statusPub",id:17},{rule:"optional",type:"int32",name:"statusTTL",id:18},{rule:"optional",type:"string",name:"uniqueId",id:19},{rule:"optional",type:"string",name:"targetClientId",id:20},{rule:"optional",type:"int64",name:"maxReadTimestamp",id:21},{rule:"optional",type:"int64",name:"maxAckTimestamp",id:22},{rule:"optional",type:"bool",name:"queryAllMembers",id:23},{rule:"repeated",type:"MaxReadTuple",name:"maxReadTuples",id:24},{rule:"repeated",type:"string",name:"cids",id:25},{rule:"optional",type:"JsonObjectMessage",name:"results",id:100},{rule:"optional",type:"JsonObjectMessage",name:"where",id:101},{rule:"optional",type:"JsonObjectMessage",name:"attr",id:103}]},{name:"RoomCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"s",id:2},{rule:"optional",type:"int64",name:"t",id:3},{rule:"optional",type:"string",name:"n",id:4},{rule:"optional",type:"bool",name:"transient",id:5},{rule:"repeated",type:"string",name:"roomPeerIds",id:6},{rule:"optional",type:"string",name:"byPeerId",id:7}]},{name:"LogsCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"optional",type:"int32",name:"l",id:2},{rule:"optional",type:"int32",name:"limit",id:3},{rule:"optional",type:"int64",name:"t",id:4},{rule:"optional",type:"int64",name:"tt",id:5},{rule:"optional",type:"string",name:"tmid",id:6},{rule:"optional",type:"string",name:"mid",id:7},{rule:"optional",type:"string",name:"checksum",id:8},{rule:"optional",type:"bool",name:"stored",id:9},{rule:"optional",type:"bool",name:"reversed",id:10},{rule:"repeated",type:"LogItem",name:"logs",id:105}]},{name:"RcpCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"id",id:1},{rule:"optional",type:"string",name:"cid",id:2},{rule:"optional",type:"int64",name:"t",id:3},{rule:"optional",type:"bool",name:"read",id:4}]},{name:"ReadTuple",syntax:"proto2",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"optional",type:"int64",name:"timestamp",id:2},{rule:"optional",type:"string",name:"mid",id:3}]},{name:"MaxReadTuple",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"pid",id:1},{rule:"optional",type:"int64",name:"maxAckTimestamp",id:2},{rule:"optional",type:"int64",name:"maxReadTimestamp",id:3}]},{name:"ReadCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"repeated",type:"string",name:"cids",id:2},{rule:"repeated",type:"ReadTuple",name:"convs",id:3}]},{name:"PresenceCommand",syntax:"proto2",fields:[{rule:"optional",type:"StatusType",name:"status",id:1},{rule:"repeated",type:"string",name:"sessionPeerIds",id:2},{rule:"optional",type:"string",name:"cid",id:3}]},{name:"ReportCommand",syntax:"proto2",fields:[{rule:"optional",type:"bool",name:"initiative",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"string",name:"data",id:3}]},{name:"PatchItem",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"optional",type:"string",name:"mid",id:2},{rule:"optional",type:"int64",name:"timestamp",id:3},{rule:"optional",type:"bool",name:"recall",id:4},{rule:"optional",type:"string",name:"data",id:5},{rule:"optional",type:"int64",name:"patchTimestamp",id:6},{rule:"optional",type:"string",name:"from",id:7}]},{name:"PatchCommand",syntax:"proto2",fields:[{rule:"repeated",type:"PatchItem",name:"patches",id:1},{rule:"optional",type:"int64",name:"lastPatchTime",id:2}]},{name:"GenericCommand",syntax:"proto2",fields:[{rule:"optional",type:"CommandType",name:"cmd",id:1},{rule:"optional",type:"OpType",name:"op",id:2},{rule:"optional",type:"string",name:"appId",id:3},{rule:"optional",type:"string",name:"peerId",id:4},{rule:"optional",type:"int32",name:"i",id:5},{rule:"optional",type:"string",name:"installationId",id:6},{rule:"optional",type:"int32",name:"priority",id:7},{rule:"optional",type:"int32",name:"service",id:8},{rule:"optional",type:"DataCommand",name:"dataMessage",id:101},{rule:"optional",type:"SessionCommand",name:"sessionMessage",id:102},{rule:"optional",type:"ErrorCommand",name:"errorMessage",id:103},{rule:"optional",type:"DirectCommand",name:"directMessage",id:104},{rule:"optional",type:"AckCommand",name:"ackMessage",id:105},{rule:"optional",type:"UnreadCommand",name:"unreadMessage",id:106},{rule:"optional",type:"ReadCommand",name:"readMessage",id:107},{rule:"optional",type:"RcpCommand",name:"rcpMessage",id:108},{rule:"optional",type:"LogsCommand",name:"logsMessage",id:109},{rule:"optional",type:"ConvCommand",name:"convMessage",id:110},{rule:"optional",type:"RoomCommand",name:"roomMessage",id:111},{rule:"optional",type:"PresenceCommand",name:"presenceMessage",id:112},{rule:"optional",type:"ReportCommand",name:"reportMessage",id:113},{rule:"optional",type:"PatchCommand",name:"patchMessage",id:114}]}],enums:[{name:"CommandType",syntax:"proto2",values:[{name:"session",id:0},{name:"conv",id:1},{name:"direct",id:2},{name:"ack",id:3},{name:"rcp",id:4},{name:"unread",id:5},{name:"logs",id:6},{name:"error",id:7},{name:"login",id:8},{name:"data",id:9},{name:"room",id:10},{name:"read",id:11},{name:"presence",id:12},{name:"report",id:13},{name:"echo",id:14},{name:"loggedin",id:15},{name:"logout",id:16},{name:"loggedout",id:17},{name:"patch",id:18}]},{name:"OpType",syntax:"proto2",values:[{name:"open",id:1},{name:"add",id:2},{name:"remove",id:3},{name:"close",id:4},{name:"opened",id:5},{name:"closed",id:6},{name:"query",id:7},{name:"query_result",id:8},{name:"conflict",id:9},{name:"added",id:10},{name:"removed",id:11},{name:"start",id:30},{name:"started",id:31},{name:"joined",id:32},{name:"members_joined",id:33},{name:"left",id:39},{name:"members_left",id:40},{name:"results",id:42},{name:"count",id:43},{name:"result",id:44},{name:"update",id:45},{name:"updated",id:46},{name:"mute",id:47},{name:"unmute",id:48},{name:"status",id:49},{name:"members",id:50},{name:"max_read",id:51},{name:"is_member",id:52},{name:"join",id:80},{name:"invite",id:81},{name:"leave",id:82},{name:"kick",id:83},{name:"reject",id:84},{name:"invited",id:85},{name:"kicked",id:86},{name:"upload",id:100},{name:"uploaded",id:101},{name:"modify",id:150},{name:"modified",id:151}]},{name:"StatusType",syntax:"proto2",values:[{name:"on",id:1},{name:"off",id:2}]}],isNamespace:!0}).build(),Og=Ng.push_server.messages2,Pg=Og.JsonObjectMessage,Qg=Og.UnreadTuple,Rg=Og.LogItem,Sg=Og.DataCommand,Tg=Og.SessionCommand,Ug=Og.ErrorCommand,Vg=Og.DirectCommand,Wg=Og.AckCommand,Xg=Og.UnreadCommand,Yg=Og.ConvCommand,Zg=Og.RoomCommand,$g=Og.LogsCommand,_g=Og.RcpCommand,ah=Og.ReadTuple,bh=Og.MaxReadTuple,ch=Og.ReadCommand,dh=Og.PresenceCommand,eh=Og.ReportCommand,fh=Og.GenericCommand,gh=Og.PatchCommand,hh=Og.PatchItem,ih=Og.CommandType,jh=Og.OpType,kh=Og.StatusType,lh=Object.freeze({JsonObjectMessage:Pg,UnreadTuple:Qg,LogItem:Rg,DataCommand:Sg,SessionCommand:Tg,ErrorCommand:Ug,DirectCommand:Vg,AckCommand:Wg,UnreadCommand:Xg,ConvCommand:Yg,RoomCommand:Zg,LogsCommand:$g,RcpCommand:_g,ReadTuple:ah,MaxReadTuple:bh,ReadCommand:ch,PresenceCommand:dh,ReportCommand:eh,GenericCommand:fh,PatchCommand:gh,PatchItem:hh,CommandType:ih,OpType:jh,StatusType:kh}),mh=d(function(a){function b(){}function c(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function d(){this._events=new b,this._eventsCount=0}var e=Object.prototype.hasOwnProperty,f="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(f=!1)),d.prototype.eventNames=function(){var a,b,c=[];if(0===this._eventsCount)return c;for(b in a=this._events)e.call(a,b)&&c.push(f?b.slice(1):b);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(a)):c},d.prototype.listeners=function(a,b){var c=f?f+a:a,d=this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var e=0,g=d.length,h=new Array(g);e<g;e++)h[e]=d[e].fn;return h},d.prototype.emit=function(a,b,c,d,e,g){var h=f?f+a:a;if(!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if(k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,e),!0;case 6:return k.fn.call(k.context,b,c,d,e,g),!0}for(j=1,i=new Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;case 4:k[j].fn.call(k[j].context,b,c,d);break;default:if(!i)for(m=1,i=new Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},d.prototype.on=function(a,b,d){var e=new c(b,d||this),g=f?f+a:a;return this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):(this._events[g]=e,this._eventsCount++),this},d.prototype.once=function(a,b,d){var e=new c(b,d||this,!0),g=f?f+a:a;return this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):(this._events[g]=e,this._eventsCount++),this},d.prototype.removeListener=function(a,c,d,e){var g=f?f+a:a;if(!this._events[g])return this;if(!c)return 0==--this._eventsCount?this._events=new b:delete this._events[g],this;var h=this._events[g];if(h.fn)h.fn!==c||e&&!h.once||d&&h.context!==d||(0==--this._eventsCount?this._events=new b:delete this._events[g]);else{for(var i=0,j=[],k=h.length;i<k;i++)(h[i].fn!==c||e&&!h[i].once||d&&h[i].context!==d)&&j.push(h[i]);j.length?this._events[g]=1===j.length?j[0]:j:0==--this._eventsCount?this._events=new b:delete this._events[g]}return this},d.prototype.removeAllListeners=function(a){var c;return a?(c=f?f+a:a,this._events[c]&&(0==--this._eventsCount?this._events=new b:delete this._events[c])):(this._events=new b,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=f,d.EventEmitter=d,a.exports=d}),nh=d(function(a){!function(b){function c(a,b,c,d){var f=b&&b.prototype instanceof e?b:e,g=Object.create(f.prototype),h=new n(d||[]);return g._invoke=j(a,c,h),g}function d(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}function e(){}function f(){}function g(){}function h(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function i(a){function b(c,e,f,g){var h=d(a[c],a,e);if("throw"!==h.type){var i=h.arg,j=i.value;return j&&"object"==typeof j&&s.call(j,"__await")?Promise.resolve(j.__await).then(function(a){b("next",a,f,g)},function(a){b("throw",a,f,g)}):Promise.resolve(j).then(function(a){i.value=a,f(i)},g)}g(h.arg)}function c(a,c){function d(){return new Promise(function(d,e){b(a,c,d,e)})}return e=e?e.then(d,d):d()}var e;this._invoke=c}function j(a,b,c){var e=y;return function(f,g){if(e===A)throw new Error("Generator is already running");if(e===B){if("throw"===f)throw g;return p()}for(c.method=f,c.arg=g;;){var h=c.delegate;if(h){var i=k(h,c);if(i){if(i===C)continue;return i}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(e===y)throw e=B,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);e=A;var j=d(a,b,c);if("normal"===j.type){if(e=c.done?B:z,j.arg===C)continue;return{value:j.arg,done:c.done}}"throw"===j.type&&(e=B,c.method="throw",c.arg=j.arg)}}}function k(a,b){var c=a.iterator[b.method];if(c===q){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=q,k(a,b),"throw"===b.method))return C;b.method="throw",b.arg=new TypeError("The iterator does not provide a 'throw' method")}return C}var e=d(c,a.iterator,b.arg);if("throw"===e.type)return b.method="throw",b.arg=e.arg,b.delegate=null,C;var f=e.arg;return f?f.done?(b[a.resultName]=f.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=q),b.delegate=null,C):f:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,C)}function l(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function m(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function n(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(l,this),this.reset(!0)}function o(a){if(a){var b=a[u];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function b(){for(;++c<a.length;)if(s.call(a,c))return b.value=a[c],b.done=!1,b;return b.value=q,b.done=!0,b};return d.next=d}}return{next:p}}function p(){return{value:q,done:!0}}var q,r=Object.prototype,s=r.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},u=t.iterator||"@@iterator",v=t.asyncIterator||"@@asyncIterator",w=t.toStringTag||"@@toStringTag",x=b.regeneratorRuntime;if(x)return void(a.exports=x);x=b.regeneratorRuntime=a.exports,x.wrap=c;var y="suspendedStart",z="suspendedYield",A="executing",B="completed",C={},D={};D[u]=function(){return this};var E=Object.getPrototypeOf,F=E&&E(E(o([])));F&&F!==r&&s.call(F,u)&&(D=F);var G=g.prototype=e.prototype=Object.create(D);f.prototype=G.constructor=g,g.constructor=f,g[w]=f.displayName="GeneratorFunction",x.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===f||"GeneratorFunction"===(b.displayName||b.name))},x.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,g):(a.__proto__=g,w in a||(a[w]="GeneratorFunction")),a.prototype=Object.create(G),a},x.awrap=function(a){return{__await:a}},h(i.prototype),i.prototype[v]=function(){return this},x.AsyncIterator=i,x.async=function(a,b,d,e){var f=new i(c(a,b,d,e));return x.isGeneratorFunction(b)?f:f.next().then(function(a){return a.done?a.value:f.next()})},h(G),G[w]="Generator",G[u]=function(){return this},G.toString=function(){return"[object Generator]"},x.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function c(){for(;b.length;){var d=b.pop();if(d in a)return c.value=d,c.done=!1,c}return c.done=!0,c}},x.values=o,n.prototype={constructor:n,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=q,this.done=!1,this.delegate=null,this.method="next",this.arg=q,this.tryEntries.forEach(m),!a)for(var b in this)"t"===b.charAt(0)&&s.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=q)},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,d&&(c.method="next",c.arg=q),!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=s.call(e,"catchLoc"),h=s.call(e,"finallyLoc");if(g&&h){
if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&s.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?(this.method="next",this.next=e.finallyLoc,C):this.complete(f)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),C},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),m(c),C}},catch:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;m(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:o(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=q),C}}}(function(){return this}()||Function("return this")())}),oh=function(){return this}()||Function("return this")(),ph=oh.regeneratorRuntime&&Object.getOwnPropertyNames(oh).indexOf("regeneratorRuntime")>=0,qh=ph&&oh.regeneratorRuntime;oh.regeneratorRuntime=void 0;var rh=nh;if(ph)oh.regeneratorRuntime=qh;else try{delete oh.regeneratorRuntime}catch(a){oh.regeneratorRuntime=void 0}var sh=rh,th=Object.assign,uh=!th||Rb(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=th({},a)[c]||Object.keys(th({},b)).join("")!=d})?function(a,b){for(var c=Pc(a),d=arguments.length,e=1,f=ye.f,g=Ae.f;d>e;)for(var h,i=jc(arguments[e++]),j=f?Bc(i).concat(f(i)):Bc(i),k=j.length,l=0;k>l;)g.call(i,h=j[l++])&&(c[h]=i[h]);return c}:th;cc(cc.S+cc.F,"Object",{assign:uh});var vh=Mb.Object.assign,wh=d(function(a){a.exports={default:vh,__esModule:!0}}),xh=c(wh),yh=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(wh);b.default=c.default||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}}),zh=c(yh),Ah=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(oe);b.default=function(a){return function(){var b=a.apply(this,arguments);return new c.default(function(a,d){function e(f,g){try{var h=b[f](g),i=h.value}catch(a){return void d(a)}if(!h.done)return c.default.resolve(i).then(function(a){e("next",a)},function(a){e("throw",a)});a(i)}return e("next")})}}}),Bh=c(Ah),Ch=function(a,b,c){b in a?$b.f(a,b,_b(0,c)):a[b]=c};cc(cc.S+cc.F*!Yd(function(a){Array.from(a)}),"Array",{from:function(a){var b,c,d,e,f=Pc(a),g="function"==typeof this?this:Array,h=arguments.length,i=h>1?arguments[1]:void 0,j=void 0!==i,k=0,l=qd(f);if(j&&(i=Ob(i,h>2?arguments[2]:void 0,2)),void 0==l||g==Array&&od(l))for(b=mc(f.length),c=new g(b);b>k;k++)Ch(c,k,j?i(f[k],k):f[k]);else for(e=l.call(f),c=new g;!(d=e.next()).done;k++)Ch(c,k,j?ld(e,i,[d.value,k],!0):d.value);return c.length=k,c}});var Dh=Mb.Array.from,Eh=d(function(a){a.exports={default:Dh,__esModule:!0}}),Fh=c(Eh),Gh=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(Eh);b.default=function(a){if(Array.isArray(a)){for(var b=0,d=Array(a.length);b<a.length;b++)d[b]=a[b];return d}return(0,c.default)(a)}}),Hh=c(Gh),Ih=function(a,b){if(!Pb(a)||a._t!==b)throw TypeError("Incompatible receiver, "+b+" required!");return a},Jh=$b.f,Kh=ue.fastKey,Lh=Sb?"_s":"size",Mh=function(a,b){var c,d=Kh(b);if("F"!==d)return a._i[d];for(c=a._f;c;c=c.n)if(c.k==b)return c},Nh={getConstructor:function(a,b,c,d){var e=a(function(a,f){kd(a,e,b,"_i"),a._t=b,a._i=Ic(null),a._f=void 0,a._l=void 0,a[Lh]=0,void 0!=f&&rd(f,c,a[d],a)});return Od(e.prototype,{clear:function(){for(var a=Ih(this,b),c=a._i,d=a._f;d;d=d.n)d.r=!0,d.p&&(d.p=d.p.n=void 0),delete c[d.i];a._f=a._l=void 0,a[Lh]=0},delete:function(a){var c=Ih(this,b),d=Mh(c,a);if(d){var e=d.n,f=d.p;delete c._i[d.i],d.r=!0,f&&(f.n=e),e&&(e.p=f),c._f==d&&(c._f=e),c._l==d&&(c._l=f),c[Lh]--}return!!d},forEach:function(a){Ih(this,b);for(var c,d=Ob(a,arguments.length>1?arguments[1]:void 0,3);c=c?c.n:this._f;)for(d(c.v,c.k,this);c&&c.r;)c=c.p},has:function(a){return!!Mh(Ih(this,b),a)}}),Sb&&Jh(e.prototype,"size",{get:function(){return Ih(this,b)[Lh]}}),e},def:function(a,b,c){var d,e,f=Mh(a,b);return f?f.v=c:(a._l=f={i:e=Kh(b,!0),k:b,v:c,p:d=a._l,n:void 0,r:!1},a._f||(a._f=f),d&&(d.n=f),a[Lh]++,"F"!==e&&(a._i[e]=f)),a},getEntry:Mh,setStrong:function(a,b,c){Wc(a,b,function(a,c){this._t=Ih(a,b),this._k=c,this._l=void 0},function(){for(var a=this,b=a._k,c=a._l;c&&c.r;)c=c.p;return a._t&&(a._l=c=c?c.n:a._t._f)?"keys"==b?Yc(0,c.k):"values"==b?Yc(0,c.v):Yc(0,[c.k,c.v]):(a._t=void 0,Yc(1))},c?"entries":"values",!c,!0),Qd(b)}},Oh=Jc("species"),Ph=function(a){var b;return Ce(a)&&(b=a.constructor,"function"!=typeof b||b!==Array&&!Ce(b.prototype)||(b=void 0),Pb(b)&&null===(b=b[Oh])&&(b=void 0)),void 0===b?Array:b},Qh=function(a,b){return new(Ph(a))(b)},Rh=function(a,b){var c=1==a,d=2==a,e=3==a,f=4==a,g=6==a,h=5==a||g,i=b||Qh;return function(b,j,k){for(var l,m,n=Pc(b),o=jc(n),p=Ob(j,k,3),q=mc(o.length),r=0,s=c?i(b,q):d?i(b,0):void 0;q>r;r++)if((h||r in o)&&(l=o[r],m=p(l,r,n),a))if(c)s[r]=m;else if(m)switch(a){case 3:return!0;case 5:return l;case 6:return r;case 2:s.push(l)}else if(f)return!1;return g?-1:e||f?f:s}},Sh=$b.f,Th=Rh(0),Uh=function(a,b,c,d,e,f){var g=Lb[a],h=g,i=e?"set":"add",j=h&&h.prototype,k={};return Sb&&"function"==typeof h&&(f||j.forEach&&!Rb(function(){(new h).entries().next()}))?(h=b(function(b,c){kd(b,h,a,"_c"),b._c=new g,void 0!=c&&rd(c,e,b[i],b)}),Th("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(a){var b="add"==a||"set"==a;a in j&&(!f||"clear"!=a)&&ac(h.prototype,a,function(c,d){if(kd(this,h,a),!b&&f&&!Pb(c))return"get"==a&&void 0;var e=this._c[a](0===c?0:c,d);return b?this:e})}),f||Sh(h.prototype,"size",{get:function(){return this._c.size}})):(h=d.getConstructor(b,a,e,i),Od(h.prototype,c),ue.NEED=!0),Mc(h,a),k[a]=h,cc(cc.G+cc.W+cc.F,k),f||d.setStrong(h,a,e),h},Vh=(Uh("Set",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return Nh.def(Ih(this,"Set"),a=0===a?0:a,a)}},Nh),function(a,b){var c=[];return rd(a,!1,c.push,c,b),c});cc(cc.P+cc.R,"Set",{toJSON:function(a){return function(){if(jd(this)!=a)throw TypeError(a+"#toJSON isn't generic");return Vh(this)}}("Set")});var Wh=function(a){cc(cc.S,a,{of:function(){for(var a=arguments.length,b=Array(a);a--;)b[a]=arguments[a];return new this(b)}})};Wh("Set");var Xh=function(a){cc(cc.S,a,{from:function(a){var b,c,d,e,f=arguments[1];return Nb(this),b=void 0!==f,b&&Nb(f),void 0==a?new this:(c=[],b?(d=0,e=Ob(f,arguments[2],2),rd(a,!1,function(a){c.push(e(a,d++))})):rd(a,!1,c.push,c),new this(c))}})};Xh("Set");var Yh=Mb.Set,Zh=d(function(a){a.exports={default:Yh,__esModule:!0}}),$h=c(Zh),_h=1e3,ai=60*_h,bi=60*ai,ci=24*bi,di=365.25*ci,ei=function(a,b){b=b||{};var c=typeof a;if("string"===c&&a.length>0)return k(a);if("number"===c&&!1===isNaN(a))return b.long?m(a):l(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},fi=d(function(a,b){function c(a){var c,d=0;for(c in a)d=(d<<5)-d+a.charCodeAt(c),d|=0;return b.colors[Math.abs(d)%b.colors.length]}function d(a){function d(){if(d.enabled){var a=d,c=+new Date,e=c-(i||c);a.diff=e,a.prev=i,a.curr=c,i=c;for(var f=new Array(arguments.length),g=0;g<f.length;g++)f[g]=arguments[g];f[0]=b.coerce(f[0]),"string"!=typeof f[0]&&f.unshift("%O");var h=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,function(c,d){if("%%"===c)return c;h++;var e=b.formatters[d];if("function"==typeof e){var g=f[h];c=e.call(a,g),f.splice(h,1),h--}return c}),b.formatArgs.call(a,f);(d.log||b.log||console.log.bind(console)).apply(a,f)}}return d.namespace=a,d.enabled=b.enabled(a),d.useColors=b.useColors(),d.color=c(a),"function"==typeof b.init&&b.init(d),d}function e(a){b.save(a),b.names=[],b.skips=[];for(var c=("string"==typeof a?a:"").split(/[\s,]+/),d=c.length,e=0;e<d;e++)c[e]&&(a=c[e].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))}function f(){b.enable("")}function g(a){var c,d;for(c=0,d=b.skips.length;c<d;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;c<d;c++)if(b.names[c].test(a))return!0;return!1}function h(a){return a instanceof Error?a.stack||a.message:a}b=a.exports=d.debug=d.default=d,b.coerce=h,b.disable=f,b.enable=e,b.enabled=g,b.humanize=ei,b.names=[],b.skips=[],b.formatters={};var i}),gi=d(function(a,b){function c(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function d(a){var c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff),c){var d="color: "+this.color;a.splice(1,0,d,"color: inherit");var e=0,f=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d)}}function e(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function f(a){try{null==a?b.storage.removeItem("debug"):b.storage.debug=a}catch(a){}}function g(){var a;try{a=b.storage.debug}catch(a){}return!a&&void 0!==Fb&&"env"in Fb&&(a=Fb.env.DEBUG),a}b=a.exports=fi,b.log=e,b.formatArgs=d,b.save=f,b.load=g,b.useColors=c,b.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(a){}}(),b.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],b.formatters.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}},b.enable(g())}),hi=function(a,b){return function(){for(var c=new Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];return a.apply(b,c)}},ii=function(a){return null!=a&&(o(a)||p(a)||!!a._isBuffer)},ji=Object.prototype.toString,ki={isArray:q,isArrayBuffer:r,isBuffer:ii,isFormData:s,isArrayBufferView:t,isString:u,isNumber:v,isObject:x,isUndefined:w,isDate:y,isFile:z,isBlob:A,isFunction:B,isStream:C,isURLSearchParams:D,isStandardBrowserEnv:F,forEach:G,merge:H,extend:I,trim:E},li=function(a,b){ki.forEach(a,function(c,d){d!==b&&d.toUpperCase()===b.toUpperCase()&&(a[b]=c,delete a[d])})},mi=function(a,b,c,d,e){return a.config=b,c&&(a.code=c),a.request=d,a.response=e,a},ni=function(a,b,c,d,e){var f=new Error(a);return mi(f,b,c,d,e)},oi=function(a,b,c){var d=c.config.validateStatus;c.status&&d&&!d(c.status)?b(ni("Request failed with status code "+c.status,c.config,null,c.request,c)):a(c)},pi=function(a,b,c){if(!b)return a;var d;if(c)d=c(b);else if(ki.isURLSearchParams(b))d=b.toString();else{var e=[];ki.forEach(b,function(a,b){null!==a&&void 0!==a&&(ki.isArray(a)&&(b+="[]"),ki.isArray(a)||(a=[a]),ki.forEach(a,function(a){ki.isDate(a)?a=a.toISOString():ki.isObject(a)&&(a=Wf(a)),e.push(J(b)+"="+J(a))}))}),d=e.join("&")}return d&&(a+=(-1===a.indexOf("?")?"?":"&")+d),a},qi=function(a){var b,c,d,e={};return a?(ki.forEach(a.split("\n"),function(a){d=a.indexOf(":"),b=ki.trim(a.substr(0,d)).toLowerCase(),c=ki.trim(a.substr(d+1)),b&&(e[b]=e[b]?e[b]+", "+c:c)}),e):e},ri=ki.isStandardBrowserEnv()?function(){function a(a){var b=a;return c&&(d.setAttribute("href",b),b=d.href),d.setAttribute("href",b),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:"/"===d.pathname.charAt(0)?d.pathname:"/"+d.pathname}}var b,c=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a");return b=a(window.location.href),function(c){var d=ki.isString(c)?a(c):c;return d.protocol===b.protocol&&d.host===b.host}}():function(){return function(){return!0}}(),si="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";K.prototype=new Error,K.prototype.code=5,K.prototype.name="InvalidCharacterError";var ti=L,ui=ki.isStandardBrowserEnv()?function(){return{write:function(a,b,c,d,e,f){var g=[];g.push(a+"="+encodeURIComponent(b)),ki.isNumber(c)&&g.push("expires="+new Date(c).toGMTString()),ki.isString(d)&&g.push("path="+d),ki.isString(e)&&g.push("domain="+e),!0===f&&g.push("secure"),document.cookie=g.join("; ")},read:function(a){var b=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return b?decodeURIComponent(b[3]):null},remove:function(a){this.write(a,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),vi="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||ti,wi=function(a){return new pe(function(b,c){var d=a.data,e=a.headers;ki.isFormData(d)&&delete e["Content-Type"];var f=new XMLHttpRequest,g="onreadystatechange",h=!1;if("test"===Fb.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in f||ri(a.url)||(f=new window.XDomainRequest,g="onload",h=!0,f.onprogress=function(){},f.ontimeout=function(){}),a.auth){var i=a.auth.username||"",j=a.auth.password||"";e.Authorization="Basic "+vi(i+":"+j)}if(f.open(a.method.toUpperCase(),pi(a.url,a.params,a.paramsSerializer),!0),f.timeout=a.timeout,f[g]=function(){if(f&&(4===f.readyState||h)&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var d="getAllResponseHeaders"in f?qi(f.getAllResponseHeaders()):null,e=a.responseType&&"text"!==a.responseType?f.response:f.responseText,g={data:e,status:1223===f.status?204:f.status,statusText:1223===f.status?"No Content":f.statusText,headers:d,config:a,request:f};oi(b,c,g),f=null}},f.onerror=function(){c(ni("Network Error",a,null,f)),f=null},f.ontimeout=function(){c(ni("timeout of "+a.timeout+"ms exceeded",a,"ECONNABORTED",f)),f=null},ki.isStandardBrowserEnv()){var k=ui,l=(a.withCredentials||ri(a.url))&&a.xsrfCookieName?k.read(a.xsrfCookieName):void 0;l&&(e[a.xsrfHeaderName]=l)}if("setRequestHeader"in f&&ki.forEach(e,function(a,b){void 0===d&&"content-type"===b.toLowerCase()?delete e[b]:f.setRequestHeader(b,a)}),a.withCredentials&&(f.withCredentials=!0),a.responseType)try{f.responseType=a.responseType}catch(b){if("json"!==a.responseType)throw b}"function"==typeof a.onDownloadProgress&&f.addEventListener("progress",a.onDownloadProgress),"function"==typeof a.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",a.onUploadProgress),a.cancelToken&&a.cancelToken.promise.then(function(a){f&&(f.abort(),c(a),f=null)}),void 0===d&&(d=null),f.send(d)})},xi={"Content-Type":"application/x-www-form-urlencoded"},yi={adapter:function(){var a;return"undefined"!=typeof XMLHttpRequest?a=wi:void 0!==Fb&&(a=wi),a}(),transformRequest:[function(a,b){return li(b,"Content-Type"),ki.isFormData(a)||ki.isArrayBuffer(a)||ki.isBuffer(a)||ki.isStream(a)||ki.isFile(a)||ki.isBlob(a)?a:ki.isArrayBufferView(a)?a.buffer:ki.isURLSearchParams(a)?(M(b,"application/x-www-form-urlencoded;charset=utf-8"),a.toString()):ki.isObject(a)?(M(b,"application/json;charset=utf-8"),Wf(a)):a}],transformResponse:[function(a){if("string"==typeof a)try{a=JSON.parse(a)}catch(a){}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(a){return a>=200&&a<300}};yi.headers={common:{Accept:"application/json, text/plain, */*"}},ki.forEach(["delete","get","head"],function(a){yi.headers[a]={}}),ki.forEach(["post","put","patch"],function(a){yi.headers[a]=ki.merge(xi)});var zi=yi;N.prototype.use=function(a,b){return this.handlers.push({fulfilled:a,rejected:b}),this.handlers.length-1},N.prototype.eject=function(a){this.handlers[a]&&(this.handlers[a]=null)},N.prototype.forEach=function(a){ki.forEach(this.handlers,function(b){null!==b&&a(b)})};var Ai=N,Bi=function(a,b,c){return ki.forEach(c,function(c){a=c(a,b)}),a},Ci=function(a){return!(!a||!a.__CANCEL__)},Di=function(a){return O(a),a.headers=a.headers||{},a.data=Bi(a.data,a.headers,a.transformRequest),a.headers=ki.merge(a.headers.common||{},a.headers[a.method]||{},a.headers||{}),ki.forEach(["delete","get","head","post","put","patch","common"],function(b){delete a.headers[b]}),(a.adapter||zi.adapter)(a).then(function(b){return O(a),b.data=Bi(b.data,b.headers,a.transformResponse),b},function(b){return Ci(b)||(O(a),b&&b.response&&(b.response.data=Bi(b.response.data,b.response.headers,a.transformResponse))),pe.reject(b)})},Ei=function(a){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(a)},Fi=function(a,b){return b?a.replace(/\/+$/,"")+"/"+b.replace(/^\/+/,""):a};P.prototype.request=function(a){"string"==typeof a&&(a=ki.merge({url:arguments[0]},arguments[1])),a=ki.merge(zi,this.defaults,{method:"get"},a),a.method=a.method.toLowerCase(),a.baseURL&&!Ei(a.url)&&(a.url=Fi(a.baseURL,a.url));var b=[Di,void 0],c=pe.resolve(a);for(this.interceptors.request.forEach(function(a){b.unshift(a.fulfilled,a.rejected)}),this.interceptors.response.forEach(function(a){b.push(a.fulfilled,a.rejected)});b.length;)c=c.then(b.shift(),b.shift());return c},ki.forEach(["delete","get","head","options"],function(a){P.prototype[a]=function(b,c){return this.request(ki.merge(c||{},{method:a,url:b}))}}),ki.forEach(["post","put","patch"],function(a){P.prototype[a]=function(b,c,d){return this.request(ki.merge(d||{},{method:a,url:b,data:c}))}});var Gi=P;Q.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Q.prototype.__CANCEL__=!0;var Hi=Q;R.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},R.source=function(){var a;return{token:new R(function(b){a=b}),cancel:a}};var Ii=R,Ji=function(a){return function(b){return a.apply(null,b)}},Ki=S(zi);Ki.Axios=Gi,Ki.create=function(a){return S(ki.merge(zi,a))},Ki.Cancel=Hi,Ki.CancelToken=Ii,Ki.isCancel=Ci,Ki.all=function(a){return pe.all(a)},Ki.spread=Ji;var Li=Ki,Mi=Ki;Li.default=Mi;var Ni=Li,Oi=function(a,b){var c=(Mb.Object||{})[a]||Object[a],d={};d[a]=b(c),cc(cc.S+cc.F*Rb(function(){c(1)}),"Object",d)},Pi=Oe.f;Oi("getOwnPropertyDescriptor",function(){return function(a,b){return Pi(kc(a),b)}});var Qi=Mb.Object,Ri=function(a,b){return Qi.getOwnPropertyDescriptor(a,b)},Si=d(function(a){a.exports={default:Ri,__esModule:!0}}),Ti=c(Si),Ui=d(function(a,b){!function(){var c={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(a,b){var d="string"==typeof a.initial?{state:a.initial}:a.initial,e=a.terminal||a.final,f=b||a.target||{},g=a.events||[],h=a.callbacks||{},i={},j={},k=function(a){var b=Array.isArray(a.from)?a.from:a.from?[a.from]:[c.WILDCARD];i[a.name]=i[a.name]||{};for(var d=0;d<b.length;d++)j[b[d]]=j[b[d]]||[],j[b[d]].push(a.name),i[a.name][b[d]]=a.to||b[d];a.to&&(j[a.to]=j[a.to]||[])};d&&(d.event=d.event||"startup",k({name:d.event,from:"none",to:d.state}));for(var l=0;l<g.length;l++)k(g[l]);for(var m in i)i.hasOwnProperty(m)&&(f[m]=c.buildEvent(m,i[m]));for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m]);return f.current="none",f.is=function(a){return Array.isArray(a)?a.indexOf(this.current)>=0:this.current===a},f.can=function(a){return!this.transition&&void 0!==i[a]&&(i[a].hasOwnProperty(this.current)||i[a].hasOwnProperty(c.WILDCARD))},f.cannot=function(a){return!this.can(a)},f.transitions=function(){return(j[this.current]||[]).concat(j[c.WILDCARD]||[])},f.isFinished=function(){return this.is(e)},f.error=a.error||function(a,b,c,d,e,f,g){throw g||f},f.states=function(){return Object.keys(j).sort()},d&&!d.defer&&f[d.event](),f},doCallback:function(a,b,d,e,f,g){if(b)try{return b.apply(a,[d,e,f].concat(g))}catch(b){return a.error(d,e,f,g,c.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",b)}},beforeAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onbeforeevent,b,d,e,f)},afterAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onafterevent||a.onevent,b,d,e,f)},leaveAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onleavestate,b,d,e,f)},enterAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onenterstate||a.onstate,b,d,e,f)},changeState:function(a,b,d,e,f){return c.doCallback(a,a.onchangestate,b,d,e,f)},beforeThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onbefore"+b],b,d,e,f)},afterThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onafter"+b]||a["on"+b],b,d,e,f)},leaveThisState:function(a,b,d,e,f){return c.doCallback(a,a["onleave"+d],b,d,e,f)},enterThisState:function(a,b,d,e,f){return c.doCallback(a,a["onenter"+e]||a["on"+e],b,d,e,f)},beforeEvent:function(a,b,d,e,f){if(!1===c.beforeThisEvent(a,b,d,e,f)||!1===c.beforeAnyEvent(a,b,d,e,f))return!1},afterEvent:function(a,b,d,e,f){c.afterThisEvent(a,b,d,e,f),c.afterAnyEvent(a,b,d,e,f)},leaveState:function(a,b,d,e,f){var g=c.leaveThisState(a,b,d,e,f),h=c.leaveAnyState(a,b,d,e,f);return!1!==g&&!1!==h&&(c.ASYNC===g||c.ASYNC===h?c.ASYNC:void 0)},enterState:function(a,b,d,e,f){c.enterThisState(a,b,d,e,f),c.enterAnyState(a,b,d,e,f)},buildEvent:function(a,b){return function(){var d=this.current,e=b[d]||(b[c.WILDCARD]!=c.WILDCARD?b[c.WILDCARD]:d)||d,f=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,d,e,f,c.Error.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,d,e,f,c.Error.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+this.current);if(!1===c.beforeEvent(this,a,d,e,f))return c.Result.CANCELLED;if(d===e)return c.afterEvent(this,a,d,e,f),c.Result.NOTRANSITION;var g=this;this.transition=function(){return g.transition=null,g.current=e,c.enterState(g,a,d,e,f),c.changeState(g,a,d,e,f),c.afterEvent(g,a,d,e,f),c.Result.SUCCEEDED},this.transition.cancel=function(){g.transition=null,c.afterEvent(g,a,d,e,f)};var h=c.leaveState(this,a,d,e,f);return!1===h?(this.transition=null,c.Result.CANCELLED):c.ASYNC===h?c.Result.PENDING:this.transition?this.transition():void 0}}};a.exports&&(b=a.exports=c),b.StateMachine=c}()}),Vi=ue.getWeak,Wi=Rh(5),Xi=Rh(6),Yi=0,Zi=function(a){return a._l||(a._l=new $i)},$i=function(){this.a=[]},_i=function(a,b){return Wi(a.a,function(a){return a[0]===b})};$i.prototype={get:function(a){var b=_i(this,a);if(b)return b[1]},has:function(a){return!!_i(this,a)},set:function(a,b){var c=_i(this,a);c?c[1]=b:this.a.push([a,b])},delete:function(a){var b=Xi(this.a,function(b){return b[0]===a});return~b&&this.a.splice(b,1),!!~b}};var aj={getConstructor:function(a,b,c,d){var e=a(function(a,f){kd(a,e,b,"_i"),a._t=b,a._i=Yi++,a._l=void 0,void 0!=f&&rd(f,c,a[d],a)});return Od(e.prototype,{delete:function(a){if(!Pb(a))return!1;var c=Vi(a);return!0===c?Zi(Ih(this,b)).delete(a):c&&fc(c,this._i)&&delete c[this._i]},has:function(a){if(!Pb(a))return!1;var c=Vi(a);return!0===c?Zi(Ih(this,b)).has(a):c&&fc(c,this._i)}}),e},def:function(a,b,c){var d=Vi(Qb(b),!0);return!0===d?Zi(a).set(b,c):d[a._i]=c,a},ufstore:Zi};d(function(a){var b,c=Rh(0),d=ue.getWeak,e=Object.isExtensible,f=aj.ufstore,g={},h=function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},i={get:function(a){if(Pb(a)){var b=d(a);return!0===b?f(Ih(this,"WeakMap")).get(a):b?b[this._i]:void 0}},set:function(a,b){return aj.def(Ih(this,"WeakMap"),a,b)}},j=a.exports=Uh("WeakMap",h,i,aj,!0,!0);Rb(function(){return 7!=(new j).set((Object.freeze||Object)(g),7).get(g)})&&(b=aj.getConstructor(h,"WeakMap"),uh(b.prototype,i),ue.NEED=!0,c(["delete","has","get","set"],function(a){var c=j.prototype,d=c[a];dc(c,a,function(c,f){if(Pb(c)&&!e(c)){this._f||(this._f=new b);var g=this._f[a](c,f);return"set"==a?this:g}return d.call(this,c,f)})}))});Wh("WeakMap"),Xh("WeakMap");var bj=Mb.WeakMap,cj=d(function(a){a.exports={default:bj,__esModule:!0}}),dj=c(cj);Oi("keys",function(){return function(a){return Bc(Pc(a))}});var ej=Mb.Object.keys,fj=d(function(a){a.exports={default:ej,__esModule:!0}}),gj=c(fj),hj="object"==typeof Gb&&Gb&&Gb.Object===Object&&Gb,ij=hj,jj="object"==typeof self&&self&&self.Object===Object&&self,kj=ij||jj||Function("return this")(),lj=kj,mj=lj.Symbol,nj=mj,oj=Object.prototype,pj=oj.hasOwnProperty,qj=oj.toString,rj=nj?nj.toStringTag:void 0,sj=T,tj=Object.prototype,uj=tj.toString,vj=U,wj="[object Null]",xj="[object Undefined]",yj=nj?nj.toStringTag:void 0,zj=V,Aj=W,Bj=Aj(Object.getPrototypeOf,Object),Cj=Bj,Dj=X,Ej="[object Object]",Fj=Function.prototype,Gj=Object.prototype,Hj=Fj.toString,Ij=Gj.hasOwnProperty,Jj=Hj.call(Object),Kj=Y,Lj="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},Mj=vf("expired"),Nj=gi("LC:Expirable"),Oj=function(){function a(b,c){zf(this,a),this._value=b,"number"==typeof c&&(this.expiredAt=Date.now()+c)}return wg(a,[{key:"value",get:function(){var a=this.expiredAt&&this.expiredAt<Date.now();return a&&Nj("expired: "+this._value),a?Mj:this._value}}]),a}();Oj.EXPIRED=Mj;var Pj,Qj=gi("LC:Cache"),Rj=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"anonymous";zf(this,a),this.name=b,this._map={}}return a.prototype.get=function(a){var b=this._map[a];if(b){var c=b.value;if(c!==Oj.EXPIRED)return Qj("[%s] hit: %s %O",this.name,a,c),c;delete this._map[a]}return Qj("["+this.name+"] missed: "+a),null},a.prototype.set=function(a,b,c){Qj("[%s] set: %s %O %d",this.name,a,b,c),this._map[a]=new Oj(b,c)},a}(),Sj=function a(b){var c=new pe(b[0]);return 1===b.length?c:c.catch(function(){return a(b.slice(1))})},Tj=function(a){return function(b){return a(b),b}},Uj=function(a){return a?"string"==typeof a?new Date(a):"Date"===a.__type&&a.iso?new Date(a.iso):"function"==typeof a.toNumber?new Date(a.toNumber()):a:a},Vj=function(a,b){return gj(b).reduce(function(c,d){var e=a[d]||d;return xh(c,Hf({},e,b[d]))},{})},Wj=Lj.navigator&&Lj.navigator.userAgent&&-1!==Lj.navigator.userAgent.indexOf("MSIE 10."),Xj=function a(b,c){return b[c]||(b.__proto__?a(b.__proto__,c):void 0)},Yj=function(a,b){return Fh(new $h([].concat(Hh(a),Hh(b))))},Zj=function(a,b){return Fh(function(b){return new $h(a.filter(function(a){return!b.has(a)}))}(new $h(b)))},$j=new dj,_j=function(a){return $j.has(a)||$j.set(a,{}),$j.get(a)},ak=function a(b){if(!Kj(b))return b;var c=xh({},b);for(var d in c)if({}.hasOwnProperty.call(c,d)){var e=c[d];null===e?delete c[d]:c[d]=a(e)}return c},bk=function(a){return ak(JSON.parse(Wf(a)))},ck=function(a){return Array.isArray(a)?a:void 0===a||null===a?[]:[a]},dk=function(a,b,c){var d=b.split("."),e=d.pop(),f=a;return d.forEach(function(a){void 0===f[a]&&(f[a]={}),f=f[a]}),f[e]=c,a},ek="object"===("undefined"==typeof wx?"undefined":xf(wx))&&"function"==typeof wx.connectSocket,fk=function(a){return function(b,c,d){var e=d.value;if(e.length)throw new Error("throttled function should not accept any arguments");return zh({},d,{value:function(){var b=this,d=_j(this),f=d.throttleMeta;f||(f={},_j(this).throttleMeta=f);var g=f,h=g[c];h||(h={},f[c]=h);var i=h,j=i.previouseTimestamp,k=void 0===j?0:j,l=i.timeout,m=Date.now(),n=a-(m-k);n<=0?(f[c].previouseTimestamp=m,e.apply(this)):l||(h.timeout=setTimeout(function(){h.previouseTimestamp=Date.now(),delete h.timeout,e.apply(b)},n))}})}},gk=Lj.WebSocket||Lj.MozWebSocket,hk=gi("LC:WebSocketPlus"),ik=function(a){return Math.min(1e3*Math.pow(2,a),3e5)},jk=function(a,b,c){return xh({},c,{value:function(){var a;if(!this.is("connected")){var d=this.current;throw console.warn(b+" should not be called when the connection is "+d),(this.is("disconnected")||this.is("reconnecting"))&&console.warn("disconnect and reconnect event should be handled to avoid such calls."),new Error("Connection unavailable")}for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];return(a=c.value).call.apply(a,[this].concat(f))}})},kk=(Pj=function(a){function b(c,d){if(zf(this,b),void 0===gk)throw new Error("WebSocket is undefined. Polyfill is required in this runtime.");var e=Jf(this,a.call(this));return e._getUrls="function"!=typeof c?function(){return pe.resolve(c)}:c,e._protocol=d,e.init(),e._createWs(e._getUrls,e._protocol).then(function(){e.__postponeTimeoutTimer=e._postponeTimeoutTimer.bind(e),Lj.addEventListener&&(e.__pause=function(){return e.pause()},e.__resume=function(){return e.resume()},Lj.addEventListener("offline",e.__pause),Lj.addEventListener("online",e.__resume)),e.open()}).catch(e.throw.bind(e)),e}return Sf(b,a),b.prototype._createWs=function(a,b){var c=this;return a().then(function(a){var d=a;return d instanceof Array||(d=[d]),Sj(d.map(function(a){return function(d,e){hk("connect ["+a+"] "+b);var f=b?new gk(a,b):new gk(a);f.binaryType=c.binaryType||"arraybuffer",f.onopen=function(){return d(f)},f.onclose=function(b){return e(b instanceof Error?b:new Error("Failed to connect ["+a+"]"))},f.onerror=f.onclose}})).then(function(a){return c._ws=a,c._ws.onclose=c._handleClose.bind(c),c._ws.onmessage=c._handleMessage.bind(c),a})})},b.prototype._destroyWs=function(){var a=this._ws;a&&(a.onopen=null,a.onclose=null,a.onerror=null,a.onmessage=null,this._ws=null,a.close())},b.prototype.onbeforeevent=function(a,b,c){for(var d=arguments.length,e=Array(d>3?d-3:0),f=3;f<d;f++)e[f-3]=arguments[f];hk.apply(void 0,[a+": "+b+" -> "+c].concat(e))},b.prototype.onopen=function(){this.emit("open")},b.prototype.onconnected=function(){this._startConnectionKeeper()},b.prototype.onleaveconnected=function(a,b,c){this._stopConnectionKeeper(),this._destroyWs(),"offline"!==c&&"disconnected"!==c||this.emit("disconnect")},b.prototype.onpause=function(){this.emit("offline")},b.prototype.onbeforeresume=function(){this.emit("online")},b.prototype.onreconnect=function(){this.emit("reconnect")},b.prototype.ondisconnected=function(a,b,c){var d=this,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,f=ik.call(null,e);hk("schedule attempt="+e+" delay="+f),this.emit("schedule",e,f),this.__scheduledRetry&&clearTimeout(this.__scheduledRetry),this.__scheduledRetry=setTimeout(function(){d.is("disconnected")&&d.retry(e)},f)},b.prototype.onretry=function(a,b,c){var d=this,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.emit("retry",e),this._createWs(this._getUrls,this._protocol).then(function(){return d.can("reconnect")?d.reconnect():d._destroyWs()},function(){return d.can("fail")&&d.fail(e+1)})},b.prototype.onerror=function(a,b,c,d){this.emit("error",d)},b.prototype.onclose=function(){Lj.removeEventListener&&(this.__pause&&Lj.removeEventListener("offline",this.__pause),this.__resume&&Lj.removeEventListener("online",this.__resume))},b.prototype._ping=function(){hk("ping");try{this.ping()}catch(a){console.warn("websocket ping error: "+a.message)}},b.prototype.ping=function(){this._ws.ping?this._ws.ping():console.warn("The WebSocket implement does not support sending ping frame.\n        Override ping method to use application defined ping/pong mechanism.")},b.prototype._postponeTimeoutTimer=function(){var a=this;hk("_postponeTimeoutTimer"),this._clearTimeoutTimers(),this._timeoutTimer=setTimeout(function(){hk("timeout"),a.disconnect()},38e4)},b.prototype._clearTimeoutTimers=function(){this._timeoutTimer&&clearTimeout(this._timeoutTimer)},
b.prototype._startConnectionKeeper=function(){hk("start connection keeper"),this._heartbeatTimer=setInterval(this._ping.bind(this),18e4);var a=this._ws.addListener||this._ws.addEventListener;a.call(this._ws,"message",this.__postponeTimeoutTimer),a.call(this._ws,"pong",this.__postponeTimeoutTimer),this._postponeTimeoutTimer()},b.prototype._stopConnectionKeeper=function(){hk("stop connection keeper");var a=this._ws.removeListener||this._ws.removeEventListener;a.call(this._ws,"message",this.__postponeTimeoutTimer),a.call(this._ws,"pong",this.__postponeTimeoutTimer),this._clearTimeoutTimers(),this._heartbeatTimer&&clearInterval(this._heartbeatTimer)},b.prototype._handleClose=function(a){hk("ws closed ["+a.code+"] "+a.reason),this.isFinished()||this.handleClose(a)},b.prototype.handleClose=function(){this.disconnect()},b.prototype.send=function(a){hk("send",a),this._ws.send(a)},b.prototype._handleMessage=function(a){hk("message",a.data),this.handleMessage(a.data)},b.prototype.handleMessage=function(a){this.emit("message",a)},b}(mh),Z(Pj.prototype,"_ping",[jk],Ti(Pj.prototype,"_ping"),Pj.prototype),Z(Pj.prototype,"send",[jk],Ti(Pj.prototype,"send"),Pj.prototype),Pj);Ui.create({target:kk.prototype,initial:{state:"initialized",event:"init",defer:!0},terminal:"closed",events:[{name:"open",from:"initialized",to:"connected"},{name:"disconnect",from:"connected",to:"disconnected"},{name:"retry",from:"disconnected",to:"reconnecting"},{name:"fail",from:"reconnecting",to:"disconnected"},{name:"reconnect",from:"reconnecting",to:"connected"},{name:"pause",from:["connected","disconnected","reconnecting"],to:"offline"},{},{name:"resume",from:"offline",to:"disconnected"},{name:"close",from:["connected","disconnected","reconnecting","offline"],to:"closed"},{name:"throw",from:"*",to:"error"}]});var lk=ue.onFreeze;Oi("freeze",function(a){return function(b){return a&&Pb(b)?a(lk(b)):b}});var mk,nk=Mb.Object.freeze,ok=d(function(a){a.exports={default:nk,__esModule:!0}}),pk=c(ok),qk=pk({1e3:{name:"CLOSE_NORMAL"},1006:{name:"CLOSE_ABNORMAL"},4100:{name:"APP_NOT_AVAILABLE",message:"App not exists or realtime message service is disabled."},4103:{name:"INVALID_LOGIN",message:"Malformed clientId."},4105:{name:"SESSION_REQUIRED",message:"Message sent before session opened. "},4107:{name:"READ_TIMEOUT"},4108:{name:"LOGIN_TIMEOUT"},4109:{name:"FRAME_TOO_LONG"},4110:{name:"INVALID_ORIGIN",message:"Access denied by domain whitelist."},4111:{name:"SESSION_CONFLICT"},4112:{name:"SESSION_TOKEN_EXPIRED"},4200:{name:"INTERNAL_ERROR",message:"Internal error, please contact LeanCloud for support."},4201:{name:"SEND_MESSAGE_TIMEOUT"},4302:{name:"CONVERSATION_SIGNATURE_FAILED"},4303:{name:"CONVERSATION_NOT_FOUND"},4304:{name:"CONVERSATION_FULL"},4305:{name:"CONVERSATION_REJECTED_BY_APP"},4306:{name:"CONVERSATION_UPDATE_FAILED"},4307:{name:"CONVERSATION_READ_ONLY"},4308:{name:"CONVERSATION_NOT_ALLOWED"},4401:{name:"INVALID_MESSAGING_TARGET"},4402:{name:"MESSAGE_REJECTED_BY_APP"}}),rk=pk(gj(qk).reduce(function(a,b){return xh(a,Hf({},qk[b].name,Number(b)))},{})),sk=function(a){var b=a.code,c=a.reason,d=a.appCode,e=a.detail,f=c||e;!f&&qk[b]&&(f=qk[b].message||qk[b].name),f||(f="Unknow Error: "+b);var g=new Error(f);return xh(g,{code:b,appCode:d,detail:e})},tk=gi("LC:Connection"),uk=function(a){function b(c,d){var e=d.format,f=d.version;zf(this,b),tk("initializing Connection");var g="lc."+e+"."+f;if(ek)var h=Jf(this,a.call(this,c().then(function(a){return a.map(function(a){return a+(-1===a.indexOf("?")?"?":"&")+"subprotocol="+encodeURIComponent(g)})})));else var h=Jf(this,a.call(this,c,g));return h._protocalFormat=e,h._commands={},h._serialId=0,Jf(h)}return Sf(b,a),b.prototype.send=function(b){var c=this,d=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=void 0;d&&(this._serialId+=1,e=this._serialId,b.i=e),tk("↑ %O sent",bk(b));var f=void 0;if("proto2base64"===this._protocalFormat?f=b.toBase64():b.toArrayBuffer&&(f=b.toArrayBuffer()),!f)throw new TypeError(b+" is not a GenericCommand");return a.prototype.send.call(this,f),d?new pe(function(a,d){c._commands[e]={resolve:a,reject:d,timeout:setTimeout(function(){c._commands[e]&&(tk("✗ %O timeout",bk(b)),d(new Error("Command Timeout.")),delete c._commands[e])},2e4)}}):pe.resolve()},b.prototype.handleMessage=function(a){var b=void 0;try{b=fh.decode(a),tk("↓ %O received",bk(b))}catch(b){console.warn("Decode message failed",a)}this.emit("allmessage",b);var c=b.i;c?this._commands[c]?(clearTimeout(this._commands[c].timeout),b.cmd===ih.error?this._commands[c].reject(sk(b.errorMessage)):this._commands[c].resolve(b),delete this._commands[c]):console.warn("Unexpected command received with serialId ["+c+"],\n         which have timed out or never been requested."):b.cmd===ih.error?this.emit("error",sk(b.errorMessage)):this.emit("message",b)},b.prototype.ping=function(){return this.send(new fh({cmd:ih.echo})).catch(function(a){return tk("ping failed:",a)})},b}(kk),vk=function(a){return function(b){var c=b.constructor;return pe.resolve(b).then(a).then(Tj(function(d){return void 0===d||null===d?console.warn("Middleware["+(a._pluginName||"anonymous plugin")+":"+(a.name||"anonymous middleware")+"] param/return types not match. It returns "+d+" while a "+b.constructor.name+" expected."):d instanceof c?0:console.warn("Middleware["+(a._pluginName||"anonymous plugin")+":"+(a.name||"anonymous middleware")+"] param/return types not match. It returns a "+d.constructor.name+" while a "+b.constructor.name+" expected.")}))}},wk=function(a,b){a&&a.forEach(function(a){try{a(b)}catch(b){throw a._pluginName&&(b.message+="["+a._pluginName+"]"),b}})},xk=function(a){return function(b){return ck(a).reduce(function(a,b){return a.then(vk(b)).catch(function(a){throw b._pluginName&&(a.message+="["+b._pluginName+"]"),a})},pe.resolve(b))}},yk=function(a,b){return ck(a).reduce(function(a,c){return a.then(function(a){return!1!==a&&c.apply(void 0,Hh(b))}).catch(function(a){throw c._pluginName&&(a.message+="["+c._pluginName+"]"),a})},pe.resolve(!0))},zk=gi("LC:Realtime"),Ak=new Rj("push-router"),Bk=function(a){function b(c){zf(this,b),zk("initializing Realtime");var d=Jf(this,a.call(this));if("string"!=typeof c.appId)throw new TypeError("appId ["+c.appId+"] is not a string");if("string"!=typeof c.appKey)throw new TypeError("appKey ["+c.appKey+"] is not a string");return d._options=xh({appId:void 0,appKey:void 0,region:"cn",pushOfflineMessages:!1,noBinary:ek,ssl:!0,server:Fb.env.SERVER},c),d._cache=new Rj("endpoints"),_j(d).clients=new $h,d._plugins=[].concat(Hh(ck(b.__preRegisteredPlugins)),Hh(ck(c.plugins))).reduce(function(a,b){for(var c in b)({}).hasOwnProperty.call(b,c)&&"name"!==c&&(b.name&&ck(b[c]).forEach(function(a){a._pluginName=b.name}),a[c]=ck(a[c]).concat(b[c]));return a},{}),wk(d._plugins.onRealtimeCreate,d),d}return Sf(b,a),b.prototype._request=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f,g,h,i=b.method,j=b.version,k=void 0===j?"1.1":j,l=b.path,m=b.query,n=b.headers,o=b.data,p=void 0===o?{}:o;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=this._options,d=c.appId,e=c.region,a.next=3,this.constructor._fetchAppRouter({appId:d,region:e});case 3:return f=a.sent,g=f.api,h="https://"+g+"/"+k+l,a.abrupt("return",Ni(h,{method:i,params:m,headers:zh({"X-LC-Id":this._options.appId,"X-LC-Key":this._options.appKey},n),data:p}).then(function(a){return a.data}));case 7:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._open=function(){var a=this;if(this._openPromise)return this._openPromise;var b="protobuf2";this._options.noBinary&&(b="proto2base64");var c=3;this._options.pushOfflineMessages&&(c=1);var d={format:b,version:c};return this._openPromise=new pe(function(b,c){zk("No connection established, create a new one.");var e=new uk(function(){return a._getEndpoints(a._options)},d);e.on("open",function(){return b(e)}),e.on("error",c),e.on("message",a._dispatchCommand.bind(a)),["disconnect","reconnect","retry","schedule","offline","online"].forEach(function(b){return e.on(b,function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];zk(b+" event emitted. %O",d),a.emit.apply(a,[b].concat(d)),"reconnect"!==b&&_j(a).clients.forEach(function(a){a.emit.apply(a,[b].concat(d))})})}),e.handleClose=function(a){[rk.APP_NOT_AVAILABLE,rk.INVALID_LOGIN,rk.INVALID_ORIGIN].some(function(b){return b===a.code})?this.throw(sk(a)):this.disconnect()},_j(a).connection=e}),this._openPromise},b.prototype._getEndpoints=function(a){var b=this;return pe.resolve(this._cache.get("endpoints")||this.constructor._fetchEndpointsInfo(a).then(Tj(function(a){return b._cache.set("endpoints",a,1e3*a.ttl)}))).then(function(a){return zk("endpoint info: %O",a),[a.server,a.secondary]})},b._fetchAppRouter=function(a){var b=a.appId,c=a.region;switch(zk("fetch router"),c){case"cn":var d=Ak.get(b);return d?pe.resolve(d):Ni.get("https://app-router.leancloud.cn/2/route",{params:{appId:b},timeout:2e4}).then(function(a){return a.data}).then(Tj(zk)).then(function(a){var c=a.rtm_router_server,d=a.api_server,e=a.ttl,f=void 0===e?3600:e;if(!c)throw new Error("rtm router not exists");var g={rtmRouter:c,api:d};return Ak.set(b,g,1e3*f),g}).catch(function(){var a=b.slice(0,8).toLowerCase();return{rtmRouter:a+".rtm.lncld.net",api:a+".api.lncld.net"}});case"us":return pe.resolve({rtmRouter:"router-a0-push.leancloud.cn",api:"us-api.leancloud.cn"});default:throw new Error("Region ["+c+"] is not supported.")}},b._fetchEndpointsInfo=function(a){var b=a.appId,c=a.region,d=a.ssl,e=a.server;return zk("fetch endpoint info"),this._fetchAppRouter({appId:b,region:c}).then(Tj(zk)).then(function(a){var c=a.rtmRouter;return Ni.get("https://"+c+"/v1/route",{params:{appId:b,secure:d,features:ek?"wechat":void 0,server:e,_t:Date.now()},timeout:2e4}).then(function(a){return a.data}).then(Tj(zk))})},b.prototype._close=function(){this._openPromise&&this._openPromise.then(function(a){return a.close()}),delete this._openPromise},b.prototype.retry=function(){var a=_j(this).connection;if(!a)throw new Error("no connection established");if(a.cannot("retry"))throw new Error("retrying not allowed when not disconnected. the connection is now "+a.current);return a.retry()},b.prototype.pause=function(){var a=_j(this).connection;a&&a.can("pause")&&a.pause()},b.prototype.resume=function(){var a=_j(this).connection;a&&a.can("resume")&&a.resume()},b.prototype._register=function(a){_j(this).clients.add(a)},b.prototype._deregister=function(a){_j(this).clients.delete(a),0===_j(this).clients.size&&this._close()},b.prototype._dispatchCommand=function(a){return yk(this._plugins.beforeCommandDispatch,[a,this]).then(function(b){return!!b&&zk("[WARN] Unexpected message received: %O",bk(a))})},b}(mh),Ck=Gb.crypto||Gb.msCrypto;if(Ck&&Ck.getRandomValues){var Dk=new Uint8Array(16);mk=function(){return Ck.getRandomValues(Dk),Dk}}if(!mk){var Ek=new Array(16);mk=function(){for(var a,b=0;b<16;b++)0==(3&b)&&(a=4294967296*Math.random()),Ek[b]=a>>>((3&b)<<3)&255;return Ek}}for(var Fk=mk,Gk=[],Hk=0;Hk<256;++Hk)Gk[Hk]=(Hk+256).toString(16).substr(1);var Ik=$,Jk=_,Kk=d(function(a,b){b.__esModule=!0,b.default=function(a,b){var c={};for(var d in a)b.indexOf(d)>=0||Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);return c}}),Lk=c(Kk),Mk=Jc("iterator"),Nk=Mb.isIterable=function(a){var b=Object(a);return void 0!==b[Mk]||"@@iterator"in b||gc.hasOwnProperty(jd(b))},Ok=Nk,Pk=d(function(a){a.exports={default:Ok,__esModule:!0}}),Qk=Mb.getIterator=function(a){var b=qd(a);if("function"!=typeof b)throw TypeError(a+" is not iterable!");return Qb(b.call(a))},Rk=Qk,Sk=d(function(a){a.exports={default:Rk,__esModule:!0}}),Tk=c(Sk),Uk=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(Pk),e=c(Sk);b.default=function(){function a(a,b){var c=[],d=!0,f=!1,g=void 0;try{for(var h,i=(0,e.default)(a);!(d=(h=i.next()).done)&&(c.push(h.value),!b||c.length!==b);d=!0);}catch(a){f=!0,g=a}finally{try{!d&&i.return&&i.return()}finally{if(f)throw g}}return c}return function(b,c){if(Array.isArray(b))return b;if((0,d.default)(Object(b)))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),Vk=c(Uk),Wk=Rh(5),Xk=!0;"find"in[]&&Array(1).find(function(){Xk=!1}),cc(cc.P+cc.F*Xk,"Array",{find:function(a){return Wk(this,a,arguments.length>1?arguments[1]:void 0)}});var Yk=Mb.Array.find,Zk=d(function(a){a.exports={default:Yk,__esModule:!0}}),$k=c(Zk),_k=Object.prototype,al=aa,bl=Aj(Object.keys,Object),cl=bl,dl=Object.prototype,el=dl.hasOwnProperty,fl=ba,gl=ca,hl="[object AsyncFunction]",il="[object Function]",jl="[object GeneratorFunction]",kl="[object Proxy]",ll=da,ml=lj["__core-js_shared__"],nl=ml,ol=function(){var a=/[^.]+$/.exec(nl&&nl.keys&&nl.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),pl=ea,ql=Function.prototype,rl=ql.toString,sl=fa,tl=/[\\^$.*+?()[\]{}|]/g,ul=/^\[object .+?Constructor\]$/,vl=Function.prototype,wl=Object.prototype,xl=vl.toString,yl=wl.hasOwnProperty,zl=RegExp("^"+xl.call(yl).replace(tl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Al=ga,Bl=ha,Cl=ia,Dl=Cl(lj,"DataView"),El=Dl,Fl=Cl(lj,"Map"),Gl=Fl,Hl=Cl(lj,"Promise"),Il=Hl,Jl=Cl(lj,"Set"),Kl=Jl,Ll=Cl(lj,"WeakMap"),Ml=Ll,Nl=sl(El),Ol=sl(Gl),Pl=sl(Il),Ql=sl(Kl),Rl=sl(Ml),Sl=zj;(El&&"[object DataView]"!=Sl(new El(new ArrayBuffer(1)))||Gl&&"[object Map]"!=Sl(new Gl)||Il&&"[object Promise]"!=Sl(Il.resolve())||Kl&&"[object Set]"!=Sl(new Kl)||Ml&&"[object WeakMap]"!=Sl(new Ml))&&(Sl=function(a){var b=zj(a),c="[object Object]"==b?a.constructor:void 0,d=c?sl(c):"";if(d)switch(d){case Nl:return"[object DataView]";case Ol:return"[object Map]";case Pl:return"[object Promise]";case Ql:return"[object Set]";case Rl:return"[object WeakMap]"}return b});var Tl=Sl,Ul="[object Arguments]",Vl=ja,Wl=Object.prototype,Xl=Wl.hasOwnProperty,Yl=Wl.propertyIsEnumerable,Zl=Vl(function(){return arguments}())?Vl:function(a){return Dj(a)&&Xl.call(a,"callee")&&!Yl.call(a,"callee")},$l=Zl,_l=Array.isArray,am=_l,bm=9007199254740991,cm=ka,dm=la,em=ma,fm=d(function(a,b){var c=b&&!b.nodeType&&b,d=c&&!0&&a&&!a.nodeType&&a,e=d&&d.exports===c,f=e?lj.Buffer:void 0,g=f?f.isBuffer:void 0,h=g||em;a.exports=h}),gm={};gm["[object Float32Array]"]=gm["[object Float64Array]"]=gm["[object Int8Array]"]=gm["[object Int16Array]"]=gm["[object Int32Array]"]=gm["[object Uint8Array]"]=gm["[object Uint8ClampedArray]"]=gm["[object Uint16Array]"]=gm["[object Uint32Array]"]=!0,gm["[object Arguments]"]=gm["[object Array]"]=gm["[object ArrayBuffer]"]=gm["[object Boolean]"]=gm["[object DataView]"]=gm["[object Date]"]=gm["[object Error]"]=gm["[object Function]"]=gm["[object Map]"]=gm["[object Number]"]=gm["[object Object]"]=gm["[object RegExp]"]=gm["[object Set]"]=gm["[object String]"]=gm["[object WeakMap]"]=!1;var hm=na,im=oa,jm=d(function(a,b){var c=b&&!b.nodeType&&b,d=c&&!0&&a&&!a.nodeType&&a,e=d&&d.exports===c,f=e&&ij.process,g=function(){try{return f&&f.binding&&f.binding("util")}catch(a){}}();a.exports=g}),km=jm&&jm.isTypedArray,lm=km?im(km):hm,mm=lm,nm="[object Map]",om="[object Set]",pm=Object.prototype,qm=pm.hasOwnProperty,rm=pa,sm=qa,tm=ra,um=sa,vm=Array.prototype,wm=vm.splice,xm=ta,ym=ua,zm=va,Am=wa;xa.prototype.clear=sm,xa.prototype.delete=xm,xa.prototype.get=ym,xa.prototype.has=zm,xa.prototype.set=Am;var Bm=xa,Cm=ya,Dm=za,Em=Aa,Fm=Ba,Gm=Cl(Object,"create"),Hm=Gm,Im=Ca,Jm=Da,Km="__lodash_hash_undefined__",Lm=Object.prototype,Mm=Lm.hasOwnProperty,Nm=Ea,Om=Object.prototype,Pm=Om.hasOwnProperty,Qm=Fa,Rm="__lodash_hash_undefined__",Sm=Ga;Ha.prototype.clear=Im,Ha.prototype.delete=Jm,Ha.prototype.get=Nm,Ha.prototype.has=Qm,Ha.prototype.set=Sm;var Tm=Ha,Um=Ia,Vm=Ja,Wm=Ka,Xm=La,Ym=Ma,Zm=Na,$m=Oa;Pa.prototype.clear=Um,Pa.prototype.delete=Xm,Pa.prototype.get=Ym,Pa.prototype.has=Zm,Pa.prototype.set=$m;var _m=Pa,an=200,bn=Qa;Ra.prototype.clear=Cm,Ra.prototype.delete=Dm,Ra.prototype.get=Em,Ra.prototype.has=Fm,Ra.prototype.set=bn;var cn=Ra,dn=Sa,en=function(){try{var a=Cl(Object,"defineProperty");return a({},"",{}),a}catch(a){}}(),fn=en,gn=Ta,hn=Object.prototype,jn=hn.hasOwnProperty,kn=Ua,ln=Va,mn=Wa,nn=9007199254740991,on=/^(?:0|[1-9]\d*)$/,pn=Xa,qn=Object.prototype,rn=qn.hasOwnProperty,sn=Ya,tn=Za,un=$a,vn=_a,wn=Object.prototype,xn=wn.hasOwnProperty,yn=ab,zn=bb,An=cb,Bn=d(function(a,b){function c(a,b){if(b)return a.slice();var c=a.length,d=h?h(c):new a.constructor(c);return a.copy(d),d}var d=b&&!b.nodeType&&b,e=d&&!0&&a&&!a.nodeType&&a,f=e&&e.exports===d,g=f?lj.Buffer:void 0,h=g?g.allocUnsafe:void 0;a.exports=c}),Cn=db,Dn=eb,En=fb,Fn=Object.prototype,Gn=Fn.propertyIsEnumerable,Hn=Object.getOwnPropertySymbols,In=Hn?function(a){return null==a?[]:(a=Object(a),Dn(Hn(a),function(b){return Gn.call(a,b)}))}:En,Jn=In,Kn=gb,Ln=hb,Mn=Object.getOwnPropertySymbols,Nn=Mn?function(a){for(var b=[];a;)Ln(b,Jn(a)),a=Cj(a);return b}:En,On=Nn,Pn=ib,Qn=jb,Rn=kb,Sn=lb,Tn=Object.prototype,Un=Tn.hasOwnProperty,Vn=mb,Wn=lj.Uint8Array,Xn=Wn,Yn=nb,Zn=ob,$n=pb,_n=qb,ao=rb,bo=1,co=sb,eo=/\w*$/,fo=tb,go=ub,ho=vb,io=1,jo=wb,ko=nj?nj.prototype:void 0,lo=ko?ko.valueOf:void 0,mo=xb,no=yb,oo="[object Boolean]",po="[object Date]",qo="[object Map]",ro="[object Number]",so="[object RegExp]",to="[object Set]",uo="[object String]",vo="[object Symbol]",wo="[object ArrayBuffer]",xo="[object DataView]",yo="[object Float32Array]",zo="[object Float64Array]",Ao="[object Int8Array]",Bo="[object Int16Array]",Co="[object Int32Array]",Do="[object Uint8Array]",Eo="[object Uint8ClampedArray]",Fo="[object Uint16Array]",Go="[object Uint32Array]",Ho=zb,Io=Object.create,Jo=function(){function a(){}return function(b){if(!gl(b))return{};if(Io)return Io(b);a.prototype=b;var c=new a;return a.prototype=void 0,c}}(),Ko=Jo,Lo=Ab,Mo=1,No=2,Oo=4,Po="[object Arguments]",Qo="[object Function]",Ro="[object GeneratorFunction]",So="[object Object]",To={};To[Po]=To["[object Array]"]=To["[object ArrayBuffer]"]=To["[object DataView]"]=To["[object Boolean]"]=To["[object Date]"]=To["[object Float32Array]"]=To["[object Float64Array]"]=To["[object Int8Array]"]=To["[object Int16Array]"]=To["[object Int32Array]"]=To["[object Map]"]=To["[object Number]"]=To[So]=To["[object RegExp]"]=To["[object Set]"]=To["[object String]"]=To["[object Symbol]"]=To["[object Uint8Array]"]=To["[object Uint8ClampedArray]"]=To["[object Uint16Array]"]=To["[object Uint32Array]"]=!0,To["[object Error]"]=To[Qo]=To["[object WeakMap]"]=!1;var Uo,Vo=Bb,Wo=1,Xo=4,Yo=Cb,Zo=gi("LC:SignatureFactoryRunner"),$o=function(a,b){return pe.resolve().then(function(){return Zo("call signatureFactory with %O",b),a.apply(void 0,Hh(b))}).then(Tj(function(a){return Zo("sign result %O",a)}),function(a){throw a.message="sign error: "+a.message,Zo(a),a}).then(Db)},_o={NONE:vf("none"),SENDING:vf("sending"),SENT:vf("sent"),DELIVERED:vf("delivered"),FAILED:vf("failed")};pk(_o);var ap,bp,cp,dp,ep,fp,gp,hp,ip,jp,kp=(Uo={},Hf(Uo,_o.NONE,!0),Hf(Uo,_o.SENDING,!0),Hf(Uo,_o.SENT,!0),Hf(Uo,_o.DELIVERED,!0),Hf(Uo,_o.READ,!0),Hf(Uo,_o.FAILED,!0),Uo),lp=function(){function a(b){zf(this,a),xh(this,{content:b},{id:Jk(),cid:null,timestamp:new Date,from:void 0}),this._setStatus(_o.NONE)}return a.prototype.toJSON=function(){return this.content},a.prototype._setStatus=function(a){if(!kp[a])throw new Error("Invalid message status");this._status=a},a.validate=function(){return!0},a.parse=function(a,b){return b||new this(a)},wg(a,[{key:"status",get:function(){return this._status}},{key:"updatedAt",get:function(){return this._updatedAt||this.timestamp},set:function(a){this._updatedAt=a}}]),a}(),mp=function(a){if("number"!=typeof a)throw new TypeError(a+" is not a Number");return function(b){b.TYPE=a,b.validate=function(b){return b._lctype===a},b.prototype._getType=function(){return{_lctype:a}}}},np=function(a){if("string"!=typeof a){if(!Array.isArray(a))throw new TypeError(a+" is not an Array");if(a.some(function(a){return"string"!=typeof a}))throw new TypeError("fields contains non-string typed member")}return function(b){var c=Wj?Xj(b,"_customFields"):b._customFields;c=Array.isArray(c)?c:[],b._customFields=c.concat(a)}},op=function(a){Wj&&(a.parse=Xj(a,"parse"))},pp=(ap=np(["_lctext","_lcattrs"]))(bp=function(a){function b(){zf(this,b);var c=Jf(this,a.call(this));return c._={},c}return Sf(b,a),b.prototype.setText=function(a){return this._lctext=a,this},b.prototype.getText=function(){return this._lctext},b.prototype.setAttributes=function(a){return this._lcattrs=a,this},b.prototype.getAttributes=function(){return this._lcattrs},b.prototype._getCustomFields=function(){var a=this;return(Array.isArray(this.constructor._customFields)?this.constructor._customFields:[]).reduce(function(b,c){return"string"!=typeof c?b:(b[c]=a[c],b)},{})},b.prototype._getType=function(){throw new Error("not implemented")},b.prototype.toJSON=function(){return xh({_lctext:this.getText(),_lcattrs:this.getAttributes()},this._getCustomFields(),this._getType())},b.parse=function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new this;c.content=b;var d=Wj?Xj(c.constructor,"_customFields"):c.constructor._customFields,e=Array.isArray(d)?d:[];return e=e.reduce(function(a,c){return"string"!=typeof c?a:(a[c]=b[c],a)},{}),xh(c,e),a.parse.call(this,b,c)},wg(b,[{key:"type",get:function(){return this.constructor.TYPE}},{key:"text",set:function(a){return this.setText(a)},get:function(){return this.getText()}},{key:"attributes",set:function(a){return this.setAttributes(a)},get:function(){return this.getAttributes()}},{key:"summary",get:function(){return this.text}}]),b}(lp))||bp,qp=(cp=mp(-127))(dp=function(a){function b(){return zf(this,b),Jf(this,a.apply(this,arguments))}return Sf(b,a),wg(b,[{key:"summary",get:function(){return"[该消息已撤回]"}}]),b}(pp))||dp,rp=gi("LC:Conversation"),sp=function(a){function b(c,d){var e=c.id,f=c.creator,g=c.createdAt,h=c.updatedAt,i=c.lastMessageAt,j=c.lastMessage,k=c.mutedMembers,l=void 0===k?[]:k,m=c.members,n=void 0===m?[]:m,o=c.transient,p=void 0!==o&&o,q=c.system,r=void 0!==q&&q,s=c.muted,t=void 0!==s&&s,u=Lk(c,["id","creator","createdAt","updatedAt","lastMessageAt","lastMessage","mutedMembers","members","transient","system","muted"]);zf(this,b);var v=Jf(this,a.call(this));if(xh(v,{id:e,creator:f,createdAt:g,updatedAt:h,lastMessageAt:i,lastMessage:j,mutedMembers:l,members:n,transient:p,system:r,muted:t}),v._attributes=u,v._reset(),v.members=Fh(new $h(v.members)),xh(_j(v),{messagesWaitingForReceipt:{},lastDeliveredAt:null,lastReadAt:null,unreadMessagesCount:0}),!(d instanceof wp))throw new TypeError("Conversation must be initialized with a client");return v._client=d,["kicked","membersjoined","membersleft","message","receipt","lastdeliveredatupdate","lastreadatupdate","messagerecall","messageupdate"].forEach(function(a){return v.on(a,function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return v._debug(a+" event emitted. %O",c)})}),wk(v._client._plugins.onConversationCreate,v),v}return Sf(b,a),b.prototype._setLastDeliveredAt=function(a){var b=Uj(a);b<_j(this).lastDeliveredAt||(_j(this).lastDeliveredAt=b,this.emit("lastdeliveredatupdate"))},b.prototype._setLastReadAt=function(a){var b=Uj(a);b<_j(this).lastReadAt||(_j(this).lastReadAt=b,this.emit("lastreadatupdate"))},b.prototype.get=function(a){return _j(this).currentAttributes[a]},b.prototype.set=function(a,b){this._debug("set ["+a+"]: "+b);var c=_j(this).pendingAttributes,d=gj(c),e=new RegExp("^"+a),f=d.filter(e.test.bind(e));if(f.forEach(function(a){delete c[a]}),f.length)c[a]=b;else{var g=$k(d,function(b){return 0===a.indexOf(b)});g?dk(c[g],a.slice(g.length+1),b):c[a]=b}return _j(this).currentAttributes=gj(c).reduce(function(a,b){return dk(a,b,c[b])},Yo(this._attributes)),this},b.prototype._reset=function(){_j(this).pendingAttributes={},_j(this).currentAttributes=this._attributes},b.prototype._debug=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];rp.apply(void 0,b.concat(["["+this.id+"]"]))},b.prototype._send=function(a){var b;null===a.cmd&&(a.cmd="conv"),"conv"===a.cmd&&null===a.convMessage&&(a.convMessage=new Yg),a.convMessage&&null===a.convMessage.cid&&(a.convMessage.cid=this.id);for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return(b=this._client)._send.apply(b,[a].concat(d))},b.prototype.save=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b,c,d;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("save"),b=_j(this).pendingAttributes,!rm(b)){a.next=5;break}return this._debug("nothing touched, resolve with self"),a.abrupt("return",this);case 5:return this._debug("attr: %O",b),c=new Yg({attr:new Pg({data:Wf(b)})}),a.next=9,this._send(new fh({op:"update",convMessage:c}));case 9:return d=a.sent,this.updatedAt=d.convMessage.udate,this._attributes=_j(this).currentAttributes,_j(this).pendingAttributes={},a.abrupt("return",this);case 14:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.fetch=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=this._client.getQuery().equalTo("objectId",this.id),a.next=3,b.find();case 3:return a.abrupt("return",this);case 4:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.mute=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("mute"),a.next=3,this._send(new fh({op:"mute"}));case 3:return this.transient||(this.muted=!0,this.mutedMembers=Yj(this.mutedMembers,[this._client.id])),a.abrupt("return",this);case 5:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.unmute=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("unmute"),a.next=3,this._send(new fh({op:"unmute"}));case 3:return this.transient||(this.muted=!1,this.mutedMembers=Zj(this.mutedMembers,[this._client.id])),a.abrupt("return",this);case 5:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.count=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("unmute"),a.next=3,this._send(new fh({op:"count"}));case 3:return b=a.sent,a.abrupt("return",b.convMessage.count);case 5:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.add=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("add",b),"string"==typeof b&&(b=[b]),c=new Yg({m:b}),d=new fh({op:"add",convMessage:c}),!this._client.options.conversationSignatureFactory){a.next=10;break}return e=[this.id,this._client.id,b.sort(),"add"],a.next=8,$o(this._client.options.conversationSignatureFactory,e);case 8:f=a.sent,xh(d.convMessage,Vj({signature:"s",timestamp:"t",nonce:"n"},f));case 10:return a.next=12,this._send(d);case 12:return this.transient||this.system||(this.members=Yj(this.members,b)),a.abrupt("return",this);case 14:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.remove=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("remove",b),"string"==typeof b&&(b=[b]),c=new Yg({m:b}),d=new fh({op:"remove",convMessage:c}),!this._client.options.conversationSignatureFactory){a.next=10;break}return e=[this.id,this._client.id,b.sort(),"remove"],a.next=8,$o(this._client.options.conversationSignatureFactory,e);case 8:f=a.sent,xh(d.convMessage,Vj({signature:"s",timestamp:"t",nonce:"n"},f));case 10:return a.next=12,this._send(d);case 12:return this.transient||this.system||(this.members=Zj(this.members,b)),a.abrupt("return",this);case 14:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.join=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("join"),a.abrupt("return",this.add(this._client.id));case 2:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.quit=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("quit"),a.abrupt("return",this.remove(this._client.id));case 2:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.send=function(){function a(a,c){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug(b,"send"),b instanceof lp){a.next=3;break}throw new TypeError(b+" is not a Message");case 3:return d=xh({},c),e=xh({},b.constructor.sendOptions,d),f=e.transient,g=e.receipt,h=e.priority,i=e.pushData,j=e.will,g&&(this.transient?console.warn("receipt option is ignored as the conversation is transient."):f?console.warn("receipt option is ignored as the message is sent transiently."):this.members.length>2&&console.warn("receipt option is recommended to be used in one-on-one conversation.")),h&&!this.transient&&console.warn("priority option is ignored as the conversation is not transient."),xh(b,{cid:this.id,from:this._client.id}),b._setStatus(_o.SENDING),k=b.toJSON(),"string"!=typeof k&&(k=Wf(k)),l=new fh({cmd:"direct",directMessage:new Vg({msg:k,cid:this.id,r:g,transient:f,dt:b.id,pushData:Wf(i),will:j}),priority:h}),a.prev=12,a.next=15,this._send(l,!f);case 15:if(m=a.sent,f){a.next=23;break}if(n=m.ackMessage,o=n.uid,p=n.t,q=n.code,r=n.reason,s=n.appCode,null===q){a.next=20;break}throw sk({code:q,reason:r,appCode:s});case 20:xh(b,{id:o,timestamp:new Date(p.toNumber())}),this.lastMessage=b,this.lastMessageAt=b.timestamp;case 23:return b._setStatus(_o.SENT),g&&(_j(this).messagesWaitingForReceipt[b.id]=b),a.abrupt("return",b);case 28:throw a.prev=28,a.t0=a.catch(12),b._setStatus(_o.FAILED),a.t0;case 32:case"end":return a.stop()}},a,this,[[12,28]])}));return a}(),b.prototype._update=function(){function a(a,c,d){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b,c,d){var e,f,g,h,i,j;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("patch %O %O %O",b,c,d),!(b instanceof lp)){a.next=8;break}if(b.from===this._client.id){a.next=4;break}throw new Error("Updating message from others is not allowed");case 4:if(b.status===_o.SENT||b.status===_o.DELIVERED){a.next=6;break}throw new Error("Message is not sent");case 6:a.next=10;break;case 8:if(b.id&&b.timestamp){a.next=10;break}throw new TypeError(b+" is not a Message");case 10:return e=null,d||"string"!=typeof(e=c.toJSON())&&(e=Wf(e)),a.next=14,this._send(new fh({cmd:ih.patch,op:jh.modify,patchMessage:new gh({patches:[new hh({cid:this.id,mid:b.id,timestamp:Number(b.timestamp),recall:d,data:e})],lastPatchTime:this._client._lastPatchTime})}));case 14:return f=b.id,g=b.cid,h=b.timestamp,i=b.from,j=b._status,xh(c,{id:f,cid:g,timestamp:h,from:i,_status:j}),this.lastMessage.id===c.id&&(this.lastMessage=c),a.abrupt("return",c);case 18:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.update=function(){function a(a,c){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b,c){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c instanceof lp){a.next=2;break}throw new TypeError(c+" is not a Message");case 2:return a.abrupt("return",this._update(b,c,!1));case 3:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.recall=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this._update(b,new qp,!0));case 1:case"end":return a.stop()}},a,this)}));return a}(),
b.prototype.queryMessages=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b,c,d=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("query messages %O",e),!e.beforeMessageId||e.beforeTime){a.next=3;break}throw new Error("query option beforeMessageId must be used with option beforeTime");case 3:if(!e.afterMessageId||e.afterTime){a.next=5;break}throw new Error("query option afterMessageId must be used with option afterTime");case 5:return b=Vj({beforeTime:"t",beforeMessageId:"mid",afterTime:"tt",afterMessageId:"tmid",limit:"l"},e),b.t instanceof Date&&(b.t=b.t.getTime()),b.tt instanceof Date&&(b.tt=b.tt.getTime()),a.next=10,this._send(new fh({cmd:"logs",logsMessage:new $g(xh(b,{cid:this.id}))}));case 10:return c=a.sent,a.abrupt("return",pe.all(c.logsMessage.logs.map(function(){var a=Bh(sh.mark(function a(b){var c,e,f,g=b.msgId,h=b.timestamp,i=b.patchTimestamp,j=b.from,k=b.ackAt,l=b.readAt,m=b.data;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,d._client._messageParser.parse(m);case 2:return c=a.sent,e={id:g,cid:d.id,timestamp:new Date(h.toNumber()),from:j,deliveredAt:k},i&&(e.updatedAt=new Date(i.toNumber())),xh(c,e),f=_o.SENT,2===d.members.length&&(k&&(f=_o.DELIVERED),k&&d._setLastDeliveredAt(k),l&&d._setLastReadAt(l)),c._setStatus(f),a.abrupt("return",c);case 10:case"end":return a.stop()}},a,d)}));return function(b){return a.apply(this,arguments)}}())));case 12:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.createMessagesIterator=function(){var a=this,b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=b.beforeTime,d=b.beforeMessageId,e=b.limit,f=void 0;return{next:function(){return f=void 0===f?a.queryMessages({limit:e,beforeTime:c,beforeMessageId:d}):f.then(function(b){return 0===b.length||b.length<e?[]:a.queryMessages({beforeTime:b[0].timestamp,beforeMessageId:b[0].id,limit:e})}),f.then(function(a){return{value:Fh(a),done:0===a.length||a.length<e}})}}},b.prototype.read=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.unreadMessagesCount=0,!this.transient){a.next=3;break}return a.abrupt("return",this);case 3:return b=this._client,_j(b).readConversationsBuffer||(_j(b).readConversationsBuffer=new $h),_j(b).readConversationsBuffer.add(this),b._doSendRead(),a.abrupt("return",this);case 8:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._handleReceipt=function(a){var b=a.messageId,c=a.timestamp;a.read?this._setLastReadAt(c):this._setLastDeliveredAt(c);var d=_j(this),e=d.messagesWaitingForReceipt,f=e[b];f&&(f._setStatus(_o.DELIVERED),f.deliveredAt=c,delete e[b])},b.prototype.fetchReceiptTimestamps=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b,c,d,e;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._send(new fh({op:"max_read"}));case 2:return b=a.sent,c=b.convMessage,d=c.maxReadTimestamp,e=c.maxAckTimestamp,this._setLastDeliveredAt(e),this._setLastReadAt(d),a.abrupt("return",this);case 9:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._fetchAllReceiptTimestamps=function(){var a=new Yg({queryAllMembers:!0});return this._send(new fh({op:"max_read",convMessage:a})).then(function(a){return a.convMessage.maxReadTuples.filter(function(a){return a.maxAckTimestamp||a.maxReadTimestamp}).map(function(a){var b=a.pid,c=a.maxAckTimestamp,d=a.maxReadTimestamp;return{pid:b,lastDeliveredAt:Uj(c),lastReadAt:Uj(d)}})})},wg(b,[{key:"unreadMessagesCount",set:function(a){a!==this.unreadMessagesCount&&(_j(this).unreadMessagesCount=a,this._client.emit("unreadmessagescountupdate",[this]))},get:function(){return _j(this).unreadMessagesCount}},{key:"createdAt",set:function(a){this._createdAt=Uj(a)},get:function(){return this._createdAt}},{key:"updatedAt",set:function(a){this._updatedAt=Uj(a)},get:function(){return this._updatedAt}},{key:"lastMessageAt",set:function(a){var b=Uj(a);b<=this._lastMessageAt||(this._lastMessageAt=b)},get:function(){return this._lastMessageAt}},{key:"lastDeliveredAt",get:function(){return 2!==this.members.length?null:_j(this).lastDeliveredAt}},{key:"lastReadAt",get:function(){return 2!==this.members.length?null:_j(this).lastReadAt}},{key:"name",get:function(){return this.get("name")},set:function(a){this.set("name",a)}}]),b}(mh),tp=gi("LC:ConversationQuery"),up=function(){function a(b){zf(this,a),this._client=b,this._where={},this._extraOptions={}}return a._encode=function(a){return a instanceof Date?{__type:"Date",iso:a.toJSON()}:a instanceof RegExp?a.source:a},a._quote=function(a){return"\\Q"+a.replace("\\E","\\E\\\\E\\Q")+"\\E"},a._calculateFlag=function(a){return["withLastMessagesRefreshed","compact"].reduce(function(b,c){return(b<<1)+Boolean(a[c])},0)},a.prototype._addCondition=function(a,b,c){return this._where[a]||(this._where[a]={}),this._where[a][b]=this.constructor._encode(c),this},a.prototype.toJSON=function(){var a={where:this._where,flag:this.constructor._calculateFlag(this._extraOptions)};return void 0!==this._skip&&(a.skip=this._skip),void 0!==this._limit&&(a.limit=this._limit),void 0!==this._order&&(a.sort=this._order),tp(a),a},a.prototype.containsMembers=function(a){return this.containsAll("m",a)},a.prototype.withMembers=function(a,b){var c=new $h(a);return b&&c.add(this._client.id),this.sizeEqualTo("m",c.size),this.containsMembers(Fh(c))},a.prototype.equalTo=function(a,b){return this._where[a]=this.constructor._encode(b),this},a.prototype.lessThan=function(a,b){return this._addCondition(a,"$lt",b)},a.prototype.lessThanOrEqualTo=function(a,b){return this._addCondition(a,"$lte",b)},a.prototype.greaterThan=function(a,b){return this._addCondition(a,"$gt",b)},a.prototype.greaterThanOrEqualTo=function(a,b){return this._addCondition(a,"$gte",b)},a.prototype.notEqualTo=function(a,b){return this._addCondition(a,"$ne",b)},a.prototype.exists=function(a){return this._addCondition(a,"$exists",!0)},a.prototype.doesNotExist=function(a){return this._addCondition(a,"$exists",!1)},a.prototype.containedIn=function(a,b){return this._addCondition(a,"$in",b)},a.prototype.notContainsIn=function(a,b){return this._addCondition(a,"$nin",b)},a.prototype.containsAll=function(a,b){return this._addCondition(a,"$all",b)},a.prototype.contains=function(b,c){return this._addCondition(b,"$regex",a._quote(c))},a.prototype.startsWith=function(b,c){return this._addCondition(b,"$regex","^"+a._quote(c))},a.prototype.endsWith=function(b,c){return this._addCondition(b,"$regex",a._quote(c)+"$")},a.prototype.matches=function(a,b){this._addCondition(a,"$regex",b);var c="";return b.ignoreCase&&(c+="i"),b.multiline&&(c+="m"),c&&c.length&&this._addCondition(a,"$options",c),this},a.prototype.sizeEqualTo=function(a,b){return this._addCondition(a,"$size",b)},a.prototype.limit=function(a){return this._limit=a,this},a.prototype.skip=function(a){return this._skip=a,this},a.prototype.ascending=function(a){return this._order=a,this},a.prototype.addAscending=function(a){return this._order?this._order+=","+a:this._order=a,this},a.prototype.descending=function(a){return this._order="-"+a,this},a.prototype.addDescending=function(a){return this._order?this._order+=",-"+a:this._order="-"+a,this},a.prototype.withLastMessagesRefreshed=function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._extraOptions.withLastMessagesRefreshed=a,this},a.prototype.compact=function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._extraOptions.compact=a,this},a.prototype.find=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this._client._executeQuery(this));case 1:case"end":return a.stop()}},a,this)}));return a}(),a}(),vp=gi("LC:IMClient"),wp=(ep=fk(1e3),fp=fk(1e3),gp=function(a){function b(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments[2],f=arguments[3];if(zf(this,b),void 0!==c&&"string"!=typeof c)throw new TypeError("Client id ["+c+"] is not a String");var g=Jf(this,a.call(this));if(xh(g,{id:c,_connection:e,options:d},f),!g._messageParser)throw new Error("IMClient must be initialized with a MessageParser");return g._conversationCache=new Rj("client:"+g.id),g._ackMessageBuffer={},_j(g).lastPatchTime=Date.now(),_j(g)._eventemitter=new mh,["invited","kicked","membersjoined","membersleft","message","unreadmessages","unreadmessagescountupdate","close","conflict","unhandledmessage","reconnect","reconnecterror"].forEach(function(a){return g.on(a,function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return g._debug(a+" event emitted. %O",c)})}),wk(g._plugins.onIMClientCreate,g),g}return Sf(b,a),b.prototype._debug=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];vp.apply(void 0,b.concat(["["+this.id+"]"]))},b.prototype._dispatchCommand=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:this._debug(bk(b),"received"),a.t0=b.cmd,a.next=a.t0===ih.conv?4:a.t0===ih.direct?5:a.t0===ih.session?6:a.t0===ih.unread?7:a.t0===ih.rcp?8:a.t0===ih.patch?9:10;break;case 4:return a.abrupt("return",this._dispatchConvMessage(b));case 5:return a.abrupt("return",this._dispatchDirectMessage(b));case 6:return a.abrupt("return",this._dispatchSessionMessage(b));case 7:return a.abrupt("return",this._dispatchUnreadMessage(b));case 8:return a.abrupt("return",this._dispatchRcpMessage(b));case 9:return a.abrupt("return",this._dispatchPatchMessage(b));case 10:return a.abrupt("return",this.emit("unhandledmessage",b));case 11:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._dispatchSessionMessage=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:c=b.sessionMessage,d=c.code,e=c.reason,a.t0=b.op,a.next=a.t0===jh.closed?4:7;break;case 4:if(d!==rk.SESSION_CONFLICT){a.next=6;break}return a.abrupt("return",this.emit("conflict",{reason:e}));case 6:return a.abrupt("return",this.emit("close",{code:d,reason:e}));case 7:throw this.emit("unhandledmessage",b),new Error("Unrecognized session command");case 9:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._dispatchUnreadMessage=function(a){var b=this,c=a.unreadMessage,d=c.convs,e=c.notifTime;return _j(this).lastUnreadNotifTime=e,this.getConversations(d.map(function(a){return a.cid})).then(function(){return pe.all(d.map(function(a){var c=a.cid,d=a.unread,e=a.mid,f=a.timestamp,g=a.from,h=a.data,i=a.patchTimestamp;return b.getConversation(c).then(function(a){if(!a)return null;var j=void 0;return f&&(j=new Date(f.toNumber()),a.lastMessageAt=j),(e?b._messageParser.parse(h).then(function(b){var d={id:e,cid:c,timestamp:j,from:g};i&&(d.updatedAt=new Date(i.toNumber())),xh(b,d),a.lastMessage=b}):pe.resolve()).then(function(){return d===_j(a).unreadMessagesCount?null:(_j(a).unreadMessagesCount=d,a)})})})).then(function(a){return a.filter(function(a){return a})})}).then(function(a){a.length&&b.emit("unreadmessagescountupdate",a)})},b.prototype._dispatchRcpMessage=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f,g,h;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=b.rcpMessage,d=b.rcpMessage.read,e=c.cid,f=c.id,g=new Date(c.t.toNumber()),h=this._conversationCache.get(e)){a.next=7;break}return a.abrupt("return");case 7:h._handleReceipt({messageId:f,timestamp:g,read:d});case 8:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._dispatchPatchMessage=function(a){var b=this,c=a.patchMessage.patches;return this.getConversations(c.map(function(a){return a.cid})).then(function(){return pe.all(c.map(function(a){var c=a.cid,d=a.mid,e=a.timestamp,f=a.recall,g=a.data,h=a.patchTimestamp,i=a.from;return b.getConversation(c).then(function(a){return a?b._messageParser.parse(g).then(function(g){var j=h.toNumber(),k={id:d,cid:c,timestamp:new Date(e.toNumber()),updatedAt:new Date(j),from:i};xh(g,k),g._setStatus(_o.SENT),_j(b).lastPatchTime<j&&(_j(b).lastPatchTime=j),a.lastMessage&&a.lastMessage.id===d&&(a.lastMessage=g),f?(b.emit("messagerecall",g,a),a.emit("messagerecall",g)):(b.emit("messageupdate",g,a),a.emit("messageupdate",g))}):null})}))})},b.prototype._dispatchConvMessage=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f,g,h,i,j,k;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.convMessage,d=b.convMessage,e=d.initBy,f=d.m,a.next=3,this.getConversation(c.cid);case 3:g=a.sent,a.t0=b.op,a.next=a.t0===jh.joined?7:a.t0===jh.left?12:a.t0===jh.members_joined?17:a.t0===jh.members_left?22:27;break;case 7:return g.transient||(g.members=Yj(g.members,[this.id])),h={invitedBy:e},this.emit("invited",h,g),g.emit("invited",h),a.abrupt("return");case 12:return g.transient||(g.members=Zj(g.members,[this.id])),i={kickedBy:e},this.emit("kicked",i,g),g.emit("kicked",i),a.abrupt("return");case 17:return g.transient||(g.members=Yj(g.members,c.m)),j={invitedBy:e,members:f},this.emit("membersjoined",j,g),g.emit("membersjoined",j),a.abrupt("return");case 22:return g.transient||(g.members=Zj(g.members,c.m)),k={kickedBy:e,members:f},this.emit("membersleft",k,g),g.emit("membersleft",k),a.abrupt("return");case 27:throw this.emit("unhandledmessage",b),new Error("Unrecognized conversation command");case 29:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._dispatchDirectMessage=function(a){var b=this,c=a.directMessage,d=a.directMessage,e=d.id,f=d.cid,g=d.fromPeerId,h=d.timestamp,i=d.transient,j=d.patchTimestamp;return pe.all([this.getConversation(c.cid),this._messageParser.parse(c.msg)]).then(function(a){var c=Vk(a,2),d=c[0],k=c[1];if(d){var l={id:e,cid:f,timestamp:new Date(h.toNumber()),from:g};return j&&(l.updatedAt=new Date(j.toNumber())),xh(k,l),k._setStatus(_o.SENT),k.from!==b.id&&(i||d.transient||b._sendAck(k)),b._dispatchParsedMessage(k,d)}})},b.prototype._dispatchParsedMessage=function(a,b){var c=this;return yk(this._plugins.beforeMessageDispatch,[a,b]).then(function(d){!1!==d&&(b.lastMessage=a,b.lastMessageAt=a.timestamp,a.from!==c.id&&(b.unreadMessagesCount+=1),c.emit("message",a,b),b.emit("message",a))})},b.prototype._sendAck=function(a){this._debug("send ack for %O",a);var b=a.cid;if(!b)throw new Error("missing cid");return this._ackMessageBuffer[b]||(this._ackMessageBuffer[b]=[]),this._ackMessageBuffer[b].push(a),this._doSendAck()},b.prototype._doSendAck=function(){var a=this;this._connection.is("connected")&&(this._debug("do send ack %O",this._ackMessageBuffer),pe.all(gj(this._ackMessageBuffer).map(function(b){var c=a._ackMessageBuffer[b],d=c.map(function(a){return a.timestamp}),e=new fh({cmd:"ack",ackMessage:new Wg({cid:b,fromts:Math.min.apply(null,d),tots:Math.max.apply(null,d)})});return delete a._ackMessageBuffer[b],a._send(e,!1).catch(function(d){a._debug("send ack failed: %O",d),a._ackMessageBuffer[b]=c})})))},b.prototype._send=function(a){var b,c=a;this.id&&(c.peerId=this.id);for(var d=arguments.length,e=Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return(b=this._connection).send.apply(b,[c].concat(e))},b.prototype._open=function(a,b,c){var d=this,e=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._debug("open session");var f=_j(this),g=f.lastUnreadNotifTime,h=f.lastPatchTime;return pe.resolve(new fh({cmd:"session",op:"open",appId:a,sessionMessage:new Tg({ua:"js/4.0.0-alpha.0",r:e,lastUnreadNotifTime:g,lastPatchTime:h,configBitmap:1})})).then(function(a){if(e){var f=_j(d).sessionToken;if(f){var g=f.value;if(g&&g!==Oj.EXPIRED)return xh(a.sessionMessage,{st:g}),a}}return xh(a.sessionMessage,bk({tag:b,deviceId:c})),d.options.signatureFactory?$o(d.options.signatureFactory,[d._identity]).then(function(b){return xh(a.sessionMessage,Vj({signature:"s",timestamp:"t",nonce:"n"},b)),a}):a}).then(this._send.bind(this)).then(function(a){var b=a.peerId,c=a.sessionMessage,e=c.st,f=c.stTtl;if(!b)return void console.warn("Unexpected session opened without peerId.");d.id=b,d._identity||(d._identity=b),e&&(_j(d).sessionToken=new Oj(e,1e3*f))},function(f){if(f.code===rk.SESSION_TOKEN_EXPIRED){if(void 0===_j(d).sessionToken)throw new Error("Unexpected session expiration");return vp("Session token expired, reopening"),delete _j(d).sessionToken,d._open(a,b,c,e)}throw f})},b.prototype.close=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this._debug("close session"),b=new fh({cmd:"session",op:"close"}),a.next=4,this._send(b);case 4:_j(this)._eventemitter.emit("close",{code:0}),this.emit("close",{code:0});case 6:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.ping=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this._debug("ping"),b instanceof Array){a.next=3;break}throw new TypeError("clientIds "+b+" is not an Array");case 3:if(b.length){a.next=5;break}return a.abrupt("return",pe.resolve([]));case 5:return c=new fh({cmd:"session",op:"query",sessionMessage:new Tg({sessionPeerIds:b})}),a.next=8,this._send(c);case 8:return d=a.sent,a.abrupt("return",d.sessionMessage.onlineSessionPeerIds);case 10:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.getConversation=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("string"==typeof b){a.next=2;break}throw new TypeError(b+" is not a String");case 2:if(d){a.next=6;break}if(!(c=this._conversationCache.get(b))){a.next=6;break}return a.abrupt("return",pe.resolve(c));case 6:return a.abrupt("return",this.getQuery().equalTo("objectId",b).find().then(function(a){return a[0]||null}));case 7:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.getConversations=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d=this,e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=e?b:b.filter(function(a){return null===d._conversationCache.get(a)}),!c.length){a.next=4;break}return a.next=4,this.getQuery().containedIn("objectId",c).limit(999).find();case 4:return a.abrupt("return",b.map(function(a){return d._conversationCache.get(a)}));case 5:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.getQuery=function(){return new up(this)},b.prototype._executeQuery=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d,e,f,g,h=this;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.toJSON(),c.where=new Pg({data:Wf(c.where)}),d=new fh({cmd:"conv",op:"query",convMessage:new Yg(c)}),a.next=5,this._send(d);case 5:e=a.sent,f=void 0,a.prev=7,f=JSON.parse(e.convMessage.results.data),a.next=15;break;case 11:throw a.prev=11,a.t0=a.catch(7),g=Wf(bk(e)),new Error("Parse query result failed: "+a.t0.message+". Command: "+g);case 15:return a.next=17,pe.all(f.map(this._parseConversationFromRawData.bind(this)));case 17:return f=a.sent,a.abrupt("return",f.map(function(a){var b=h._conversationCache.get(a.id);return b?(h._debug("update cached conversation"),["creator","createdAt","updatedAt","lastMessageAt","lastMessage","mutedMembers","members","_attributes","transient","muted"].forEach(function(c){var d=a[c];void 0!==d&&(b[c]=d)}),b._reset()):(b=a,h._debug("no match, set cache"),h._conversationCache.set(a.id,a)),b}));case 19:case"end":return a.stop()}},a,this,[[7,11]])}));return a}(),b.prototype._parseConversationFromRawData=function(){function a(a){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(b){var c,d;return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c=Vj({objectId:"id",lm:"lastMessageAt",msg:"lastMessage",msg_from:"lastMessageFrom",msg_mid:"lastMessageId",msg_timestamp:"lastMessageTimestamp",patch_timestamp:"lastMessagePatchTimestamp",m:"members",tr:"transient",sys:"system",c:"creator",mu:"mutedMembers"},b),!c.lastMessage){a.next=15;break}return a.next=4,this._messageParser.parse(c.lastMessage);case 4:d=a.sent,c.lastMessage=d,d.from=c.lastMessageFrom,d.id=c.lastMessageId,d.timestamp=new Date(c.lastMessageTimestamp),c.lastMessagePatchTimestamp&&(d.updatedAt=new Date(c.lastMessagePatchTimestamp)),d._setStatus(_o.SENT),delete c.lastMessageFrom,delete c.lastMessageId,delete c.lastMessageTimestamp,delete c.lastMessagePatchTimestamp;case 15:return a.abrupt("return",new sp(c,this));case 16:case"end":return a.stop()}},a,this)}));return a}(),b.prototype.createConversation=function(){function a(){return b.apply(this,arguments)}var b=Bh(sh.mark(function a(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return sh.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b=o.members,c=o.name,d=o.transient,e=o.unique,f=Lk(o,["members","name","transient","unique"]),d||Array.isArray(b)){a.next=3;break}throw new TypeError("conversation members "+b+" is not an array");case 3:if(g=new $h(b),g.add(this.id),g=Fh(g).sort(),h=f||{},!c){a.next=11;break}if("string"==typeof c){a.next=10;break}throw new TypeError("conversation name "+c+" is not a string");case 10:h.name=c;case 11:if(h=new Pg({data:Wf(h)}),i={m:g,attr:h,transient:d,unique:e},j=new fh({cmd:"conv",op:"start",convMessage:new Yg(i)}),!this.options.conversationSignatureFactory){a.next=20;break}return k=[null,this._identity,g,"create"],a.next=18,$o(this.options.conversationSignatureFactory,k);case 18:l=a.sent,xh(j.convMessage,Vj({signature:"s",timestamp:"t",nonce:"n"},l));case 20:return a.next=22,this._send(j);case 22:return m=a.sent,n=new sp(zh({name:c,transient:d,unique:e,id:m.convMessage.cid,createdAt:m.convMessage.cdate,updatedAt:m.convMessage.cdate,lastMessageAt:null,creator:this.id,members:d?[]:g},f),this),this._conversationCache.set(n.id,n),a.abrupt("return",n);case 26:case"end":return a.stop()}},a,this)}));return a}(),b.prototype._doSendRead=function(){var a=this;if(this._connection.is("connected")){var b=_j(this).readConversationsBuffer,c=Fh(b);if(c.length){var d=c.map(function(a){if(!(a instanceof sp))throw new TypeError(a+" is not a Conversation");return a.id});this._debug("mark ["+d+"] as read"),b.clear(),this._sendReadCommand(c).catch(function(d){a._debug("send read failed: %O",d),c.forEach(b.add.bind(b))})}}},b.prototype._sendReadCommand=function(a){var b=this;return this._send(new fh({cmd:"read",readMessage:new ch({convs:a.map(function(a){return new ah({cid:a.id,mid:a.lastMessage&&a.lastMessage.from!==b.id?a.lastMessage.id:void 0,timestamp:(a.lastMessageAt||new Date).getTime()})})})}),!1)},b}(mh),Eb(gp.prototype,"_doSendAck",[ep],Ti(gp.prototype,"_doSendAck"),gp.prototype),Eb(gp.prototype,"_doSendRead",[fp],Ti(gp.prototype,"_doSendRead"),gp.prototype),gp),xp=(hp=mp(-1))(ip=op(ip=function(a){function b(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(zf(this,b),"string"!=typeof c)throw new TypeError(c+" is not a string");var d=Jf(this,a.call(this));return d.setText(c),d}return Sf(b,a),b}(pp))||ip)||ip,yp=gi("LC:MessageParser"),zp=function(a,b,c){var d=c.value;c.value=function(a){var b=void 0;if("string"!=typeof a)b=a;else try{b=JSON.parse(a)}catch(c){b=a}return d.call(this,b)}},Ap=function(a,b,c){var d=c.value;c.value=function(a){var b=this;return pe.resolve(a).then(xk(this._plugins.beforeMessageParse)).then(function(a){return d.call(b,a)}).then(xk(this._plugins.afterMessageParse))}},Bp=(jp=function(){function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};zf(this,a),this._plugins=b,this._messageClasses=[]}return a.prototype.register=function(a){if(!(a&&a.parse&&a.prototype&&a.prototype.toJSON))throw new TypeError("Invalid messageClass");this._messageClasses.unshift(a)},a.prototype.parse=function(a){yp("parsing message: %O",a);var b=!0,c=!1,d=void 0;try{for(var e,f=Tk(this._messageClasses);!(b=(e=f.next()).done);b=!0){var g=e.value,h=Kj(a)?xh({},a):a,i=void 0,j=void 0;try{i=g.validate(h)}catch(a){}if(i){try{j=g.parse(h)}catch(a){console.warn("parsing a valid message content error",{error:a,Klass:g,content:h})}if(void 0!==j)return yp("parse result: %O",j),j}}}catch(a){c=!0,d=a}finally{try{!b&&f.return&&f.return()}finally{if(c)throw d}}throw new Error("No Message Class matched")},a}(),function(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}(jp.prototype,"parse",[zp,Ap],Ti(jp.prototype,"parse"),jp.prototype),jp),Cp=gi("LC:IMPlugin"),Dp={HIGH:1,NORMAL:2,LOW:3};pk(Dp);var Ep=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{get:function(){return this.get(a)},set:function(b){this.set(a,b)}};Ff(sp.prototype,a,b)},Fp=function(a){var b=Jk();a._IMClients={};var c=new Bp(a._plugins);a._messageParser=c;var d=function(){var b=Bh(sh.mark(function b(c){return sh.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",a._request({method:"POST",path:"/rtm/sign",data:{session_token:c.getSessionToken()}}));case 1:case"end":return b.stop()}},b,void 0)}));return function(a){return b.apply(this,arguments)}}(),e=function(a){return ck(a).map(c.register.bind(c))};e(ck(a._plugins.messageClasses));var f=function(){var e=Bh(sh.mark(function e(f,g,h){var i,j,k,l;return sh.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=void 0,j={},!f){e.next=18;break}if("string"!=typeof f){e.next=7;break}i=f,e.next=16;break;case 7:if(!f.id||!f.getSessionToken){e.next=15;break}if(i=f.id,k=f.getSessionToken()){e.next=12;break}throw new Error("User must be authenticated");case 12:j.signatureFactory=d,e.next=16;break;case 15:throw new TypeError("Identity must be a String or an AV.User");case 16:if(void 0===a._IMClients[i]){e.next=18;break}return e.abrupt("return",a._IMClients[i]);case 18:return l=a._open().then(function(d){var e=new wp(i,zh({},j,g),d,{_messageParser:c,_plugins:a._plugins,_identity:f});return d.on("reconnect",function(){return e._open(a._options.appId,h,b,!0).then(function(){return e.emit("reconnect")},function(a){return e.emit("reconnecterror",a)})}),_j(e)._eventemitter.on("close",function(){delete a._IMClients[e.id],a._deregister(e)},a),e._open(a._options.appId,h,b).then(function(){return a._IMClients[e.id]=e,a._register(e),e}).catch(function(b){throw delete a._IMClients[e.id],b})}),f&&(a._IMClients[i]=l),e.abrupt("return",l);case 21:case"end":return e.stop()}},e,void 0)}));return function(a,b,c){return e.apply(this,arguments)}}();xh(a,{register:e,createIMClient:f})},Gp=function(a,b){if(null===a.peerId)return!0;var c=b._IMClients[a.peerId];return c?c._dispatchCommand(a).catch(Cp):Cp("[WARN] Unexpected message received without any live client match: %O",bk(a)),!1},Hp={name:"leancloud-realtime-plugin-im",onRealtimeCreate:Fp,beforeCommandDispatch:Gp,messageClasses:[lp,qp,xp]};Bk.defineConversationProperty=Ep,Bk.__preRegisteredPlugins=[Hp],a.Protocals=lh,a.Promise=pe,a.EventEmitter=mh,a.Realtime=Bk,a.ErrorCode=rk,a.Message=lp,a.TypedMessage=pp,a.TextMessage=xp,a.RecalledMessage=qp,a.MessagePriority=Dp,a.MessageStatus=_o,a.defineConversationProperty=Ep,a.IMPlugin=Hp,a.messageType=mp,a.messageField=np,a.IE10Compatible=op,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=realtime.weapp.min.js.map